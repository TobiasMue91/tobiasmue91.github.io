<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="Deep Miner - Dig through unique biomes to discover rare ores and ancient artifacts! An addictive incremental mining game with upgrades, prestiges, and 5 unique zones to explore.">
    <meta name="keywords" content="deep miner, mining game, idle game, incremental game, clicker game, digging game, ore mining, browser game, free online game">
    <meta name="author" content="Claude Opus 4.5 prompted by Tobias M√ºller">
    <meta property="og:title" content="Deep Miner - Incremental Mining Game">
    <meta property="og:description" content="Dig through unique biomes to discover rare ores and ancient artifacts! Explore 5 zones, collect diamonds, uranium, and voidstone. Upgrade your pickaxe and prestige for permanent bonuses.">
    <meta property="og:image" content="https://www.gptgames.dev/screenshots/screenshot_239.webp">
    <meta property="og:url" content="https://www.gptgames.dev/games/deep_miner.html">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Deep Miner - Incremental Mining Game">
    <meta name="twitter:description" content="Dig through unique biomes to discover rare ores and ancient artifacts! An addictive idle mining game with upgrades and prestiges.">
    <meta name="twitter:image" content="https://www.gptgames.dev/screenshots/screenshot_239.webp">
    <link rel="canonical" href="https://www.gptgames.dev/games/deep_miner.html">
    <title>Deep Miner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        :root {
            --bg: #0a0e14;
            --bg-panel: #141920;
            --bg-card: #1c2128;
            --bg-hover: #252d38;
            --border: #2d3642;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --text: #e2e8f0;
            --text-dim: #94a3b8;
            --text-muted: #64748b
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            height: 100vh;
            height: 100dvh;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent
        }

        #flash-overlay {
            position: fixed;
            inset: 0;
            background: rgba(255, 255, 255, 0);
            pointer-events: none;
            z-index: 9999;
            transition: background 0.1s
        }

        #flash-overlay.flash {
            background: rgba(255, 255, 255, 0.15)
        }

        #game {
            display: grid;
            grid-template-columns:1fr 380px;
            height: 100%
        }

        @media (max-width: 1000px) {
            #game {
                grid-template-columns:1fr;
                grid-template-rows:1fr auto
            }

            #sidebar {
                max-height: 55vh;
                border-left: none;
                border-top: 2px solid var(--border)
            }

            #header {
                display: none
            }

            .tabs {
                flex-wrap: wrap
            }
        }

        #mine-area {
            position: relative;
            overflow: hidden;
            background: var(--bg)
        }

        #mine-viewport {
            position: absolute;
            inset: 0;
            overflow: hidden
        }

        #mine-scroll {
            position: relative;
            padding-top: 100px
        }

        #surface-layer {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100px;
            z-index: 10;
            transition: all 0.6s ease;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5)
        }

        #surface-layer::before {
            content: '';
            position: absolute;
            inset: 0;
            background: repeating-linear-gradient(0deg, transparent, transparent 8px, rgba(0, 0, 0, 0.1) 8px, rgba(0, 0, 0, 0.1) 10px);
            z-index: 2
        }

        #surface-layer::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 30px;
            z-index: 1
        }

        #surface-layer.dirt {
            background: #4a5d35
        }

        #surface-layer.dirt::after {
            background: linear-gradient(to bottom, #5c3d1a 0%, #3d2613 100%)
        }

        #surface-layer.stone {
            background: #52565d
        }

        #surface-layer.stone::after {
            background: linear-gradient(to bottom, #3d3c40 0%, #292524 100%)
        }

        #surface-layer.crystal {
            background: #5b3a8f
        }

        #surface-layer.crystal::after {
            background: linear-gradient(to bottom, #3d266b 0%, #2e1065 100%)
        }

        #surface-layer.lava {
            background: #8b3a1a
        }

        #surface-layer.lava::after {
            background: linear-gradient(to bottom, #6b1f0e 0%, #431407 100%);
            animation: lava-glow 2s ease-in-out infinite
        }

        #surface-layer.void {
            background: #0a0d1f
        }

        #surface-layer.void::after {
            background: linear-gradient(to bottom, #0f172a 0%, #020617 100%);
            box-shadow: inset 0 0 40px rgba(99, 102, 241, 0.3)
        }

        @keyframes lava-glow {
            0%, 100% {
                filter: brightness(1)
            }
            50% {
                filter: brightness(1.2)
            }
        }

        .mine-row {
            display: flex;
            justify-content: center;
            gap: 6px;
            padding: 3px 0;
            position: relative
        }

        .block {
            width: 64px;
            height: 64px;
            border-radius: 10px;
            cursor: pointer;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.15s, box-shadow 0.15s;
            z-index: 2;
            border: 2px solid transparent;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3)
        }

        .block:hover:not(.empty):not(.hidden) {
            transform: scale(1.08);
            z-index: 10;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5)
        }

        .block:active:not(.empty):not(.hidden) {
            transform: scale(0.94)
        }

        .block.empty {
            background: #0c0a09;
            cursor: default;
            pointer-events: none;
            border-color: #1c1917;
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.5)
        }

        .block.hidden {
            background: #3d3835;
            cursor: default;
            pointer-events: none;
            border-color: #292524;
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.5)
        }

        .block.hidden::after {
            content: '?';
            font-size: 28px;
            color: #78716c;
            font-weight: 800;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5)
        }

        .block-icon {
            font-size: 32px;
            position: relative;
            z-index: 2;
            filter: drop-shadow(0 3px 5px rgba(0, 0, 0, 0.6))
        }

        .block-shine {
            position: absolute;
            top: 8px;
            left: 8px;
            width: 16px;
            height: 16px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            z-index: 3;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5)
        }

        .block-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 0 0 8px 8px;
            overflow: hidden;
            z-index: 5
        }

        .block-progress-fill {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 0.05s linear;
            box-shadow: 0 0 8px rgba(59, 130, 246, 0.6)
        }

        .block.dirt {
            background: #8b5a2b;
            border-color: #6d4222
        }

        .block.stone {
            background: #6b7280;
            border-color: #4b5563
        }

        .block.coal {
            background: #1f2937;
            border-color: #111827
        }

        .block.iron {
            background: #9ca3af;
            border-color: #6b7280
        }

        .block.copper {
            background: #c2410c;
            border-color: #9a3412
        }

        .block.silver {
            background: #d1d5db;
            border-color: #9ca3af
        }

        .block.gold {
            background: #eab308;
            border-color: #ca8a04;
            box-shadow: 0 0 20px rgba(234, 179, 8, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3)
        }

        .block.ruby {
            background: #dc2626;
            border-color: #b91c1c;
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3)
        }

        .block.sapphire {
            background: #2563eb;
            border-color: #1d4ed8;
            box-shadow: 0 0 20px rgba(37, 99, 235, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3)
        }

        .block.emerald {
            background: #16a34a;
            border-color: #15803d;
            box-shadow: 0 0 20px rgba(22, 163, 74, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3)
        }

        .block.diamond {
            background: #06b6d4;
            border-color: #0891b2;
            box-shadow: 0 0 25px rgba(6, 182, 212, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3)
        }

        .block.amethyst {
            background: #a855f7;
            border-color: #9333ea;
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3)
        }

        .block.obsidian {
            background: #1e1b4b;
            border-color: #312e81;
            box-shadow: inset 0 0 15px rgba(99, 102, 241, 0.4), 0 4px 12px rgba(0, 0, 0, 0.3)
        }

        .block.titanium {
            background: #64748b;
            border-color: #475569;
            box-shadow: 0 0 20px rgba(100, 116, 139, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3)
        }

        .block.platinum {
            background: #e2e8f0;
            border-color: #cbd5e1;
            box-shadow: 0 0 25px rgba(226, 232, 240, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3)
        }

        .block.uranium {
            background: #84cc16;
            border-color: #65a30d;
            box-shadow: 0 0 30px rgba(132, 204, 22, 0.7), 0 4px 12px rgba(0, 0, 0, 0.3);
            animation: uranium-glow 1.5s ease-in-out infinite
        }

        @keyframes uranium-glow {
            0%, 100% {
                box-shadow: 0 0 30px rgba(132, 204, 22, 0.7), 0 4px 12px rgba(0, 0, 0, 0.3)
            }
            50% {
                box-shadow: 0 0 45px rgba(132, 204, 22, 1), 0 4px 12px rgba(0, 0, 0, 0.3)
            }
        }

        .block.artifact {
            background: #7c3aed;
            border-color: #6d28d9;
            box-shadow: 0 0 30px rgba(124, 58, 237, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3);
            animation: artifact-pulse 2s ease-in-out infinite
        }

        @keyframes artifact-pulse {
            0%, 100% {
                box-shadow: 0 0 30px rgba(124, 58, 237, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3)
            }
            50% {
                box-shadow: 0 0 50px rgba(124, 58, 237, 0.9), 0 4px 12px rgba(0, 0, 0, 0.3)
            }
        }

        .block.explosive {
            background: #f97316;
            border-color: #ea580c;
            box-shadow: 0 0 25px rgba(249, 115, 22, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3);
            animation: explosive-pulse 0.8s ease-in-out infinite
        }

        @keyframes explosive-pulse {
            0%, 100% {
                transform: scale(1)
            }
            50% {
                transform: scale(1.05)
            }
        }

        .block.chest {
            background: #a16207;
            border-color: #854d0e;
            box-shadow: 0 0 20px rgba(161, 98, 7, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3)
        }

        .block.vein {
            outline: 3px solid #fbbf24;
            outline-offset: -3px
        }

        .block.hardite {
            background: #0f172a;
            border-color: #1e293b;
            box-shadow: inset 0 0 20px rgba(30, 41, 59, 0.9), 0 4px 12px rgba(0, 0, 0, 0.3)
        }

        .block.voidstone {
            background: #020617;
            border-color: #1e293b;
            box-shadow: 0 0 35px rgba(99, 102, 241, 0.5), inset 0 0 25px rgba(139, 92, 246, 0.4), 0 4px 12px rgba(0, 0, 0, 0.3);
            animation: void-pulse 3s ease-in-out infinite
        }

        @keyframes void-pulse {
            0%, 100% {
                box-shadow: 0 0 35px rgba(99, 102, 241, 0.5), inset 0 0 25px rgba(139, 92, 246, 0.4), 0 4px 12px rgba(0, 0, 0, 0.3)
            }
            50% {
                box-shadow: 0 0 60px rgba(99, 102, 241, 0.8), inset 0 0 40px rgba(139, 92, 246, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3)
            }
        }

        .block .crack {
            position: absolute;
            inset: 0;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            z-index: 4
        }

        .block.dmg-1 .crack {
            opacity: 0.35;
            background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(0, 0, 0, 0.35) 10px, rgba(0, 0, 0, 0.35) 12px)
        }

        .block.dmg-2 .crack {
            opacity: 0.55;
            background: repeating-linear-gradient(45deg, transparent, transparent 8px, rgba(0, 0, 0, 0.45) 8px, rgba(0, 0, 0, 0.45) 10px)
        }

        .block.dmg-3 .crack {
            opacity: 0.85;
            background: repeating-linear-gradient(45deg, transparent, transparent 5px, rgba(0, 0, 0, 0.6) 5px, rgba(0, 0, 0, 0.6) 7px)
        }

        .block.mining .block-icon {
            animation: shake 0.1s ease infinite
        }

        @keyframes shake {
            0%, 100% {
                transform: translateX(0)
            }
            25% {
                transform: translateX(-3px) rotate(-3deg)
            }
            75% {
                transform: translateX(3px) rotate(3deg)
            }
        }

        .block.valuable {
            animation: valuable-pulse 1.5s ease-in-out infinite
        }

        @keyframes valuable-pulse {
            0%, 100% {
                outline: 2px solid transparent;
                outline-offset: 0
            }
            50% {
                outline: 3px solid var(--warning);
                outline-offset: 5px
            }
        }

        #hud {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 240px
        }

        .hud-card {
            background: rgba(20, 25, 32, 0.97);
            padding: 16px 20px;
            border-radius: 12px;
            border: 2px solid var(--border);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4)
        }

        #depth-display {
            display: flex;
            align-items: baseline;
            gap: 8px
        }

        #depth-value {
            font-size: 36px;
            font-weight: 800;
            color: var(--accent);
            line-height: 1;
            text-shadow: 0 0 10px rgba(59, 130, 246, 0.5)
        }

        #depth-unit {
            font-size: 16px;
            color: var(--text-dim);
            font-weight: 600
        }

        #zone-name {
            font-size: 13px;
            color: var(--warning);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-top: 6px;
            font-weight: 700
        }

        #energy-bar {
            height: 12px;
            background: var(--bg);
            border-radius: 6px;
            overflow: hidden;
            margin-top: 10px;
            border: 1px solid var(--border)
        }

        #energy-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            transition: width 0.2s;
            width: 100%;
            box-shadow: inset 0 0 10px rgba(16, 185, 129, 0.5)
        }

        #energy-text {
            font-size: 12px;
            color: var(--text-dim);
            margin-top: 6px;
            text-align: center;
            font-weight: 600
        }

        #surface-btn {
            background: rgba(20, 25, 32, 0.97);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 12px 18px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 700;
            color: var(--text);
            display: none;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4)
        }

        #surface-btn:hover {
            background: var(--bg-card);
            border-color: var(--accent);
            transform: translateY(-2px)
        }

        #surface-btn.visible {
            display: flex
        }

        #sound-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(20, 25, 32, 0.97);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 12px;
            cursor: pointer;
            font-size: 20px;
            z-index: 100;
            transition: all 0.2s;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4)
        }

        #sound-btn:hover {
            background: var(--bg-card);
            transform: scale(1.05)
        }

        #particles {
            position: absolute;
            inset: 0;
            pointer-events: none;
            z-index: 50;
            overflow: hidden
        }

        .particle {
            position: absolute;
            border-radius: 4px;
            pointer-events: none;
            box-shadow: 0 0 6px currentColor
        }

        .float-text {
            position: absolute;
            font-weight: 800;
            font-size: 20px;
            pointer-events: none;
            z-index: 60;
            text-shadow: 0 3px 8px rgba(0, 0, 0, 0.9), 0 0 20px currentColor;
            white-space: nowrap
        }

        #combo {
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 56px;
            font-weight: 900;
            color: var(--warning);
            text-shadow: 0 6px 30px rgba(245, 158, 11, 0.8), 0 0 40px rgba(245, 158, 11, 0.6);
            pointer-events: none;
            opacity: 0;
            z-index: 100
        }

        #combo.show {
            opacity: 1;
            animation: combo-pop 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)
        }

        @keyframes combo-pop {
            0% {
                transform: translate(-50%, -50%) scale(0.3) rotate(-10deg)
            }
            50% {
                transform: translate(-50%, -50%) scale(1.3) rotate(5deg)
            }
            100% {
                transform: translate(-50%, -50%) scale(1) rotate(0deg)
            }
        }

        #sidebar {
            background: var(--bg-panel);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border-left: 2px solid var(--border)
        }

        #header {
            text-align: center;
            padding: 16px;
            border-bottom: 2px solid var(--border)
        }

        #header h1 {
            font-size: 22px;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-shadow: 0 2px 8px rgba(59, 130, 246, 0.3)
        }

        #header h1 span {
            color: var(--accent)
        }

        #stats-bar {
            background: var(--bg-card);
            padding: 12px 16px;
            display: flex;
            align-items: center;
            justify-content: space-around;
            border-bottom: 2px solid var(--border);
            gap: 12px
        }

        .quick-stat {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 15px;
            font-weight: 700
        }

        .quick-stat .icon {
            font-size: 18px
        }

        .quick-stat .value {
            color: var(--warning)
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid var(--border);
            background: var(--bg-card)
        }

        .tab {
            flex: 1;
            padding: 14px 6px;
            text-align: center;
            font-size: 13px;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            white-space: nowrap;
            letter-spacing: 0.5px
        }

        .tab:hover {
            color: var(--text-dim);
            background: var(--bg-hover)
        }

        .tab.active {
            color: var(--accent);
            border-bottom-color: var(--accent);
            background: var(--bg-panel)
        }

        .tab-content {
            display: none;
            padding: 20px;
            overflow-y: auto;
            flex: 1
        }

        .tab-content.active {
            display: block
        }

        .panel {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 18px;
            border: 2px solid var(--border);
            margin-bottom: 16px
        }

        .panel:last-child {
            margin-bottom: 0
        }

        .panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px
        }

        .panel-header h3 {
            font-size: 13px;
            color: var(--text-dim);
            font-weight: 700;
            letter-spacing: 1.2px;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 8px
        }

        .panel-header .icon {
            font-size: 16px
        }

        #stats-grid {
            display: grid;
            grid-template-columns:1fr 1fr;
            gap: 12px
        }

        .stat-box {
            background: var(--bg-panel);
            padding: 16px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid var(--border);
            transition: all 0.2s
        }

        .stat-box:hover {
            border-color: var(--text-muted);
            transform: translateY(-2px)
        }

        .stat-value {
            font-size: 24px;
            font-weight: 800;
            color: var(--accent);
            line-height: 1.2;
            text-shadow: 0 0 10px rgba(59, 130, 246, 0.3)
        }

        .stat-value.coins {
            color: var(--warning);
            text-shadow: 0 0 10px rgba(245, 158, 11, 0.3)
        }

        .stat-label {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 6px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600
        }

        #inventory-grid {
            display: grid;
            grid-template-columns:repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 16px
        }

        .inv-slot {
            background: var(--bg-panel);
            padding: 12px 6px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid var(--border);
            transition: all 0.2s;
            cursor: pointer
        }

        .inv-slot:hover {
            border-color: var(--text-muted);
            background: var(--bg-hover);
            transform: translateY(-2px)
        }

        .inv-slot .slot-icon {
            font-size: 24px;
            margin-bottom: 4px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5))
        }

        .inv-slot .slot-count {
            font-size: 15px;
            font-weight: 800;
            color: var(--text);
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5)
        }

        .inv-slot .slot-value {
            font-size: 10px;
            color: var(--warning);
            margin-top: 3px;
            font-weight: 600
        }

        .inv-empty {
            grid-column: 1/-1;
            text-align: center;
            color: var(--text-muted);
            font-size: 13px;
            padding: 24px;
            font-weight: 500
        }

        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2)
        }

        .btn-primary {
            background: linear-gradient(135deg, #10b981, #059669);
            color: #fff
        }

        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4)
        }

        .btn-primary:disabled {
            background: var(--bg-hover);
            color: var(--text-muted);
            cursor: not-allowed;
            box-shadow: none
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: #fff
        }

        .btn-danger:hover:not(:disabled) {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4)
        }

        #upgrades-list {
            display: flex;
            flex-direction: column;
            gap: 10px
        }

        .upgrade-card {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--bg-panel);
            padding: 14px;
            border-radius: 10px;
            border: 2px solid var(--border);
            transition: all 0.2s
        }

        .upgrade-card:hover {
            border-color: var(--text-muted);
            transform: translateX(4px)
        }

        .upgrade-icon {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            background: var(--bg-card);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
            border: 2px solid var(--border)
        }

        .upgrade-info {
            flex: 1;
            min-width: 0
        }

        .upgrade-name {
            font-size: 14px;
            font-weight: 700;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 2px
        }

        .upgrade-level {
            font-size: 11px;
            color: var(--accent);
            font-weight: 700;
            background: rgba(59, 130, 246, 0.1);
            padding: 2px 8px;
            border-radius: 6px
        }

        .upgrade-desc {
            font-size: 11px;
            color: var(--text-dim);
            margin-top: 4px;
            font-weight: 500
        }

        .upgrade-btn {
            padding: 10px 16px;
            background: linear-gradient(135deg, var(--accent), var(--accent-hover));
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            flex-shrink: 0;
            box-shadow: 0 2px 6px rgba(59, 130, 246, 0.3)
        }

        .upgrade-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, var(--accent-hover), #1d4ed8);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(59, 130, 246, 0.5)
        }

        .upgrade-btn:disabled {
            background: var(--bg-card);
            color: var(--text-muted);
            cursor: not-allowed;
            box-shadow: none
        }

        .upgrade-btn.maxed {
            background: linear-gradient(135deg, var(--success), #059669);
            color: #fff;
            box-shadow: 0 2px 6px rgba(16, 185, 129, 0.3)
        }

        .achievement {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--bg-panel);
            padding: 14px;
            border-radius: 10px;
            border: 2px solid var(--border);
            margin-bottom: 10px;
            opacity: 0.5;
            transition: all 0.3s
        }

        .achievement.unlocked {
            opacity: 1;
            border-color: var(--warning);
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.2)
        }

        .achievement-icon {
            font-size: 32px;
            filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.5))
        }

        .achievement-info {
            flex: 1
        }

        .achievement-name {
            font-size: 14px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 2px
        }

        .achievement-desc {
            font-size: 11px;
            color: var(--text-dim);
            margin-top: 4px;
            font-weight: 500
        }

        .achievement-reward {
            font-size: 11px;
            color: var(--warning);
            margin-top: 4px;
            font-weight: 700
        }

        #prestige-info {
            text-align: center;
            padding: 20px
        }

        #prestige-info p {
            font-size: 13px;
            color: var(--text-dim);
            margin-bottom: 16px;
            line-height: 1.6;
            font-weight: 500
        }

        .prestige-bonus {
            font-size: 18px;
            color: var(--warning);
            font-weight: 800;
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(245, 158, 11, 0.4)
        }

        #toasts {
            position: absolute;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 200;
            display: flex;
            flex-direction: column;
            gap: 8px;
            pointer-events: none
        }

        .toast {
            background: var(--bg-card);
            border: 2px solid var(--border);
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 700;
            color: var(--text);
            animation: toast-in 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            white-space: nowrap;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5)
        }

        .toast.success {
            border-color: var(--success);
            color: var(--success);
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.4)
        }

        .toast.warning {
            border-color: var(--warning);
            color: var(--warning);
            box-shadow: 0 4px 20px rgba(245, 158, 11, 0.4)
        }

        @keyframes toast-in {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.8)
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1)
            }
        }

        #welcome {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
            backdrop-filter: blur(4px)
        }

        #welcome.hidden {
            display: none
        }

        .welcome-card {
            background: var(--bg-panel);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 36px;
            max-width: 420px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8)
        }

        .welcome-card h2 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 900
        }

        .welcome-card h2 span {
            color: var(--accent);
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.5)
        }

        .welcome-card p {
            color: var(--text-dim);
            margin-bottom: 24px;
            line-height: 1.6;
            font-size: 15px;
            font-weight: 500
        }

        .welcome-tips {
            text-align: left;
            margin-bottom: 24px
        }

        .welcome-tip {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg-card);
            border-radius: 10px;
            margin-bottom: 8px;
            font-size: 14px;
            border: 2px solid var(--border);
            font-weight: 500
        }

        .welcome-tip .tip-icon {
            font-size: 24px
        }

        #start-btn {
            background: linear-gradient(135deg, var(--accent), var(--accent-hover));
            color: #fff;
            border: none;
            padding: 16px 48px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4)
        }

        #start-btn:hover {
            background: linear-gradient(135deg, var(--accent-hover), #1d4ed8);
            transform: scale(1.05);
            box-shadow: 0 6px 30px rgba(59, 130, 246, 0.6)
        }

        #milestone {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            z-index: 9998;
            background: var(--bg-panel);
            border: 3px solid var(--warning);
            border-radius: 20px;
            padding: 32px 48px;
            text-align: center;
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8), 0 0 100px rgba(245, 158, 11, 0.4)
        }

        #milestone.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1)
        }

        #milestone h2 {
            font-size: 28px;
            font-weight: 900;
            color: var(--warning);
            margin-bottom: 8px;
            text-shadow: 0 0 20px rgba(245, 158, 11, 0.6)
        }

        #milestone p {
            font-size: 16px;
            color: var(--text-dim);
            font-weight: 600
        }
    </style>
</head>
<body>
<div id="flash-overlay"></div>
<div id="milestone"><h2>üéâ Milestone!</h2>
    <p id="milestone-text"></p></div>
<div id="welcome">
    <div class="welcome-card">
        <h2>‚õèÔ∏è <span>Deep</span> Miner</h2>
        <p>Dig through unique biomes to discover rare ores and ancient artifacts!</p>
        <div class="welcome-tips">
            <div class="welcome-tip"><span class="tip-icon">üëÜ</span>Click or hold to mine blocks</div>
            <div class="welcome-tip"><span class="tip-icon">üåã</span>Explore 5 unique biomes</div>
            <div class="welcome-tip"><span class="tip-icon">üíé</span>Collect rare gems and artifacts</div>
            <div class="welcome-tip"><span class="tip-icon">‚ö°</span>Upgrade and prestige for bonuses</div>
        </div>
        <button id="start-btn">Start Mining</button>
    </div>
</div>
<div id="game">
    <div id="mine-area">
        <div id="surface-layer" class="dirt"></div>
        <div id="hud">
            <div class="hud-card">
                <div id="depth-display"><span id="depth-value">0</span><span id="depth-unit">m</span></div>
                <div id="zone-name">Surface</div>
                <div id="energy-bar">
                    <div id="energy-fill"></div>
                </div>
                <div id="energy-text">Energy: 100/100</div>
            </div>
            <button id="surface-btn">‚Üë Surface</button>
        </div>
        <button id="sound-btn">üîä</button>
        <div id="mine-viewport">
            <div id="mine-scroll"></div>
        </div>
        <div id="particles"></div>
        <div id="combo"></div>
        <div id="toasts"></div>
    </div>
    <div id="sidebar">
        <div id="header"><h1>‚õèÔ∏è <span>Deep</span> Miner</h1></div>
        <div id="stats-bar">
            <div class="quick-stat"><span class="icon">üí∞</span><span class="value" id="coins-quick">0</span></div>
            <div class="quick-stat"><span class="icon">üìè</span><span class="value" id="depth-quick">0m</span></div>
            <div class="quick-stat"><span class="icon">‚ú®</span><span class="value" id="prestige-quick">0</span></div>
        </div>
        <div class="tabs">
            <div class="tab active" data-tab="main">üìä Main</div>
            <div class="tab" data-tab="upgrades">‚ö° Upgrade</div>
            <div class="tab" data-tab="achievements">üèÜ Achieve</div>
            <div class="tab" data-tab="prestige">‚ú® Prestige</div>
        </div>
        <div class="tab-content active" id="tab-main">
            <div class="panel">
                <div class="panel-header"><h3><span class="icon">üìä</span>Statistics</h3></div>
                <div id="stats-grid">
                    <div class="stat-box">
                        <div class="stat-value coins" id="coins-display">0</div>
                        <div class="stat-label">Coins</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="depth-stat">0m</div>
                        <div class="stat-label">Max Depth</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="blocks-stat">0</div>
                        <div class="stat-label">Blocks Mined</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="prestige-stat">0</div>
                        <div class="stat-label">Prestiges</div>
                    </div>
                </div>
            </div>
            <div class="panel">
                <div class="panel-header"><h3><span class="icon">üéí</span>Inventory</h3></div>
                <div id="inventory-grid"></div>
                <button class="btn btn-primary" id="sell-btn" disabled>üí∞ Sell All</button>
            </div>
        </div>
        <div class="tab-content" id="tab-upgrades">
            <div class="panel">
                <div id="upgrades-list"></div>
            </div>
        </div>
        <div class="tab-content" id="tab-achievements">
            <div class="panel">
                <div id="achievements-list"></div>
            </div>
        </div>
        <div class="tab-content" id="tab-prestige">
            <div class="panel">
                <div id="prestige-info">
                    <p>Prestige resets your progress but grants permanent mining bonuses!</p>
                    <div class="prestige-bonus">Current Bonus: +<span id="prestige-bonus">0</span>%</div>
                    <p>Requires: <strong>500m</strong> depth</p>
                    <button class="btn btn-danger" id="prestige-btn" disabled>‚ú® Prestige Now</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    const BLOCKS = {
        dirt: {name: 'Dirt', icon: 'üü´', hp: 2, value: 1, color: '#8b5a2b'},
        stone: {name: 'Stone', icon: 'ü™®', hp: 3, value: 2, color: '#6b7280'},
        coal: {name: 'Coal', icon: '‚¨õ', hp: 3, value: 5, color: '#1f2937'},
        iron: {name: 'Iron', icon: '‚öôÔ∏è', hp: 4, value: 12, color: '#9ca3af'},
        copper: {name: 'Copper', icon: 'üî∂', hp: 4, value: 15, color: '#c2410c'},
        silver: {name: 'Silver', icon: '‚ö™', hp: 5, value: 30, color: '#d1d5db'},
        gold: {name: 'Gold', icon: '‚≠ê', hp: 6, value: 60, color: '#eab308'},
        ruby: {name: 'Ruby', icon: '‚ù§Ô∏è', hp: 7, value: 120, color: '#dc2626'},
        sapphire: {name: 'Sapphire', icon: 'üíô', hp: 7, value: 120, color: '#2563eb'},
        emerald: {name: 'Emerald', icon: 'üíö', hp: 8, value: 200, color: '#16a34a'},
        amethyst: {name: 'Amethyst', icon: 'üíú', hp: 8, value: 180, color: '#a855f7'},
        diamond: {name: 'Diamond', icon: 'üíé', hp: 10, value: 400, color: '#06b6d4'},
        obsidian: {name: 'Obsidian', icon: 'üñ§', hp: 15, value: 250, color: '#1e1b4b'},
        titanium: {name: 'Titanium', icon: '‚¨ú', hp: 12, value: 350, color: '#64748b'},
        platinum: {name: 'Platinum', icon: 'ü§ç', hp: 14, value: 500, color: '#e2e8f0'},
        uranium: {name: 'Uranium', icon: '‚ò¢Ô∏è', hp: 16, value: 600, color: '#84cc16'},
        artifact: {name: 'Artifact', icon: 'üè∫', hp: 12, value: 800, color: '#7c3aed'},
        hardite: {name: 'Hardite', icon: 'üî∑', hp: 25, value: 450, color: '#0f172a'},
        voidstone: {name: 'Voidstone', icon: 'üåÄ', hp: 30, value: 1200, color: '#020617'},
        explosive: {name: 'Explosive', icon: 'üí•', hp: 4, value: 0, color: '#f97316', special: 'explosive'},
        chest: {name: 'Chest', icon: 'üì¶', hp: 8, value: 0, color: '#a16207', special: 'chest'}
    };
    const ZONES = [
        {name: 'Topsoil', maxDepth: 50, bg: 'dirt', pool: [['dirt', 50], ['stone', 35], ['coal', 10], ['iron', 5]]},
        {
            name: 'Stone Caverns',
            maxDepth: 150,
            bg: 'stone',
            pool: [['stone', 35], ['coal', 15], ['iron', 20], ['copper', 15], ['silver', 10], ['gold', 4], ['explosive', 1]]
        },
        {
            name: 'Crystal Depths',
            maxDepth: 300,
            bg: 'crystal',
            pool: [['stone', 20], ['silver', 15], ['gold', 15], ['ruby', 12], ['sapphire', 12], ['emerald', 10], ['amethyst', 10], ['diamond', 4], ['chest', 2]]
        },
        {
            name: 'Molten Core',
            maxDepth: 500,
            bg: 'lava',
            pool: [['obsidian', 20], ['gold', 12], ['ruby', 15], ['diamond', 10], ['titanium', 15], ['platinum', 10], ['uranium', 8], ['artifact', 5], ['explosive', 3], ['chest', 2]]
        },
        {
            name: 'The Void',
            maxDepth: Infinity,
            bg: 'void',
            pool: [['obsidian', 15], ['platinum', 15], ['uranium', 12], ['diamond', 12], ['artifact', 10], ['hardite', 15], ['voidstone', 8], ['chest', 3], ['explosive', 5], ['titanium', 5]]
        }
    ];
    const UPGRADES = [
        {id: 'pickaxe', name: 'Pickaxe Power', desc: '+50% damage per hit', icon: '‚õèÔ∏è', base: 50, scale: 1.7, max: 50},
        {id: 'energy', name: 'Energy Tank', desc: '+20 max energy', icon: 'üîã', base: 75, scale: 1.6, max: 30},
        {id: 'regen', name: 'Energy Regen', desc: '+20% regen speed', icon: 'üíö', base: 100, scale: 1.8, max: 25},
        {id: 'luck', name: 'Lucky Strikes', desc: '+5% rare ore chance', icon: 'üçÄ', base: 150, scale: 1.9, max: 20},
        {
            id: 'multimine',
            name: 'Multi-Mine',
            desc: 'Chance to mine adjacent',
            icon: 'üí´',
            base: 300,
            scale: 2.0,
            max: 15
        },
        {id: 'autominer', name: 'Auto Miner', desc: 'Passive mining', icon: 'ü§ñ', base: 500, scale: 2.2, max: 20},
        {id: 'magnetism', name: 'Magnetism', desc: 'Auto-collect nearby', icon: 'üß≤', base: 400, scale: 2.0, max: 10},
        {id: 'explosive', name: 'Blast Mining', desc: '+1 explosion radius', icon: 'üí•', base: 600, scale: 2.5, max: 5}
    ];
    const ACHIEVEMENTS = [
        {id: 'depth100', name: 'Getting Deeper', desc: 'Reach 100m depth', check: s => s.maxDepth >= 100, reward: 100},
        {id: 'depth500', name: 'Into the Core', desc: 'Reach 500m depth', check: s => s.maxDepth >= 500, reward: 500},
        {id: 'depth1000', name: 'Void Walker', desc: 'Reach 1000m depth', check: s => s.maxDepth >= 1000, reward: 2000},
        {id: 'blocks100', name: 'Novice Miner', desc: 'Mine 100 blocks', check: s => s.blocksMined >= 100, reward: 50},
        {
            id: 'blocks1000',
            name: 'Experienced Miner',
            desc: 'Mine 1000 blocks',
            check: s => s.blocksMined >= 1000,
            reward: 300
        },
        {
            id: 'blocks10000',
            name: 'Master Miner',
            desc: 'Mine 10000 blocks',
            check: s => s.blocksMined >= 10000,
            reward: 2000
        },
        {
            id: 'diamond1',
            name: 'Diamond Hands',
            desc: 'Find your first diamond',
            check: s => (s.inventory.diamond || 0) >= 1 || (s.totalMined.diamond || 0) >= 1,
            reward: 200
        },
        {
            id: 'artifact1',
            name: 'Archaeologist',
            desc: 'Find an artifact',
            check: s => (s.inventory.artifact || 0) >= 1 || (s.totalMined.artifact || 0) >= 1,
            reward: 400
        },
        {
            id: 'voidstone1',
            name: 'Void Touched',
            desc: 'Mine voidstone',
            check: s => (s.inventory.voidstone || 0) >= 1 || (s.totalMined.voidstone || 0) >= 1,
            reward: 1000
        },
        {
            id: 'coins10000',
            name: 'Getting Rich',
            desc: 'Earn 10,000 coins total',
            check: s => s.totalCoins >= 10000,
            reward: 500
        },
        {
            id: 'coins100000',
            name: 'Wealthy',
            desc: 'Earn 100,000 coins total',
            check: s => s.totalCoins >= 100000,
            reward: 2000
        },
        {id: 'prestige1', name: 'Reborn', desc: 'Prestige once', check: s => s.prestiges >= 1, reward: 1000}
    ];
    const COLS = 7, ROW_H = 70, VISIBLE_BUFFER = 5, MAX_PARTICLES = 50, MINE_INTERVAL = 100;
    let state = {
        coins: 0,
        maxDepth: 0,
        inventory: {},
        upgrades: {},
        blocks: {},
        viewOffset: 0,
        energy: 100,
        maxEnergy: 100,
        blocksMined: 0,
        totalCoins: 0,
        totalMined: {},
        prestiges: 0,
        achievements: [],
        firstPlay: true
    };
    let audioCtx, masterGain, soundOn = true;
    let mineScroll, particles, particleCount = 0;
    let pointerDown = false, miningTimer = null, currentTarget = null;
    let lastPointerX = 0, lastPointerY = 0;
    let combo = 0, comboTimer = null;
    let visibleStart = 0, visibleEnd = 20;
    let renderScheduled = false;
    const $ = s => document.querySelector(s);
    const $$ = s => document.querySelectorAll(s);

    function initAudio() {
        if (audioCtx) return;
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        masterGain = audioCtx.createGain();
        masterGain.gain.value = 0.25;
        masterGain.connect(audioCtx.destination);
    }

    function playSound(type, pitch = 1) {
        if (!soundOn || !audioCtx) return;
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const now = audioCtx.currentTime;
        if (type === 'hit') {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'square';
            osc.frequency.setValueAtTime(120 * pitch + Math.random() * 40, now);
            osc.frequency.exponentialRampToValueAtTime(60 * pitch, now + 0.08);
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.1);
            osc.connect(gain).connect(masterGain);
            osc.start(now);
            osc.stop(now + 0.1);
        } else if (type === 'break') {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(200 * pitch, now);
            osc.frequency.exponentialRampToValueAtTime(80, now + 0.15);
            gain.gain.setValueAtTime(0.12, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.15);
            osc.connect(gain).connect(masterGain);
            osc.start(now);
            osc.stop(now + 0.15);
        } else if (type === 'coin') {
            [880, 1100, 1320].forEach((freq, i) => {
                const o = audioCtx.createOscillator();
                const g = audioCtx.createGain();
                o.type = 'sine';
                o.frequency.value = freq;
                g.gain.setValueAtTime(0.06, now + i * 0.05);
                g.gain.exponentialRampToValueAtTime(0.001, now + i * 0.05 + 0.1);
                o.connect(g).connect(masterGain);
                o.start(now + i * 0.05);
                o.stop(now + i * 0.05 + 0.12);
            });
        } else if (type === 'explode') {
            const noise = audioCtx.createBufferSource();
            const buffer = audioCtx.createBuffer(1, audioCtx.sampleRate * 0.3, audioCtx.sampleRate);
            const data = buffer.getChannelData(0);
            for (let i = 0; i < data.length; i++) data[i] = (Math.random() * 2 - 1) * Math.exp(-i / 5000);
            noise.buffer = buffer;
            const gain = audioCtx.createGain();
            gain.gain.setValueAtTime(0.3, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.3);
            noise.connect(gain).connect(masterGain);
            noise.start(now);
        } else if (type === 'milestone') {
            [523, 659, 784, 1047].forEach((freq, i) => {
                const o = audioCtx.createOscillator();
                const g = audioCtx.createGain();
                o.type = 'sine';
                o.frequency.value = freq;
                g.gain.setValueAtTime(0.08, now + i * 0.1);
                g.gain.exponentialRampToValueAtTime(0.001, now + i * 0.1 + 0.3);
                o.connect(g).connect(masterGain);
                o.start(now + i * 0.1);
                o.stop(now + i * 0.1 + 0.35);
            });
        }
    }

    function flash() {
        const f = $('#flash-overlay');
        f.classList.add('flash');
        setTimeout(() => f.classList.remove('flash'), 100);
    }

    function showMilestone(text) {
        const m = $('#milestone');
        $('#milestone-text').textContent = text;
        m.classList.add('show');
        flash();
        playSound('milestone');
        setTimeout(() => m.classList.remove('show'), 2500);
    }

    function getZone(depth) {
        return ZONES.find(z => depth < z.maxDepth) || ZONES[ZONES.length - 1];
    }

    function weightedRandom(pool, luckBonus = 0) {
        let adjusted = pool.map(([type, weight]) => {
            const info = BLOCKS[type];
            if (info && info.value >= 100) return [type, weight * (1 + luckBonus)];
            return [type, weight];
        });
        const total = adjusted.reduce((s, [, w]) => s + w, 0);
        let r = Math.random() * total;
        for (const [type, weight] of adjusted) {
            r -= weight;
            if (r <= 0) return type;
        }
        return pool[0][0];
    }

    function getBlock(y) {
        if (!state.blocks[y]) {
            const row = [];
            const center = Math.floor(COLS / 2);
            const depth = y * 2;
            const zone = getZone(depth);
            for (let x = 0; x < COLS; x++) {
                if (y === 0) {
                    row.push(x === center ? {
                        type: 'empty',
                        hp: 0,
                        maxHp: 0,
                        exposed: true,
                        mined: true
                    } : {type: 'dirt', hp: BLOCKS.dirt.hp, maxHp: BLOCKS.dirt.hp, exposed: true, mined: false});
                } else {
                    const luck = state.upgrades.luck || 0;
                    const type = weightedRandom(zone.pool, luck * 0.05);
                    const info = BLOCKS[type];
                    row.push({type, hp: info.hp, maxHp: info.hp, exposed: false, mined: false});
                }
            }
            state.blocks[y] = row;
        }
        return state.blocks[y];
    }

    function exposeNeighbors(y) {
        const dirs = [[0, -1], [0, 1], [-1, 0], [1, 0]];
        const row = getBlock(y);
        row.forEach((block, x) => {
            if (block.mined || block.type === 'empty') {
                dirs.forEach(([dx, dy]) => {
                    const nx = x + dx, ny = y + dy;
                    if (ny >= 0 && nx >= 0 && nx < COLS) {
                        const nrow = getBlock(ny);
                        if (nrow[nx] && !nrow[nx].exposed && !nrow[nx].mined) nrow[nx].exposed = true;
                    }
                });
            }
        });
    }

    function updateVisibleRange() {
        const scrollTop = state.viewOffset;
        const viewportHeight = window.innerHeight;
        visibleStart = Math.max(0, Math.floor(scrollTop / ROW_H) - VISIBLE_BUFFER);
        visibleEnd = Math.ceil((scrollTop + viewportHeight) / ROW_H) + VISIBLE_BUFFER;
        for (let y = visibleStart; y <= visibleEnd; y++) getBlock(y);
    }

    function scheduleRender() {
        if (renderScheduled) return;
        renderScheduled = true;
        requestAnimationFrame(() => {
            renderMine();
            renderScheduled = false;
        });
    }

    function renderMine() {
        mineScroll.innerHTML = '';
        updateVisibleRange();
        const totalHeight = (visibleEnd + 50) * ROW_H;
        mineScroll.style.height = totalHeight + 'px';
        for (let y = visibleStart; y <= visibleEnd; y++) {
            const row = getBlock(y);
            const rowEl = document.createElement('div');
            rowEl.className = 'mine-row';
            rowEl.style.position = 'absolute';
            rowEl.style.top = (y * ROW_H + 100) + 'px';
            rowEl.style.left = '0';
            rowEl.style.right = '0';
            rowEl.dataset.row = y;
            row.forEach((block, x) => {
                const el = document.createElement('div');
                el.dataset.x = x;
                el.dataset.y = y;
                updateBlockEl(el, block, x, y);
                rowEl.appendChild(el);
            });
            mineScroll.appendChild(rowEl);
        }
        updateZoneDisplay();
    }

    function updateBlockEl(el, block, x, y) {
        if (!el || !block) return;
        el.className = 'block';
        el.innerHTML = '';
        if (block.mined || block.type === 'empty') {
            el.classList.add('empty');
        } else if (!block.exposed) {
            el.classList.add('hidden');
        } else {
            const info = BLOCKS[block.type];
            el.classList.add(block.type);
            if (block.vein) el.classList.add('vein');
            el.innerHTML = `<span class="block-icon">${info.icon}</span><div class="block-shine"></div><div class="crack"></div><div class="block-progress"><div class="block-progress-fill"></div></div>`;
            const dmgRatio = 1 - block.hp / block.maxHp;
            if (dmgRatio > 0.66) el.classList.add('dmg-3');
            else if (dmgRatio > 0.33) el.classList.add('dmg-2');
            else if (dmgRatio > 0) el.classList.add('dmg-1');
            if (currentTarget && currentTarget.x === x && currentTarget.y === y) el.classList.add('mining');
            const scanner = state.upgrades.scanner || 0;
            if (scanner > 0 && info.value >= 50 * scanner) el.classList.add('valuable');
            const fill = el.querySelector('.block-progress-fill');
            if (fill) fill.style.width = (dmgRatio * 100) + '%';
        }
    }

    function getBlockElAt(x, y) {
        const row = mineScroll.querySelector(`[data-row="${y}"]`);
        return row?.children[x];
    }

    function refreshBlock(x, y) {
        const block = state.blocks[y]?.[x];
        const el = getBlockElAt(x, y);
        if (el && block) updateBlockEl(el, block, x, y);
    }

    function spawnParticles(x, y, color, count = 8) {
        if (particleCount >= MAX_PARTICLES) return;
        const el = getBlockElAt(x, y);
        if (!el) return;
        const rect = el.getBoundingClientRect();
        const container = $('#mine-area').getBoundingClientRect();
        const cx = rect.left - container.left + rect.width / 2;
        const cy = rect.top - container.top + rect.height / 2;
        const spawn = Math.min(count, MAX_PARTICLES - particleCount);
        for (let i = 0; i < spawn; i++) {
            particleCount++;
            const p = document.createElement('div');
            p.className = 'particle';
            const size = 4 + Math.random() * 6;
            p.style.cssText = `width:${size}px;height:${size}px;background:${color};color:${color};left:${cx}px;top:${cy}px;`;
            particles.appendChild(p);
            const angle = Math.random() * Math.PI * 2;
            const speed = 2.5 + Math.random() * 4.5;
            let vx = Math.cos(angle) * speed, vy = Math.sin(angle) * speed - 3.5;
            let px = cx, py = cy, life = 1;
            const animate = () => {
                life -= 0.04;
                vx *= 0.96;
                vy += 0.25;
                px += vx;
                py += vy;
                p.style.left = px + 'px';
                p.style.top = py + 'px';
                p.style.opacity = life;
                if (life > 0) requestAnimationFrame(animate);
                else {
                    p.remove();
                    particleCount--;
                }
            };
            requestAnimationFrame(animate);
        }
    }

    function spawnFloatText(x, y, text, color) {
        const el = getBlockElAt(x, y);
        if (!el) return;
        const rect = el.getBoundingClientRect();
        const container = $('#mine-area').getBoundingClientRect();
        const ft = document.createElement('div');
        ft.className = 'float-text';
        ft.textContent = text;
        ft.style.cssText = `left:${rect.left - container.left + rect.width / 2}px;top:${rect.top - container.top}px;color:${color};transform:translateX(-50%);`;
        particles.appendChild(ft);
        let py = rect.top - container.top, life = 1;
        const animate = () => {
            life -= 0.025;
            py -= 2;
            ft.style.top = py + 'px';
            ft.style.opacity = life;
            if (life > 0) requestAnimationFrame(animate); else ft.remove();
        };
        requestAnimationFrame(animate);
    }

    function updateCombo() {
        combo++;
        clearTimeout(comboTimer);
        if (combo >= 3) {
            $('#combo').textContent = `${combo}x`;
            $('#combo').classList.add('show');
        }
        comboTimer = setTimeout(() => {
            combo = 0;
            $('#combo').classList.remove('show');
        }, 1000);
    }

    function toast(msg, type = '') {
        const t = document.createElement('div');
        t.className = `toast ${type}`;
        t.textContent = msg;
        $('#toasts').appendChild(t);
        setTimeout(() => t.remove(), 3000);
    }

    function explodeAt(cx, cy) {
        const radius = 1 + (state.upgrades.explosive || 0);
        playSound('explode');
        flash();
        for (let dy = -radius; dy <= radius; dy++) {
            for (let dx = -radius; dx <= radius; dx++) {
                if (dx === 0 && dy === 0) continue;
                const nx = cx + dx, ny = cy + dy;
                if (nx < 0 || nx >= COLS || ny < 0) continue;
                const row = getBlock(ny);
                const block = row[nx];
                if (block && block.exposed && !block.mined && block.type !== 'empty') {
                    block.mined = true;
                    const info = BLOCKS[block.type];
                    if (info.value > 0) {
                        if (!state.inventory[block.type]) state.inventory[block.type] = 0;
                        state.inventory[block.type]++;
                        if (!state.totalMined[block.type]) state.totalMined[block.type] = 0;
                        state.totalMined[block.type]++;
                    }
                    state.blocksMined++;
                    spawnParticles(nx, ny, info.color, 10);
                    refreshBlock(nx, ny);
                    exposeNeighbors(ny);
                }
            }
        }
    }

    function openChest(x, y) {
        const rewards = ['gold', 'ruby', 'sapphire', 'diamond', 'artifact'];
        const count = 2 + Math.floor(Math.random() * 3);
        let msg = [];
        for (let i = 0; i < count; i++) {
            const type = rewards[Math.floor(Math.random() * rewards.length)];
            if (!state.inventory[type]) state.inventory[type] = 0;
            state.inventory[type]++;
            if (!state.totalMined[type]) state.totalMined[type] = 0;
            state.totalMined[type]++;
            msg.push(BLOCKS[type].icon);
        }
        flash();
        toast(`üì¶ Found: ${msg.join(' ')}`, 'warning');
    }

    function mine(x, y) {
        const row = getBlock(y);
        const block = row?.[x];
        if (!block || block.mined || !block.exposed || block.type === 'empty') return false;
        if (state.energy <= 0) return false;
        initAudio();
        const info = BLOCKS[block.type];
        const pickaxe = state.upgrades.pickaxe || 0;
        const prestigeBonus = 1 + state.prestiges * 0.1;
        const damage = (1 + pickaxe * 0.5) * prestigeBonus;
        block.hp = Math.max(0, block.hp - damage);
        state.energy = Math.max(0, state.energy - 0.5);
        updateEnergy();
        playSound('hit', 0.8 + info.value / 150);
        spawnParticles(x, y, info.color, 4);
        refreshBlock(x, y);
        if (block.hp <= 0) {
            block.mined = true;
            state.blocksMined++;
            if (info.special === 'explosive') {
                explodeAt(x, y);
            } else if (info.special === 'chest') {
                openChest(x, y);
            } else if (info.value > 0) {
                if (!state.inventory[block.type]) state.inventory[block.type] = 0;
                state.inventory[block.type]++;
                if (!state.totalMined[block.type]) state.totalMined[block.type] = 0;
                state.totalMined[block.type]++;
                spawnFloatText(x, y, `+${info.value}`, info.color);
                if (info.value >= 400) {
                    flash();
                }
            }
            const depth = (y + 1) * 2;
            if (depth > state.maxDepth) {
                state.maxDepth = depth;
                if (depth % 100 === 0) {
                    showMilestone(`Reached ${depth}m depth!`);
                } else if (depth % 50 === 0) {
                    toast(`üéâ ${depth}m depth!`, 'success');
                }
            }
            playSound('break', 1 + info.value / 200);
            spawnParticles(x, y, info.color, 12);
            updateCombo();
            refreshBlock(x, y);
            const multi = state.upgrades.multimine || 0;
            if (multi > 0 && Math.random() < multi * 0.08) {
                const dirs = [[0, 1], [1, 0], [-1, 0], [0, -1]];
                const [dx, dy] = dirs[Math.floor(Math.random() * dirs.length)];
                const nx = x + dx, ny = y + dy;
                if (nx >= 0 && nx < COLS && ny >= 0) {
                    const nrow = getBlock(ny);
                    if (nrow[nx] && nrow[nx].exposed && !nrow[nx].mined) {
                        setTimeout(() => mine(nx, ny), 50);
                    }
                }
            }
            exposeNeighbors(y);
            for (let dy = -1; dy <= 1; dy++) {
                for (let dx = -1; dx <= 1; dx++) {
                    const ny = y + dy, nx = x + dx;
                    if (ny >= 0 && nx >= 0 && nx < COLS) refreshBlock(nx, ny);
                }
            }
            updateScroll();
            updateUI();
            checkAchievements();
            save();
            return true;
        }
        return true;
    }

    function findNextTarget(fx, fy) {
        const dirs = [[0, 1], [1, 0], [-1, 0], [1, 1], [-1, 1], [0, -1]];
        for (const [dx, dy] of dirs) {
            const nx = fx + dx, ny = fy + dy;
            if (nx >= 0 && nx < COLS && ny >= 0) {
                const row = getBlock(ny);
                if (row[nx] && row[nx].exposed && !row[nx].mined && row[nx].type !== 'empty') return {x: nx, y: ny};
            }
        }
        return null;
    }

    function startMining(x, y) {
        if (currentTarget) {
            const el = getBlockElAt(currentTarget.x, currentTarget.y);
            if (el) el.classList.remove('mining');
        }
        stopMining();
        const row = getBlock(y);
        const block = row?.[x];
        if (!block || block.mined || !block.exposed || block.type === 'empty') return;
        currentTarget = {x, y};
        const el = getBlockElAt(x, y);
        if (el) el.classList.add('mining');
        mine(x, y);
        miningTimer = setInterval(() => {
            if (!currentTarget || state.energy <= 0) {
                stopMining();
                return;
            }
            if (pointerDown) {
                const hoverBlock = getBlockFromPoint(lastPointerX, lastPointerY);
                if (!hoverBlock || hoverBlock.x !== currentTarget.x || hoverBlock.y !== currentTarget.y) {
                    stopMining();
                    return;
                }
            }
            const b = getBlock(currentTarget.y)?.[currentTarget.x];
            if (!b || b.mined) {
                if (pointerDown) {
                    const next = getBlockFromPoint(lastPointerX, lastPointerY);
                    if (next) {
                        const nb = getBlock(next.y)?.[next.x];
                        if (nb && nb.exposed && !nb.mined) {
                            currentTarget = next;
                            const el = getBlockElAt(next.x, next.y);
                            if (el) el.classList.add('mining');
                            mine(next.x, next.y);
                            return;
                        }
                    }
                }
                stopMining();
                return;
            }
            mine(currentTarget.x, currentTarget.y);
        }, MINE_INTERVAL);
    }

    function stopMining() {
        if (miningTimer) {
            clearInterval(miningTimer);
            miningTimer = null;
        }
        if (currentTarget) {
            const el = getBlockElAt(currentTarget.x, currentTarget.y);
            if (el) el.classList.remove('mining');
        }
        currentTarget = null;
    }

    function autoMine() {
        const level = state.upgrades.autominer || 0;
        if (level === 0 || state.energy < 1) return;
        let best = null, bestVal = 0;
        for (let y = visibleStart; y <= visibleEnd; y++) {
            const row = getBlock(y);
            row.forEach((block, x) => {
                if (block.exposed && !block.mined && block.type !== 'empty') {
                    const val = BLOCKS[block.type].value;
                    if (val > bestVal) {
                        bestVal = val;
                        best = {x, y, block};
                    }
                }
            });
        }
        if (!best) return;
        const dmg = level * 0.1 * (1 + state.prestiges * 0.1);
        best.block.hp -= dmg;
        if (best.block.hp <= 0) mine(best.x, best.y);
        else refreshBlock(best.x, best.y);
    }

    function updateScroll() {
        let deepest = 0;
        Object.keys(state.blocks).forEach(y => {
            const row = state.blocks[y];
            if (row.some(b => b.mined)) deepest = Math.max(deepest, parseInt(y));
        });
        const targetOffset = Math.max(0, (deepest - 4) * ROW_H);
        if (targetOffset > state.viewOffset) {
            state.viewOffset = targetOffset;
            mineScroll.style.transform = `translateY(-${state.viewOffset}px)`;
            updateVisibleRange();
            scheduleRender();
        }
        updateDepthDisplay();
    }

    function scrollToSurface() {
        state.viewOffset = 0;
        mineScroll.style.transform = 'translateY(0)';
        updateVisibleRange();
        renderMine();
        updateDepthDisplay();
    }

    function updateDepthDisplay() {
        const viewDepth = Math.floor(state.viewOffset / ROW_H) * 2;
        $('#depth-value').textContent = viewDepth;
        $('#depth-stat').textContent = state.maxDepth + 'm';
        $('#depth-quick').textContent = state.maxDepth + 'm';
        $('#surface-btn').classList.toggle('visible', state.viewOffset > 0);
        updateZoneDisplay();
    }

    function updateZoneDisplay() {
        const depth = Math.floor(state.viewOffset / ROW_H) * 2;
        const zone = getZone(depth);
        $('#zone-name').textContent = zone.name;
        const surface = $('#surface-layer');
        surface.className = zone.bg;
    }

    function updateEnergy() {
        const maxE = 100 + (state.upgrades.energy || 0) * 20;
        state.maxEnergy = maxE;
        state.energy = Math.min(state.energy, maxE);
        $('#energy-fill').style.width = (state.energy / maxE * 100) + '%';
        $('#energy-text').textContent = `Energy: ${Math.floor(state.energy)}/${maxE}`;
    }

    function regenEnergy() {
        const regen = 1 + ((state.upgrades.regen || 0) * 0.2);
        state.energy = Math.min(state.maxEnergy, state.energy + regen);
        updateEnergy();
    }

    function formatNum(n) {
        if (n >= 1e6) return (n / 1e6).toFixed(1) + 'M';
        if (n >= 1e3) return (n / 1e3).toFixed(1) + 'K';
        return Math.floor(n).toString();
    }

    function updateUI() {
        $('#coins-display').textContent = formatNum(state.coins);
        $('#coins-quick').textContent = formatNum(state.coins);
        $('#blocks-stat').textContent = formatNum(state.blocksMined);
        $('#prestige-stat').textContent = state.prestiges;
        $('#prestige-quick').textContent = state.prestiges;
        $('#prestige-bonus').textContent = state.prestiges * 10;
        updateDepthDisplay();
        updateEnergy();
        renderInventory();
        renderUpgrades();
        renderAchievements();
        $('#prestige-btn').disabled = state.maxDepth < 500;
    }

    function renderInventory() {
        const grid = $('#inventory-grid');
        const items = Object.entries(state.inventory).filter(([, c]) => c > 0);
        if (items.length === 0) {
            grid.innerHTML = '<div class="inv-empty">Mine blocks to collect resources</div>';
            $('#sell-btn').disabled = true;
            return;
        }
        $('#sell-btn').disabled = false;
        items.sort((a, b) => BLOCKS[b[0]].value - BLOCKS[a[0]].value);
        grid.innerHTML = items.map(([type, count]) => {
            const info = BLOCKS[type];
            return `<div class="inv-slot"><div class="slot-icon">${info.icon}</div><div class="slot-count">${count}</div><div class="slot-value">${formatNum(info.value * count)}</div></div>`;
        }).join('');
    }

    function renderUpgrades() {
        $('#upgrades-list').innerHTML = UPGRADES.map(up => {
            const level = state.upgrades[up.id] || 0;
            const cost = Math.floor(up.base * Math.pow(up.scale, level));
            const canBuy = state.coins >= cost && level < up.max;
            const maxed = level >= up.max;
            return `<div class="upgrade-card"><div class="upgrade-icon">${up.icon}</div><div class="upgrade-info"><div class="upgrade-name">${up.name}<span class="upgrade-level">Lv.${level}</span></div><div class="upgrade-desc">${up.desc}</div></div><button class="upgrade-btn${maxed ? ' maxed' : ''}" data-id="${up.id}"${canBuy ? '' : ' disabled'}>${maxed ? 'MAX' : formatNum(cost)}</button></div>`;
        }).join('');
    }

    function renderAchievements() {
        $('#achievements-list').innerHTML = ACHIEVEMENTS.map(a => {
            const unlocked = state.achievements.includes(a.id);
            return `<div class="achievement${unlocked ? ' unlocked' : ''}"><div class="achievement-icon">${unlocked ? 'üèÜ' : 'üîí'}</div><div class="achievement-info"><div class="achievement-name">${a.name}</div><div class="achievement-desc">${a.desc}</div><div class="achievement-reward">+${a.reward} coins</div></div></div>`;
        }).join('');
    }

    function checkAchievements() {
        ACHIEVEMENTS.forEach(a => {
            if (!state.achievements.includes(a.id) && a.check(state)) {
                state.achievements.push(a.id);
                state.coins += a.reward;
                state.totalCoins += a.reward;
                showMilestone(`Achievement: ${a.name}!`);
                playSound('coin');
            }
        });
    }

    function buyUpgrade(id) {
        const up = UPGRADES.find(u => u.id === id);
        if (!up) return;
        const level = state.upgrades[up.id] || 0;
        if (level >= up.max) return;
        const cost = Math.floor(up.base * Math.pow(up.scale, level));
        if (state.coins < cost) return;
        state.coins -= cost;
        state.upgrades[up.id] = (state.upgrades[up.id] || 0) + 1;
        playSound('coin');
        toast(`${up.icon} ${up.name} ‚Üí Lv.${state.upgrades[up.id]}`, 'success');
        updateUI();
        save();
    }

    function sellAll() {
        let total = 0;
        Object.entries(state.inventory).forEach(([type, count]) => {
            total += BLOCKS[type].value * count;
        });
        if (total > 0) {
            const bonus = 1 + state.prestiges * 0.1;
            total = Math.floor(total * bonus);
            state.coins += total;
            state.totalCoins += total;
            state.inventory = {};
            playSound('coin');
            flash();
            toast(`üí∞ +${formatNum(total)} coins`, 'success');
            checkAchievements();
            updateUI();
            save();
        }
    }

    function prestige() {
        if (state.maxDepth < 500) return;
        state.prestiges++;
        state.coins = 0;
        state.inventory = {};
        state.blocks = {};
        state.maxDepth = 0;
        state.blocksMined = 0;
        state.viewOffset = 0;
        state.energy = state.maxEnergy;
        showMilestone(`Prestige ${state.prestiges}! +10% permanent bonus`);
        renderMine();
        updateUI();
        save();
    }

    function getBlockFromPoint(cx, cy) {
        const el = document.elementFromPoint(cx, cy);
        if (!el) return null;
        const block = el.closest('.block');
        if (!block || block.classList.contains('empty') || block.classList.contains('hidden')) return null;
        const x = parseInt(block.dataset.x);
        const y = parseInt(block.dataset.y);
        if (isNaN(x) || isNaN(y)) return null;
        return {x, y};
    }

    function handlePointerDown(e) {
        pointerDown = true;
        lastPointerX = e.clientX;
        lastPointerY = e.clientY;
        const target = getBlockFromPoint(e.clientX, e.clientY);
        if (target) startMining(target.x, target.y);
    }

    function handlePointerMove(e) {
        lastPointerX = e.clientX;
        lastPointerY = e.clientY;
        if (!pointerDown) return;
        const target = getBlockFromPoint(e.clientX, e.clientY);
        if (!target) return;
        if (!currentTarget || currentTarget.x !== target.x || currentTarget.y !== target.y) startMining(target.x, target.y);
    }

    function handlePointerUp() {
        pointerDown = false;
        stopMining();
    }

    function save() {
        try {
            localStorage.setItem('deepMiner3', JSON.stringify(state));
        } catch (e) {
        }
    }

    function load() {
        try {
            const d = localStorage.getItem('deepMiner3');
            if (d) {
                const s = JSON.parse(d);
                Object.assign(state, s);
            }
        } catch (e) {
        }
    }

    function init() {
        mineScroll = $('#mine-scroll');
        particles = $('#particles');
        load();
        if (!state.upgrades) state.upgrades = {};
        if (!state.totalMined) state.totalMined = {};
        if (!state.achievements) state.achievements = [];
        if (!state.blocks || Object.keys(state.blocks).length === 0) state.blocks = {};
        for (let y = 0; y <= 20; y++) {
            getBlock(y);
            exposeNeighbors(y);
        }
        renderMine();
        updateUI();
        if (state.viewOffset > 0) mineScroll.style.transform = `translateY(-${state.viewOffset}px)`;
        if (state.firstPlay) $('#welcome').classList.remove('hidden');
        else $('#welcome').classList.add('hidden');
        const ma = $('#mine-area');
        ma.addEventListener('pointerdown', handlePointerDown);
        ma.addEventListener('pointermove', handlePointerMove);
        ma.addEventListener('pointerup', handlePointerUp);
        ma.addEventListener('pointercancel', handlePointerUp);
        ma.addEventListener('pointerleave', handlePointerUp);
        $('#sell-btn').addEventListener('click', sellAll);
        $('#upgrades-list').addEventListener('click', e => {
            const btn = e.target.closest('.upgrade-btn');
            if (btn && !btn.disabled) buyUpgrade(btn.dataset.id);
        });
        $('#sound-btn').addEventListener('click', () => {
            initAudio();
            soundOn = !soundOn;
            $('#sound-btn').textContent = soundOn ? 'üîä' : 'üîá';
        });
        $('#surface-btn').addEventListener('click', scrollToSurface);
        $('#start-btn').addEventListener('click', () => {
            state.firstPlay = false;
            $('#welcome').classList.add('hidden');
            save();
        });
        $('#prestige-btn').addEventListener('click', prestige);
        $$('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                $$('.tab').forEach(t => t.classList.remove('active'));
                $$('.tab-content').forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                $(`#tab-${tab.dataset.tab}`).classList.add('active');
            });
        });
        setInterval(autoMine, 400);
        setInterval(regenEnergy, 500);
        setInterval(save, 5000);
        setInterval(() => {
            updateVisibleRange();
            scheduleRender();
        }, 2000);
    }

    document.addEventListener('DOMContentLoaded', init);
</script>
<script src="../logo.js"></script>
</body>
</html>