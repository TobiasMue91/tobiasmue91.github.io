<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Gravity Canvas â€“ Paint with Physics</title>
<meta name="description" content="Place gravity wells and launch particles to create mesmerizing orbital art. Physics becomes your brush.">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#06060a;--surface:#0d0d14;--border:#1a1a2e;--text:#e8e8f0;--text-dim:#6a6a80;--accent:#7c5cff;--accent-glow:rgba(124,92,255,0.4);--gold:#ffd700;--danger:#ff4757}
@media(prefers-color-scheme:light){:root{--bg:#f0f0f5;--surface:#ffffff;--border:#d0d0e0;--text:#1a1a2e;--text-dim:#6a6a80}}
body{background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;overflow:hidden;height:100vh;display:flex;flex-direction:column}
header{padding:12px 20px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);background:var(--surface);z-index:10}
h1{font-size:1.1rem;font-weight:600;letter-spacing:-0.02em}
h1 span{color:var(--accent)}
.header-actions{display:flex;gap:8px}
button{background:var(--surface);border:1px solid var(--border);color:var(--text);padding:8px 14px;border-radius:6px;font-size:0.85rem;cursor:pointer;transition:all 0.15s;display:flex;align-items:center;gap:6px}
button:hover{border-color:var(--accent);background:var(--accent);color:#fff}
button.active{background:var(--accent);border-color:var(--accent);color:#fff}
button.danger:hover{border-color:var(--danger);background:var(--danger)}
.canvas-container{flex:1;position:relative;overflow:hidden}
canvas{display:block;cursor:crosshair}
.toolbar{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px 16px;display:flex;align-items:center;gap:16px;box-shadow:0 8px 32px rgba(0,0,0,0.4)}
.tool-group{display:flex;align-items:center;gap:8px}
.tool-group label{font-size:0.75rem;color:var(--text-dim);text-transform:uppercase;letter-spacing:0.05em}
.tool-btn{width:40px;height:40px;padding:0;display:flex;align-items:center;justify-content:center;border-radius:8px}
.tool-btn svg{width:20px;height:20px}
.color-picker{display:flex;gap:4px}
.color-swatch{width:24px;height:24px;border-radius:50%;cursor:pointer;border:2px solid transparent;transition:all 0.15s}
.color-swatch:hover,.color-swatch.active{border-color:var(--text);transform:scale(1.15)}
.timeline{position:absolute;bottom:90px;left:50%;transform:translateX(-50%);background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:12px 20px;display:flex;align-items:center;gap:12px;opacity:0;pointer-events:none;transition:all 0.2s}
.timeline.visible{opacity:1;pointer-events:auto}
.timeline input[type="range"]{width:200px;accent-color:var(--accent)}
.timeline span{font-size:0.8rem;color:var(--text-dim);min-width:60px}
.stats{position:absolute;top:20px;right:20px;background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:10px 14px;font-size:0.75rem;color:var(--text-dim)}
.stats div{margin-bottom:4px}
.stats strong{color:var(--text);font-weight:500}
.hint{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;color:var(--text-dim);pointer-events:none;transition:opacity 0.5s}
.hint h2{font-size:1.2rem;font-weight:500;margin-bottom:8px;color:var(--text)}
.hint p{font-size:0.9rem;line-height:1.6}
.hint.hidden{opacity:0}
.mass-indicator{position:absolute;background:var(--surface);border:1px solid var(--border);border-radius:6px;padding:6px 10px;font-size:0.75rem;pointer-events:none;white-space:nowrap}
@media(max-width:600px){.toolbar{padding:10px 12px;gap:10px;bottom:10px;border-radius:10px}.tool-btn{width:36px;height:36px}.timeline{bottom:80px;padding:10px 14px}.timeline input[type="range"]{width:140px}.stats{top:10px;right:10px;padding:8px 10px}header{padding:10px 14px}h1{font-size:1rem}}
</style>
</head>
<body>
<header>
<h1>Gravity <span>Canvas</span></h1>
<div class="header-actions">
<button id="btnExport" title="Export as PNG"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>Export</button>
<button id="btnClear" class="danger" title="Clear canvas"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg>Clear</button>
</div>
</header>
<div class="canvas-container">
<canvas id="canvas"></canvas>
<div class="hint" id="hint">
<h2>Create Your Universe</h2>
<p>Right-click to place gravity wells<br>Left-click + drag to launch particles<br>Scroll on wells to adjust mass</p>
</div>
<div class="stats" id="stats">
<div>Particles: <strong id="statParticles">0</strong></div>
<div>Gravity Wells: <strong id="statWells">0</strong></div>
</div>
<div class="toolbar">
<div class="tool-group">
<label>Mode</label>
<button class="tool-btn active" id="btnParticle" title="Launch particles (Left click)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 2v4m0 12v4m10-10h-4M6 12H2m15.07-7.07l-2.83 2.83M9.76 14.24l-2.83 2.83m0-10.14l2.83 2.83m4.48 4.48l2.83 2.83"/></svg></button>
<button class="tool-btn" id="btnGravity" title="Place gravity well (Right click)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="9"/><circle cx="12" cy="12" r="4"/><circle cx="12" cy="12" r="1"/></svg></button>
</div>
<div class="tool-group">
<label>Color</label>
<div class="color-picker" id="colorPicker"></div>
</div>
<div class="tool-group">
<label>Trails</label>
<button class="tool-btn" id="btnTrails" title="Toggle trail persistence"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 12c2-4 6-7 10-7s8 3 10 7c-2 4-6 7-10 7s-8-3-10-7z"/><circle cx="12" cy="12" r="3"/></svg></button>
</div>
<div class="tool-group">
<label>Time</label>
<button class="tool-btn" id="btnPause" title="Pause/Play"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" id="iconPause"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" id="iconPlay" style="display:none"><polygon points="5,3 19,12 5,21"/></svg></button>
<button class="tool-btn" id="btnTimeline" title="Show timeline"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg></button>
</div>
</div>
<div class="timeline" id="timeline">
<span id="timeLabel">0.0s</span>
<input type="range" id="timeSlider" min="0" max="100" value="100">
<button id="btnReplay" title="Replay from start"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M1 4v6h6M23 20v-6h-6"/><path d="M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15"/></svg></button>
</div>
</div>
<script>
const canvas=document.getElementById('canvas');const ctx=canvas.getContext('2d');
const colors=['#7c5cff','#00d4aa','#ff6b9d','#ffd700','#00bfff','#ff7b54'];
const particles=[];const gravityWells=[];let history=[];let historyIndex=0;
let isPaused=false;let persistTrails=true;let selectedColor=0;let currentMode='particle';
let isRecording=true;let maxHistoryFrames=600;let lastTime=0;let deltaTime=0;
let mousePos={x:0,y:0};let dragStart=null;let isDragging=false;let selectedWell=null;
function resize(){canvas.width=canvas.offsetWidth*window.devicePixelRatio;canvas.height=canvas.offsetHeight*window.devicePixelRatio;ctx.scale(window.devicePixelRatio,window.devicePixelRatio)}
resize();window.addEventListener('resize',resize);
function initColors(){const picker=document.getElementById('colorPicker');colors.forEach((c,i)=>{const swatch=document.createElement('div');swatch.className='color-swatch'+(i===0?' active':'');swatch.style.background=c;swatch.onclick=()=>{document.querySelectorAll('.color-swatch').forEach(s=>s.classList.remove('active'));swatch.classList.add('active');selectedColor=i};picker.appendChild(swatch)})}
initColors();
class Particle{constructor(x,y,vx,vy,color){this.x=x;this.y=y;this.vx=vx;this.vy=vy;this.color=color;this.trail=[];this.maxTrail=80;this.alive=true;this.age=0}
update(dt){if(!this.alive)return;this.age+=dt;let ax=0,ay=0;gravityWells.forEach(w=>{const dx=w.x-this.x;const dy=w.y-this.y;const dist=Math.sqrt(dx*dx+dy*dy);if(dist<w.radius){this.alive=false;return}const force=w.mass/(dist*dist)*50;ax+=force*dx/dist;ay+=force*dy/dist});this.vx+=ax*dt;this.vy+=ay*dt;const speed=Math.sqrt(this.vx*this.vx+this.vy*this.vy);if(speed>500){this.vx=(this.vx/speed)*500;this.vy=(this.vy/speed)*500}this.x+=this.vx*dt;this.y+=this.vy*dt;this.trail.push({x:this.x,y:this.y,speed:speed});if(this.trail.length>this.maxTrail)this.trail.shift();const w=canvas.offsetWidth,h=canvas.offsetHeight;if(this.x<-100||this.x>w+100||this.y<-100||this.y>h+100)this.alive=false}
draw(ctx){if(this.trail.length<2)return;ctx.lineCap='round';for(let i=1;i<this.trail.length;i++){const p0=this.trail[i-1];const p1=this.trail[i];const alpha=(i/this.trail.length)*0.8;const speed=Math.min(p1.speed/300,1);ctx.beginPath();ctx.moveTo(p0.x,p0.y);ctx.lineTo(p1.x,p1.y);const hue=this.getHue(speed);ctx.strokeStyle=`hsla(${hue},80%,60%,${alpha})`;ctx.lineWidth=2+speed*2;ctx.stroke()}ctx.beginPath();ctx.arc(this.x,this.y,3,0,Math.PI*2);ctx.fillStyle=this.color;ctx.shadowColor=this.color;ctx.shadowBlur=10;ctx.fill();ctx.shadowBlur=0}
getHue(speed){const baseColor=this.color;const match=baseColor.match(/^#([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);if(match){const r=parseInt(match[1],16)/255;const g=parseInt(match[2],16)/255;const b=parseInt(match[3],16)/255;const max=Math.max(r,g,b),min=Math.min(r,g,b);let h;if(max===min)h=0;else if(max===r)h=60*((g-b)/(max-min));else if(max===g)h=60*(2+(b-r)/(max-min));else h=60*(4+(r-g)/(max-min));if(h<0)h+=360;return(h+speed*60)%360}return 260+speed*60}}
class GravityWell{constructor(x,y,mass=100){this.x=x;this.y=y;this.mass=mass;this.radius=Math.sqrt(mass)*2;this.pulsePhase=Math.random()*Math.PI*2}
draw(ctx,time){this.pulsePhase+=0.03;const pulse=1+Math.sin(this.pulsePhase)*0.1;const r=this.radius*pulse;for(let i=4;i>=0;i--){const rr=r+i*8;const alpha=0.1-i*0.018;ctx.beginPath();ctx.arc(this.x,this.y,rr,0,Math.PI*2);ctx.fillStyle=`rgba(124,92,255,${alpha})`;ctx.fill()}ctx.beginPath();ctx.arc(this.x,this.y,r,0,Math.PI*2);const grad=ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,r);grad.addColorStop(0,'rgba(180,160,255,0.9)');grad.addColorStop(0.5,'rgba(124,92,255,0.6)');grad.addColorStop(1,'rgba(60,40,120,0.3)');ctx.fillStyle=grad;ctx.fill();ctx.beginPath();ctx.arc(this.x,this.y,r*0.3,0,Math.PI*2);ctx.fillStyle='rgba(255,255,255,0.8)';ctx.fill()}}
function launchParticle(x,y,vx,vy){const p=new Particle(x,y,vx,vy,colors[selectedColor]);particles.push(p);updateStats();hideHint()}
function addGravityWell(x,y,mass=100){const w=new GravityWell(x,y,mass);gravityWells.push(w);updateStats();hideHint()}
function updateStats(){document.getElementById('statParticles').textContent=particles.filter(p=>p.alive).length;document.getElementById('statWells').textContent=gravityWells.length}
function hideHint(){document.getElementById('hint').classList.add('hidden')}
function saveState(){if(!isRecording||isPaused)return;const state={particles:particles.map(p=>({x:p.x,y:p.y,vx:p.vx,vy:p.vy,color:p.color,trail:[...p.trail],alive:p.alive,age:p.age})),wells:gravityWells.map(w=>({x:w.x,y:w.y,mass:w.mass}))};if(history.length>=maxHistoryFrames){history.shift()}history.push(state);historyIndex=history.length-1;updateTimeSlider()}
function loadState(index){if(index<0||index>=history.length)return;const state=history[index];particles.length=0;state.particles.forEach(p=>{const np=new Particle(p.x,p.y,p.vx,p.vy,p.color);np.trail=[...p.trail];np.alive=p.alive;np.age=p.age;particles.push(np)});gravityWells.length=0;state.wells.forEach(w=>{gravityWells.push(new GravityWell(w.x,w.y,w.mass))});updateStats()}
function updateTimeSlider(){const slider=document.getElementById('timeSlider');slider.max=history.length-1;slider.value=historyIndex;const time=(historyIndex/60).toFixed(1);document.getElementById('timeLabel').textContent=time+'s'}
document.getElementById('timeSlider').addEventListener('input',e=>{historyIndex=parseInt(e.target.value);loadState(historyIndex);isRecording=false;const time=(historyIndex/60).toFixed(1);document.getElementById('timeLabel').textContent=time+'s'});
document.getElementById('timeSlider').addEventListener('change',()=>{if(historyIndex===history.length-1)isRecording=true});
let animationId;function animate(time){animationId=requestAnimationFrame(animate);deltaTime=Math.min((time-lastTime)/1000,0.05);lastTime=time;if(!persistTrails){ctx.fillStyle='rgba(6,6,10,0.15)';ctx.fillRect(0,0,canvas.offsetWidth,canvas.offsetHeight)}if(!isPaused){particles.forEach(p=>p.update(deltaTime));particles.forEach((p,i)=>{if(!p.alive&&p.trail.length===0)particles.splice(i,1)});if(history.length%2===0)saveState()}gravityWells.forEach(w=>w.draw(ctx,time));particles.forEach(p=>p.draw(ctx));if(isDragging&&dragStart){ctx.beginPath();ctx.moveTo(dragStart.x,dragStart.y);ctx.lineTo(mousePos.x,mousePos.y);ctx.strokeStyle='rgba(255,255,255,0.4)';ctx.lineWidth=2;ctx.setLineDash([5,5]);ctx.stroke();ctx.setLineDash([]);const vx=(dragStart.x-mousePos.x)*2;const vy=(dragStart.y-mousePos.y)*2;const speed=Math.sqrt(vx*vx+vy*vy);ctx.beginPath();ctx.arc(dragStart.x,dragStart.y,5+speed*0.02,0,Math.PI*2);ctx.fillStyle=colors[selectedColor];ctx.shadowColor=colors[selectedColor];ctx.shadowBlur=15;ctx.fill();ctx.shadowBlur=0}updateStats()}
animate(0);
canvas.addEventListener('mousedown',e=>{const rect=canvas.getBoundingClientRect();const x=e.clientX-rect.left;const y=e.clientY-rect.top;if(e.button===2||currentMode==='gravity'){addGravityWell(x,y);return}dragStart={x,y};isDragging=true});
canvas.addEventListener('mousemove',e=>{const rect=canvas.getBoundingClientRect();mousePos.x=e.clientX-rect.left;mousePos.y=e.clientY-rect.top});
canvas.addEventListener('mouseup',e=>{if(isDragging&&dragStart&&e.button===0){const vx=(dragStart.x-mousePos.x)*2;const vy=(dragStart.y-mousePos.y)*2;if(Math.abs(vx)>5||Math.abs(vy)>5){launchParticle(dragStart.x,dragStart.y,vx,vy)}else{launchParticle(dragStart.x,dragStart.y,(Math.random()-0.5)*100,(Math.random()-0.5)*100)}}isDragging=false;dragStart=null});
canvas.addEventListener('contextmenu',e=>{e.preventDefault();const rect=canvas.getBoundingClientRect();addGravityWell(e.clientX-rect.left,e.clientY-rect.top)});
canvas.addEventListener('wheel',e=>{const rect=canvas.getBoundingClientRect();const x=e.clientX-rect.left;const y=e.clientY-rect.top;gravityWells.forEach(w=>{const dx=w.x-x;const dy=w.y-y;const dist=Math.sqrt(dx*dx+dy*dy);if(dist<w.radius+30){w.mass=Math.max(20,Math.min(500,w.mass-e.deltaY*0.5));w.radius=Math.sqrt(w.mass)*2}})});
canvas.addEventListener('touchstart',e=>{e.preventDefault();const touch=e.touches[0];const rect=canvas.getBoundingClientRect();const x=touch.clientX-rect.left;const y=touch.clientY-rect.top;if(currentMode==='gravity'){addGravityWell(x,y)}else{dragStart={x,y};isDragging=true}},{passive:false});
canvas.addEventListener('touchmove',e=>{e.preventDefault();const touch=e.touches[0];const rect=canvas.getBoundingClientRect();mousePos.x=touch.clientX-rect.left;mousePos.y=touch.clientY-rect.top},{passive:false});
canvas.addEventListener('touchend',e=>{if(isDragging&&dragStart&&currentMode==='particle'){const vx=(dragStart.x-mousePos.x)*2;const vy=(dragStart.y-mousePos.y)*2;if(Math.abs(vx)>5||Math.abs(vy)>5){launchParticle(dragStart.x,dragStart.y,vx,vy)}else{launchParticle(dragStart.x,dragStart.y,(Math.random()-0.5)*100,(Math.random()-0.5)*100)}}isDragging=false;dragStart=null});
document.getElementById('btnParticle').addEventListener('click',function(){currentMode='particle';this.classList.add('active');document.getElementById('btnGravity').classList.remove('active')});
document.getElementById('btnGravity').addEventListener('click',function(){currentMode='gravity';this.classList.add('active');document.getElementById('btnParticle').classList.remove('active')});
document.getElementById('btnTrails').addEventListener('click',function(){persistTrails=!persistTrails;this.classList.toggle('active',persistTrails);if(!persistTrails){ctx.fillStyle='rgba(6,6,10,1)';ctx.fillRect(0,0,canvas.offsetWidth,canvas.offsetHeight)}});
document.getElementById('btnTrails').classList.add('active');
document.getElementById('btnPause').addEventListener('click',function(){isPaused=!isPaused;document.getElementById('iconPause').style.display=isPaused?'none':'block';document.getElementById('iconPlay').style.display=isPaused?'block':'none';if(!isPaused){isRecording=true;history=history.slice(0,historyIndex+1)}});
document.getElementById('btnTimeline').addEventListener('click',function(){document.getElementById('timeline').classList.toggle('visible');this.classList.toggle('active')});
document.getElementById('btnReplay').addEventListener('click',()=>{historyIndex=0;loadState(0);isRecording=false;document.getElementById('timeSlider').value=0;document.getElementById('timeLabel').textContent='0.0s';isPaused=true;document.getElementById('iconPause').style.display='none';document.getElementById('iconPlay').style.display='block'});
document.getElementById('btnClear').addEventListener('click',()=>{particles.length=0;gravityWells.length=0;history=[];historyIndex=0;ctx.fillStyle=getComputedStyle(document.documentElement).getPropertyValue('--bg');ctx.fillRect(0,0,canvas.offsetWidth,canvas.offsetHeight);document.getElementById('hint').classList.remove('hidden');updateStats();updateTimeSlider()});
document.getElementById('btnExport').addEventListener('click',()=>{const link=document.createElement('a');link.download='gravity-canvas-'+Date.now()+'.png';link.href=canvas.toDataURL('image/png');link.click()});
window.addEventListener('keydown',e=>{if(e.code==='Space'){e.preventDefault();document.getElementById('btnPause').click()}if(e.code==='KeyC')document.getElementById('btnClear').click();if(e.code==='KeyE')document.getElementById('btnExport').click();if(e.code==='KeyT')document.getElementById('btnTrails').click();if(e.code==='Digit1')document.querySelectorAll('.color-swatch')[0]?.click();if(e.code==='Digit2')document.querySelectorAll('.color-swatch')[1]?.click();if(e.code==='Digit3')document.querySelectorAll('.color-swatch')[2]?.click();if(e.code==='Digit4')document.querySelectorAll('.color-swatch')[3]?.click();if(e.code==='Digit5')document.querySelectorAll('.color-swatch')[4]?.click();if(e.code==='Digit6')document.querySelectorAll('.color-swatch')[5]?.click()});
</script>
</body>
</html>
