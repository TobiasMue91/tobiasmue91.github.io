<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera Filters</title>
    <script src="https://cdn.jsdelivr.net/npm/glfx@0.0.4/glfx.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex items-center justify-center h-screen m-0">
<canvas id="canvas"></canvas>
<div id="filterButtons" class="fixed top-0 left-0 p-4 space-y-2"></div>

<script>
    let video = document.createElement('video');
    video.autoplay = true;
    video.style.display = 'none';
    document.body.appendChild(video);

    let glfxCanvas = fx.canvas();
    document.getElementById('canvas').replaceWith(glfxCanvas);
    let currentFilter = 'none';

    async function setupCamera() {
        const stream = await navigator.mediaDevices.getUserMedia({video: true});
        video.srcObject = stream;
        await video.play();

        window.addEventListener('resize', onResize);
        onResize(); // Initial resize

        requestAnimationFrame(update);
    }

    function update() {
        let texture = glfxCanvas.texture(video);
        applyFilter(texture);
        texture.destroy();
        requestAnimationFrame(update);
    }

    function applyCssFilter(filter) {
        const canvas = document.getElementById('canvas');

        switch (filter) {
            case 'grayscale':
                canvas.style.filter = 'grayscale(100%)';
                break;
            case 'contrast':
                canvas.style.filter = 'contrast(150%)';
                break;
            case 'brightness':
                canvas.style.filter = 'brightness(120%)';
                break;
            case 'invert':
                canvas.style.filter = 'invert(20%)';
                break;
            case 'saturate':
                canvas.style.filter = 'saturate(180%)';
                break;
            case 'sepia':
                canvas.style.filter = 'sepia(30%)';
                break;
            case 'blur':
                canvas.style.filter = 'blur(2px)';
                break;
            case 'hueRotate':
                canvas.style.filter = 'hue-rotate(90deg)';
                break;
            case 'dropShadow':
                canvas.style.filter = 'drop-shadow(16px 16px 20px red)';
                break;
            case 'none':
            default:
                canvas.style.filter = 'none';
                break;
        }
    }

    function applyFilter(texture) {
        applyCssFilter('none');

        switch (currentFilter) {
            case 'mirror':
                glfxCanvas.draw(texture).hflip().update();
                break;
            case 'invert':
                glfxCanvas.draw(texture).invert().update();
                break;
            case 'hue':
                glfxCanvas.draw(texture).hueSaturation(0.5, -0.5).update();
                break;
            case 'sharpen':
                glfxCanvas.draw(texture).sharpen(1).update();
                break;
            case 'emboss':
                glfxCanvas.draw(texture).emboss().update();
                break;
            case 'sepia':
                glfxCanvas.draw(texture).sepia(1).update();
                break;
            case 'blur':
                glfxCanvas.draw(texture).triangleBlur(20).update();
                break;
            case 'brightnessContrast':
                glfxCanvas.draw(texture).brightnessContrast(0.1, 0.1).update(); // Adjust as needed
                break;
            case 'hueSaturation':
                glfxCanvas.draw(texture).hueSaturation(-0.5, 0.5).update(); // Adjust as needed
                break;
            case 'vibrance':
                glfxCanvas.draw(texture).vibrance(0.5).update();
                break;
            case 'vignette':
                glfxCanvas.draw(texture).vignette(0.5, 0.5).update();
                break;
            case 'denoise':
                glfxCanvas.draw(texture).denoise(20).update(); // Exponent for denoise, adjust as needed
                break;
            case 'unsharpMask':
                glfxCanvas.draw(texture).unsharpMask(20, 2).update(); // Adjust radius and strength as needed
                break;
            case 'noise':
                glfxCanvas.draw(texture).noise(0.5).update();
                break;
            case 'lensBlur':
                glfxCanvas.draw(texture).lensBlur(15, 0.75, 0).update(); // Adjust radius, brightness, angle as needed
                break;
            case 'zoomBlur':
                glfxCanvas.draw(texture).zoomBlur(glfxCanvas.width / 2, glfxCanvas.height / 2, 0.5).update(); // Center and strength, adjust as needed
                break;
            case 'colorHalftone':
                glfxCanvas.draw(texture).colorHalftone(glfxCanvas.width / 2, glfxCanvas.height / 2, 0, 10).update(); // Center, angle, size
                break;
            case 'dotScreen':
                glfxCanvas.draw(texture).dotScreen(glfxCanvas.width / 2, glfxCanvas.height / 2, 0, 10).update(); // Center, angle, size
                break;
            case 'edgeWork':
                glfxCanvas.draw(texture).edgeWork(10).update(); // Radius
                break;
            case 'hexagonalPixelate':
                glfxCanvas.draw(texture).hexagonalPixelate(glfxCanvas.width / 2, glfxCanvas.height / 2, 20).update(); // Center, scale
                break;
            case 'ink':
                glfxCanvas.draw(texture).ink(0.25).update(); // Strength, adjust as needed
                break;
            case 'bulgePinch':
                glfxCanvas.draw(texture).bulgePinch(glfxCanvas.width / 2, glfxCanvas.height / 2, 100, 0.5).update(); // Center, radius, strength
                break;
            case 'swirl':
                glfxCanvas.draw(texture).swirl(glfxCanvas.width / 2, glfxCanvas.height / 2, 200, 3).update(); // Center, radius, angle
                break;
            case 'none':
            default:
                glfxCanvas.draw(texture).update();
                break;
        }
    }

    function onResize() {
        glfxCanvas.width = window.innerWidth;
        glfxCanvas.height = window.innerHeight;
    }

    function createFilterButtons() {
        const filters = ['none', 'mirror', 'invert', 'sepia', 'noise', 'hue', 'vignette', 'blur', 'sharpen', 'emboss', 'edgeWork'];
        const container = document.getElementById('filterButtons');

        filters.forEach(filter => {
            let button = document.createElement('button');
            button.textContent = filter;
            button.className = 'bg-gray-800 text-white font-bold py-2 px-4 rounded m-1';
            button.onclick = () => { currentFilter = filter; };
            container.appendChild(button);
        });
    }

    createFilterButtons();
    setupCamera();
</script>
</body>
</html>