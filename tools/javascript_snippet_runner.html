<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Snippet Runner</title>
    <link rel="icon"
          href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üíª</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/material-darker.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #1a1a1a;
            color: #e0e0e0;
            height: 100vh;
            display: flex;
            flex-direction: column
        }

        .header {
            background: #242424;
            padding: 16px 24px;
            border-bottom: 2px solid #2196f3;
            display: flex;
            justify-content: space-between;
            align-items: center
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
            color: #fff
        }

        .header-controls {
            display: flex;
            gap: 12px;
            align-items: center
        }

        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden
        }

        .editor-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #242424;
            border-bottom: 1px solid #333
        }

        .toolbar {
            background: #2a2a2a;
            padding: 12px 16px;
            display: flex;
            gap: 8px;
            align-items: center;
            border-bottom: 1px solid #333
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            background: #2196f3;
            color: #fff;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: background .2s;
            white-space: nowrap
        }

        .btn:hover {
            background: #1976d2
        }

        .btn:active {
            transform: translateY(1px)
        }

        .btn-secondary {
            background: #424242
        }

        .btn-secondary:hover {
            background: #505050
        }

        .btn-danger {
            background: #f44336
        }

        .btn-danger:hover {
            background: #d32f2f
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px
        }

        .editor-wrapper {
            flex: 1;
            overflow: hidden
        }

        .CodeMirror {
            height: 100% !important;
            font-size: 14px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace
        }

        .console-panel {
            height: 280px;
            display: flex;
            flex-direction: column;
            background: #1e1e1e
        }

        .console-header {
            background: #2a2a2a;
            padding: 10px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333
        }

        .console-header h3 {
            font-size: 14px;
            font-weight: 600;
            color: #fff
        }

        .console-controls {
            display: flex;
            gap: 8px
        }

        .console-output {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.6
        }

        .console-output::-webkit-scrollbar {
            width: 10px
        }

        .console-output::-webkit-scrollbar-track {
            background: #1e1e1e
        }

        .console-output::-webkit-scrollbar-thumb {
            background: #424242;
            border-radius: 5px
        }

        .console-output::-webkit-scrollbar-thumb:hover {
            background: #505050
        }

        .log-entry {
            padding: 4px 0;
            display: flex;
            gap: 8px;
            align-items: flex-start
        }

        .log-timestamp {
            color: #757575;
            font-size: 11px;
            white-space: nowrap;
            user-select: none
        }

        .log-content {
            flex: 1;
            word-break: break-word
        }

        .log-type-log {
            color: #e0e0e0
        }

        .log-type-info {
            color: #2196f3
        }

        .log-type-warn {
            color: #ff9800
        }

        .log-type-error {
            color: #f44336
        }

        .log-object {
            color: #4caf50
        }

        .log-string {
            color: #ffeb3b
        }

        .log-number {
            color: #00bcd4
        }

        .log-boolean {
            color: #9c27b0
        }

        .log-null {
            color: #757575
        }

        .status-bar {
            background: #2a2a2a;
            padding: 8px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #333;
            font-size: 12px;
            color: #999
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 6px
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4caf50
        }

        .status-dot.executing {
            background: #ff9800;
            animation: pulse 1s infinite
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1
            }
            50% {
                opacity: .5
            }
        }

        .settings-panel {
            position: fixed;
            top: 0;
            right: -320px;
            width: 320px;
            height: 100vh;
            background: #242424;
            box-shadow: -2px 0 8px rgba(0, 0, 0, .5);
            transition: right .3s;
            z-index: 1000;
            display: flex;
            flex-direction: column
        }

        .settings-panel.open {
            right: 0
        }

        .settings-header {
            padding: 16px;
            background: #2a2a2a;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center
        }

        .settings-header h3 {
            font-size: 16px;
            font-weight: 600
        }

        .settings-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px
        }

        .setting-group {
            margin-bottom: 24px
        }

        .setting-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 13px;
            font-weight: 500;
            color: #bbb
        }

        .setting-group input[type="range"] {
            width: 100%;
            accent-color: #2196f3
        }

        .setting-group input[type="checkbox"] {
            margin-right: 8px;
            accent-color: #2196f3
        }

        .setting-value {
            display: inline-block;
            margin-left: 8px;
            color: #2196f3;
            font-weight: 600
        }

        .close-btn {
            background: transparent;
            border: none;
            color: #999;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center
        }

        .close-btn:hover {
            color: #fff
        }

        .empty-console {
            color: #666;
            text-align: center;
            padding: 40px;
            font-style: italic
        }

        .shortcuts {
            font-size: 11px;
            color: #666;
            padding: 4px 0
        }

        .shortcuts kbd {
            background: #333;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
            color: #bbb;
            margin: 0 2px
        }
    </style>
</head>
<body>
<div class="header">
    <h1>JavaScript Snippet Runner</h1>
    <div class="header-controls">
        <button class="btn btn-small btn-secondary" id="settings-btn">‚öôÔ∏è Settings</button>
    </div>
</div>
<div class="container">
    <div class="editor-panel">
        <div class="toolbar">
            <button class="btn" id="run-btn">‚ñ∂ Run</button>
            <button class="btn btn-secondary" id="clear-editor-btn">Clear Editor</button>
            <button class="btn btn-secondary btn-small" id="format-btn">Format</button>
            <div style="flex:1"></div>
            <div class="shortcuts">
                <kbd>Ctrl</kbd>+<kbd>Enter</kbd> Run | <kbd>Ctrl</kbd>+<kbd>K</kbd> Clear Console
            </div>
        </div>
        <div class="editor-wrapper" id="editor"></div>
    </div>
    <div class="console-panel">
        <div class="console-header">
            <h3>Console Output</h3>
            <div class="console-controls">
                <button class="btn btn-small btn-secondary" id="copy-output-btn">üìã Copy</button>
                <button class="btn btn-small btn-danger" id="clear-console-btn">Clear</button>
            </div>
        </div>
        <div class="console-output" id="console-output">
            <div class="empty-console">Run your code to see output here</div>
        </div>
    </div>
</div>
<div class="status-bar">
    <div class="status-item">
        <span class="status-dot" id="status-dot"></span>
        <span id="status-text">Ready</span>
    </div>
    <div class="status-item">
        <span id="execution-time"></span>
    </div>
</div>
<div class="settings-panel" id="settings-panel">
    <div class="settings-header">
        <h3>Settings</h3>
        <button class="close-btn" id="close-settings-btn">√ó</button>
    </div>
    <div class="settings-content">
        <div class="setting-group">
            <label>Font Size <span class="setting-value" id="font-size-value">14px</span></label>
            <input type="range" id="font-size-range" min="10" max="24" value="14">
        </div>
        <div class="setting-group">
            <label><input type="checkbox" id="timestamps-checkbox" checked> Show Timestamps</label>
        </div>
        <div class="setting-group">
            <label><input type="checkbox" id="line-wrap-checkbox"> Line Wrapping</label>
        </div>
        <div class="setting-group">
            <label><input type="checkbox" id="auto-save-checkbox" checked> Auto-save Code</label>
        </div>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
<script>
    const STORAGE_KEY = 'jsrunner_code';
    const editor = CodeMirror(document.getElementById('editor'), {
        mode: 'javascript',
        lineNumbers: true,
        theme: 'material-darker',
        tabSize: 2,
        indentWithTabs: false,
        lineWrapping: false,
        matchBrackets: true,
        autoCloseBrackets: true,
        extraKeys: {
            'Ctrl-Enter': () => runCode(),
            'Cmd-Enter': () => runCode(),
            'Ctrl-K': () => clearConsole(),
            'Cmd-K': () => clearConsole()
        }
    });
    const defaultCode = `// Welcome to JavaScript Snippet Runner!\n// Try running this example:\n\nfunction fibonacci(n) {\n  if (n <= 1) return n;\n  return fibonacci(n - 1) + fibonacci(n - 2);\n}\n\nconst result = fibonacci(10);\nconsole.log('Fibonacci(10):', result);\n\nconst data = {\n  name: 'JavaScript',\n  year: 1995,\n  features: ['dynamic', 'prototype-based', 'functional']\n};\n\nconsole.info('Language data:', data);\nconsole.warn('This is a warning message');\nconsole.log('Ready to code!');`;
    const savedCode = localStorage.getItem(STORAGE_KEY);
    editor.setValue(savedCode || defaultCode);
    const consoleOutput = document.getElementById('console-output');
    const statusDot = document.getElementById('status-dot');
    const statusText = document.getElementById('status-text');
    const executionTime = document.getElementById('execution-time');
    let showTimestamps = true;
    let logs = [];

    function formatValue(val) {
        if (val === null) return '<span class="log-null">null</span>';
        if (val === undefined) return '<span class="log-null">undefined</span>';
        const type = typeof val;
        if (type === 'string') return `<span class="log-string">"${val}"</span>`;
        if (type === 'number') return `<span class="log-number">${val}</span>`;
        if (type === 'boolean') return `<span class="log-boolean">${val}</span>`;
        if (type === 'object') {
            try {
                return `<span class="log-object">${JSON.stringify(val, null, 2)}</span>`
            } catch (e) {
                return `<span class="log-object">${String(val)}</span>`
            }
        }
        return String(val)
    }

    function addLog(type, args) {
        const timestamp = new Date().toLocaleTimeString('en-US', {hour12: false});
        const content = Array.from(args).map(formatValue).join(' ');
        logs.push({type, content, timestamp});
        renderConsole()
    }

    function renderConsole() {
        if (logs.length === 0) {
            consoleOutput.innerHTML = '<div class="empty-console">Run your code to see output here</div>';
            return
        }
        consoleOutput.innerHTML = logs.map(log => `<div class="log-entry"><span class="log-timestamp">${showTimestamps ? log.timestamp : ''}</span><span class="log-content log-type-${log.type}">${log.content}</span></div>`).join('');
        consoleOutput.scrollTop = consoleOutput.scrollHeight
    }

    function clearConsole() {
        logs = [];
        renderConsole()
    }

    function runCode() {
        const startTime = performance.now();
        statusDot.classList.add('executing');
        statusText.textContent = 'Executing...';
        executionTime.textContent = '';
        clearConsole();
        const originalLog = console.log;
        const originalInfo = console.info;
        const originalWarn = console.warn;
        const originalError = console.error;
        console.log = function () {
            addLog('log', arguments);
            originalLog.apply(console, arguments)
        };
        console.info = function () {
            addLog('info', arguments);
            originalInfo.apply(console, arguments)
        };
        console.warn = function () {
            addLog('warn', arguments);
            originalWarn.apply(console, arguments)
        };
        console.error = function () {
            addLog('error', arguments);
            originalError.apply(console, arguments)
        };
        try {
            const code = editor.getValue();
            const result = eval(code);
            if (result !== undefined) {
                addLog('log', [`‚Üí ${formatValue(result)}`])
            }
        } catch (error) {
            addLog('error', [`Error: ${error.message}`]);
            console.error = originalError;
            console.error(error)
        } finally {
            console.log = originalLog;
            console.info = originalInfo;
            console.warn = originalWarn;
            console.error = originalError;
            const endTime = performance.now();
            const duration = (endTime - startTime).toFixed(2);
            statusDot.classList.remove('executing');
            statusText.textContent = 'Ready';
            executionTime.textContent = `Executed in ${duration}ms`
        }
    }

    document.getElementById('run-btn').addEventListener('click', runCode);
    document.getElementById('clear-console-btn').addEventListener('click', clearConsole);
    document.getElementById('clear-editor-btn').addEventListener('click', () => {
        if (confirm('Clear all code?')) {
            editor.setValue('')
        }
    });
    document.getElementById('format-btn').addEventListener('click', () => {
        try {
            const code = editor.getValue();
            const formatted = code.split('\n').map(line => line.trim()).join('\n');
            editor.setValue(formatted)
        } catch (e) {
            addLog('error', ['Could not format code'])
        }
    });
    document.getElementById('copy-output-btn').addEventListener('click', () => {
        const text = logs.map(log => `[${log.type.toUpperCase()}] ${log.content.replace(/<[^>]*>/g, '')}`).join('\n');
        navigator.clipboard.writeText(text).then(() => {
            statusText.textContent = 'Output copied!';
            setTimeout(() => statusText.textContent = 'Ready', 2000)
        })
    });
    const settingsPanel = document.getElementById('settings-panel');
    document.getElementById('settings-btn').addEventListener('click', () => settingsPanel.classList.add('open'));
    document.getElementById('close-settings-btn').addEventListener('click', () => settingsPanel.classList.remove('open'));
    const fontSizeRange = document.getElementById('font-size-range');
    const fontSizeValue = document.getElementById('font-size-value');
    fontSizeRange.addEventListener('input', e => {
        const size = e.target.value;
        fontSizeValue.textContent = `${size}px`;
        document.querySelector('.CodeMirror').style.fontSize = `${size}px`;
        editor.refresh()
    });
    document.getElementById('timestamps-checkbox').addEventListener('change', e => {
        showTimestamps = e.target.checked;
        renderConsole()
    });
    document.getElementById('line-wrap-checkbox').addEventListener('change', e => {
        editor.setOption('lineWrapping', e.target.checked)
    });
    const autoSaveCheckbox = document.getElementById('auto-save-checkbox');
    editor.on('change', () => {
        if (autoSaveCheckbox.checked) {
            localStorage.setItem(STORAGE_KEY, editor.getValue())
        }
    });
    window.addEventListener('beforeunload', () => {
        if (autoSaveCheckbox.checked) {
            localStorage.setItem(STORAGE_KEY, editor.getValue())
        }
    });
</script>
</body>
</html>