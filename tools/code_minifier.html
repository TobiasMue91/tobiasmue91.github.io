<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <title>Code Minifier - Online Tool for Minifying JavaScript, CSS, HTML and more</title>
    <meta name="description" content="Free online code minifier tool that compresses JavaScript, CSS, HTML, JSON, SQL, Python, and PHP code to reduce file size and improve website loading speed.">
    <meta name="keywords" content="code minifier, code compressor, JavaScript minifier, CSS minifier, HTML minifier, minify code, reduce file size, web optimization, JSON minifier, code beautifier">
    <meta name="author" content="Claude 3.7 Sonnet prompted by Tobias Müller">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.gptgames.dev/tools/code_minifier.html">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.gptgames.dev/tools/code_minifier.html">
    <meta property="og:title" content="Code Minifier - Compress Your Code to Improve Performance">
    <meta property="og:description" content="Free online tool to minify JavaScript, CSS, HTML, and more. Reduce file size, remove comments and whitespace, and optimize your code for faster loading.">
    <meta property="og:image" content="https://www.gptgames.dev/screenshots/screenshot_178.png">
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://www.gptgames.dev/tools/code_minifier.html">
    <meta property="twitter:title" content="Code Minifier - Optimize Your Web Code">
    <meta property="twitter:description" content="Minify and optimize your code with this free online tool. Supports JavaScript, CSS, HTML, JSON, Python, PHP and more.">
    <meta property="twitter:image" content="https://www.gptgames.dev/screenshots/screenshot_178.png">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📦</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/theme/dracula.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/theme/eclipse.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/css/css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/php/php.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/sql/sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/jsx/jsx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/selection/active-line.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/terser@5.16.1/dist/bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.7/beautify.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.7/beautify-css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.7/beautify-html.min.js"></script>
    <style>:root {
        --primary: #4a6eb5;
        --primary-light: #6384c4;
        --primary-dark: #3a5a95;
        --secondary: #6ea589;
        --accent: #e67e22;
        --bg: #ffffff;
        --panel-bg: #f5f5f5;
        --text: #333333;
        --text-light: #666666;
        --border: #dddddd;
        --shadow: rgba(0, 0, 0, 0.1);
        --header-bg: #2c3e50;
        --header-text: #fff;
        --notification-bg: #2ecc71;
        --notification-error: #e74c3c;
        --transition: all 0.3s ease
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --primary: #6384c4;
            --primary-light: #7a99d5;
            --primary-dark: #4e6da9;
            --secondary: #6ea589;
            --accent: #f39c12;
            --bg: #121212;
            --panel-bg: #1e1e1e;
            --text: #e0e0e0;
            --text-light: #a0a0a0;
            --border: #444444;
            --shadow: rgba(0, 0, 0, 0.3);
            --header-bg: #1a1a1a;
            --header-text: #e0e0e0;
            --notification-bg: #27ae60;
            --notification-error: #c0392b
        }

        body.light-theme {
            --primary: #4a6eb5;
            --primary-light: #6384c4;
            --primary-dark: #3a5a95;
            --secondary: #6ea589;
            --accent: #e67e22;
            --bg: #ffffff;
            --panel-bg: #f5f5f5;
            --text: #333333;
            --text-light: #666666;
            --border: #dddddd;
            --shadow: rgba(0, 0, 0, 0.1);
            --header-bg: #2c3e50;
            --header-text: #fff;
            --notification-bg: #2ecc71;
            --notification-error: #e74c3c
        }
    }

    @media (prefers-color-scheme: light) {
        body.dark-theme {
            --primary: #6384c4;
            --primary-light: #7a99d5;
            --primary-dark: #4e6da9;
            --secondary: #6ea589;
            --accent: #f39c12;
            --bg: #121212;
            --panel-bg: #1e1e1e;
            --text: #e0e0e0;
            --text-light: #a0a0a0;
            --border: #444444;
            --shadow: rgba(0, 0, 0, 0.3);
            --header-bg: #1a1a1a;
            --header-text: #e0e0e0;
            --notification-bg: #27ae60;
            --notification-error: #c0392b
        }
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background-color: var(--bg);
        color: var(--text);
        line-height: 1.6;
        transition: var(--transition);
        min-height: 100vh;
        display: flex;
        flex-direction: column
    }

    header {
        background-color: var(--header-bg);
        color: var(--header-text);
        padding: 1rem 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 5px var(--shadow);
        position: sticky;
        top: 0;
        z-index: 100
    }

    h1 {
        font-size: 1.5rem;
        font-weight: 600
    }

    .controls {
        display: flex;
        align-items: center;
        gap: 1rem
    }

    select, button {
        padding: 0.5rem 1rem;
        border: 1px solid var(--border);
        border-radius: 4px;
        background-color: var(--panel-bg);
        color: var(--text);
        cursor: pointer;
        font-size: 0.9rem;
        transition: var(--transition)
    }

    select {
        padding-right: 2rem;
        appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 0.5rem center;
        background-size: 1em
    }

    button:hover {
        background-color: var(--primary-light);
        color: white;
        border-color: var(--primary-light)
    }

    .primary-btn {
        background-color: var(--primary);
        color: white;
        border-color: var(--primary)
    }

    .primary-btn:hover {
        background-color: var(--primary-dark);
        border-color: var(--primary-dark)
    }

    main {
        flex: 1;
        padding: 1rem;
        max-width: 1400px;
        margin: 0 auto;
        width: 100%
    }

    .container {
        display: grid;
        grid-template-columns:1fr auto 1fr;
        gap: 1rem;
        height: calc(100vh - 150px)
    }

    .panel {
        background-color: var(--panel-bg);
        border-radius: 8px;
        padding: 1rem;
        box-shadow: 0 2px 10px var(--shadow);
        display: flex;
        flex-direction: column;
        overflow: hidden
    }

    h2 {
        font-size: 1.2rem;
        margin-bottom: 0.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        color: var(--text)
    }

    h3 {
        font-size: 1rem;
        margin: 0.5rem 0;
        color: var(--text-light)
    }

    .code-container {
        flex: 1;
        position: relative;
        overflow: hidden;
        border-radius: 4px;
        border: 1px solid var(--border)
    }

    .CodeMirror {
        height: 100% !important;
        font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        font-size: 14px
    }

    .actions {
        display: flex;
        justify-content: flex-end;
        gap: 0.5rem;
        margin-top: 0.5rem
    }

    .settings-container {
        flex: 1;
        overflow-y: auto;
        padding-right: 0.5rem
    }

    .setting-group {
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid var(--border)
    }

    .setting {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin: 0.5rem 0
    }

    .setting input[type="checkbox"] {
        appearance: none;
        width: 1.1rem;
        height: 1.1rem;
        border: 1px solid var(--border);
        border-radius: 3px;
        outline: none;
        cursor: pointer;
        transition: var(--transition);
        position: relative
    }

    .setting input[type="checkbox"]:checked {
        background-color: var(--primary);
        border-color: var(--primary)
    }

    .setting input[type="checkbox"]:checked::after {
        content: '';
        position: absolute;
        left: 4px;
        top: 1px;
        width: 4px;
        height: 8px;
        border: solid white;
        border-width: 0 2px 2px 0;
        transform: rotate(45deg)
    }

    #stats {
        font-size: 0.8rem;
        font-weight: normal;
        color: var(--secondary);
        margin-left: 1rem
    }

    .notification {
        position: fixed;
        bottom: 20px;
        right: 20px;
        padding: 10px 15px;
        background-color: var(--notification-bg);
        color: white;
        border-radius: 4px;
        box-shadow: 0 2px 10px var(--shadow);
        opacity: 0;
        transform: translateY(20px);
        transition: var(--transition);
        z-index: 1000
    }

    .notification.show {
        opacity: 1;
        transform: translateY(0)
    }

    .notification.error {
        background-color: var(--notification-error)
    }

    footer {
        text-align: center;
        padding: 1rem;
        font-size: 0.9rem;
        color: var(--text);
        opacity: 0.7;
        background-color: var(--panel-bg);
        margin-top: 1rem
    }

    .CodeMirror {
        background-color: var(--panel-bg) !important;
        color: var(--text) !important;
        border: none
    }

    .CodeMirror-gutters {
        background-color: var(--panel-bg) !important;
        border-right: 1px solid var(--border) !important
    }

    .CodeMirror-linenumber {
        color: var(--text) !important;
        opacity: 0.5
    }

    .drag-over {
        border: 2px dashed var(--primary) !important;
        background-color: rgba(74, 110, 181, 0.1)
    }

    @media (max-width: 1024px) {
        .container {
            grid-template-columns:1fr;
            grid-template-rows:repeat(3, auto);
            height: auto
        }

        .panel {
            height: 300px
        }

        .settings-panel {
            height: auto;
            max-height: 400px
        }
    }

    @media (max-width: 768px) {
        header {
            flex-direction: column;
            gap: 1rem;
            text-align: center;
            padding: 1rem
        }

        main {
            padding: 0.5rem
        }

        .panel {
            height: 250px
        }
    }

    @media (max-width: 480px) {
        .actions {
            flex-wrap: wrap
        }

        button, select {
            flex: 1;
            min-width: 80px;
            padding: 0.4rem;
            font-size: 0.8rem
        }
    }

    .js-settings, .html-settings, .css-settings {
        display: none
    }

    body[data-language="javascript"] .js-settings, body[data-language="jsx"] .js-settings, body[data-language="html"] .html-settings, body[data-language="css"] .css-settings {
        display: block
    }</style>
</head>
<body>
<header><h1>Code Minifier</h1>
    <div class="controls"><select id="language-selector">
        <option value="auto">Auto Detect</option>
        <option value="javascript">JavaScript</option>
        <option value="jsx">JSX/React</option>
        <option value="css">CSS</option>
        <option value="html">HTML</option>
        <option value="json">JSON</option>
        <option value="python">Python</option>
        <option value="php">PHP</option>
        <option value="sql">SQL</option>
        <option value="mixed">Mixed Content</option>
    </select>
        <button id="theme-toggle" title="Toggle Dark/Light Mode">🌙</button>
    </div>
</header>
<main>
    <div class="container">
        <div class="panel input-panel"><h2>Original Code</h2>
            <div class="code-container"><textarea id="input-code"></textarea></div>
            <div class="actions">
                <button id="clear-btn" title="Clear editor">Clear</button>
                <button id="paste-btn" title="Paste from clipboard">Paste</button>
                <button id="upload-btn" title="Upload file">Upload</button>
                <input type="file" id="file-input" style="display:none"></div>
        </div>
        <div class="panel settings-panel"><h2>Settings</h2>
            <div class="settings-container">
                <div class="setting-group"><h3>Common Options</h3>
                    <div class="setting"><input type="checkbox" id="remove-comments" checked><label
                            for="remove-comments">Remove Comments</label></div>
                    <div class="setting"><input type="checkbox" id="remove-whitespace" checked><label
                            for="remove-whitespace">Remove Whitespace</label></div>
                </div>
                <div class="setting-group js-settings"><h3>JavaScript Options</h3>
                    <div class="setting"><input type="checkbox" id="compress-variables" checked><label
                            for="compress-variables">Compress Variables</label></div>
                    <div class="setting"><input type="checkbox" id="mangle" checked><label for="mangle">Mangle
                        Names</label></div>
                    <div class="setting"><input type="checkbox" id="keep-fnames"><label for="keep-fnames">Keep Function
                        Names</label></div>
                </div>
                <div class="setting-group html-settings"><h3>HTML Options</h3>
                    <div class="setting"><input type="checkbox" id="collapse-whitespace" checked><label
                            for="collapse-whitespace">Collapse Whitespace</label></div>
                    <div class="setting"><input type="checkbox" id="remove-attr-quotes"><label for="remove-attr-quotes">Remove
                        Attribute Quotes</label></div>
                    <div class="setting"><input type="checkbox" id="minify-inline" checked><label for="minify-inline">Minify
                        Inline JS/CSS</label></div>
                </div>
                <div class="setting-group css-settings"><h3>CSS Options</h3>
                    <div class="setting"><input type="checkbox" id="optimize-css" checked><label for="optimize-css">Optimize
                        Properties</label></div>
                    <div class="setting"><input type="checkbox" id="merge-media" checked><label for="merge-media">Merge
                        Media Queries</label></div>
                </div>
            </div>
            <div class="actions">
                <button id="minify-btn" class="primary-btn">Minify</button>
                <button id="beautify-btn">Beautify</button>
            </div>
        </div>
        <div class="panel output-panel"><h2>Minified Code<span id="stats"></span></h2>
            <div class="code-container"><textarea id="output-code"></textarea></div>
            <div class="actions">
                <button id="copy-btn" title="Copy to clipboard">Copy</button>
                <button id="download-btn" title="Download file">Download</button>
            </div>
        </div>
    </div>
</main>
<div id="notification" class="notification"></div>
<footer><p>Code Minifier - Fast and powerful minification for multiple programming languages</p></footer>
<script>document.addEventListener('DOMContentLoaded', () => {
    const inputEditor = CodeMirror.fromTextArea(document.getElementById('input-code'), {
        lineNumbers: true,
        mode: 'javascript',
        theme: 'default',
        autoCloseBrackets: true,
        matchBrackets: true,
        styleActiveLine: true,
        indentUnit: 2,
        tabSize: 2
    });
    const outputEditor = CodeMirror.fromTextArea(document.getElementById('output-code'), {
        lineNumbers: true,
        mode: 'javascript',
        theme: 'default',
        readOnly: true
    });
    const themeToggle = document.getElementById('theme-toggle');

    function updateTheme() {
        const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme:dark)').matches;
        const userTheme = localStorage.getItem('theme');
        if (userTheme === 'dark' || (userTheme !== 'light' && isDarkMode)) {
            document.body.classList.add('dark-theme');
            document.body.classList.remove('light-theme');
            themeToggle.textContent = '☀️';
        } else {
            document.body.classList.add('light-theme');
            document.body.classList.remove('dark-theme');
            themeToggle.textContent = '🌙';
        }
        const codeMirrorTheme = document.body.classList.contains('dark-theme') ? 'dracula' : 'eclipse';
        inputEditor.setOption('theme', codeMirrorTheme);
        outputEditor.setOption('theme', codeMirrorTheme);
    }

    updateTheme();
    themeToggle.addEventListener('click', () => {
        if (document.body.classList.contains('dark-theme')) {
            localStorage.setItem('theme', 'light');
        } else {
            localStorage.setItem('theme', 'dark');
        }
        updateTheme();
    });
    window.matchMedia('(prefers-color-scheme:dark)').addEventListener('change', updateTheme);

    function detectLanguage(code) {
        code = code.trim();
        if (code.startsWith('<!DOCTYPE html') || code.startsWith('<html') || (code.startsWith('<') && code.includes('</') && code.includes('>'))) {
            return 'html';
        }
        if (code.includes('{') && code.includes('}') && (code.includes(':') && !code.includes(';{')) && (code.includes(';') || code.includes('px') || code.includes('em'))) {
            if (code.includes('@media') || code.includes('@keyframes') || code.includes('margin:') || code.includes('padding:')) {
                return 'css';
            }
        }
        try {
            if ((code.startsWith('{') && code.endsWith('}')) || (code.startsWith('[') && code.endsWith(']'))) {
                JSON.parse(code);
                return 'json';
            }
        } catch (e) {
        }
        if (code.includes('def ') && code.includes(':') && (code.includes('import ') || code.includes('print(') || code.includes('if ') || code.includes('for '))) {
            return 'python';
        }
        if (code.includes('<?php') || code.includes('<?=') || (code.includes('$') && code.includes(';') && (code.includes('function') || code.includes('echo')))) {
            return 'php';
        }
        if ((code.includes('SELECT') || code.includes('INSERT INTO') || code.includes('CREATE TABLE') || code.includes('UPDATE')) && (code.includes('FROM') || code.includes('WHERE') || code.includes('VALUES'))) {
            return 'sql';
        }
        if (code.includes('import React') || code.includes('className=') || (code.includes('<') && code.includes('/>') && code.includes('props'))) {
            return 'jsx';
        }
        return 'javascript';
    }

    const languageSelector = document.getElementById('language-selector');

    function updateLanguageMode() {
        const language = languageSelector.value;
        document.body.setAttribute('data-language', language);
        if (language === 'auto') {
            const content = inputEditor.getValue();
            if (!content.trim()) return;
            const detectedLang = detectLanguage(content);
            setEditorMode(detectedLang);
        } else {
            setEditorMode(language);
        }
    }

    function setEditorMode(language) {
        let mode;
        switch (language) {
            case'javascript':
                mode = 'javascript';
                break;
            case'jsx':
                mode = 'jsx';
                break;
            case'css':
                mode = 'css';
                break;
            case'html':
                mode = 'htmlmixed';
                break;
            case'json':
                mode = 'application/json';
                break;
            case'python':
                mode = 'python';
                break;
            case'php':
                mode = 'php';
                break;
            case'sql':
                mode = 'sql';
                break;
            default:
                mode = 'javascript';
        }
        inputEditor.setOption('mode', mode);
        if (outputEditor.getValue().trim()) {
            outputEditor.setOption('mode', mode);
        }
    }

    languageSelector.addEventListener('change', updateLanguageMode);

    function showNotification(message, isError = false) {
        const notification = document.getElementById('notification');
        notification.textContent = message;
        notification.classList.add('show');
        if (isError) {
            notification.classList.add('error');
        } else {
            notification.classList.remove('error');
        }
        setTimeout(() => {
            notification.classList.remove('show');
        }, 3000);
    }

    function minifyHTML(html, options) {
        let minified = html;
        if (options.removeComments) {
            minified = minified.replace(/<!--[\s\S]*?-->/g, '');
        }
        if (options.collapseWhitespace) {
            minified = minified.replace(/\s+/g, ' ');
            minified = minified.replace(/>\s+</g, '><');
            minified = minified.replace(/\s+>/g, '>');
            minified = minified.replace(/<\s+/g, '<');
        }
        if (options.removeAttributeQuotes) {
            minified = minified.replace(/(\s+)([a-zA-Z0-9-_]+)="([^"]*?)"/g, function (match, space, name, value) {
                if (/^[a-zA-Z0-9-_\/\.]+$/.test(value)) {
                    return space + name + '=' + value;
                }
                return match;
            });
        }
        return minified;
    }

    async function minifyCode() {
        const code = inputEditor.getValue();
        if (!code.trim()) {
            showNotification('Please enter some code to minify', true);
            return;
        }
        const language = languageSelector.value === 'auto' ? detectLanguage(code) : languageSelector.value;
        const removeComments = document.getElementById('remove-comments').checked;
        const removeWhitespace = document.getElementById('remove-whitespace').checked;
        const compressVariables = document.getElementById('compress-variables').checked;
        const mangle = document.getElementById('mangle').checked;
        const keepFnames = document.getElementById('keep-fnames').checked;
        const collapseWhitespace = document.getElementById('collapse-whitespace').checked;
        const removeAttrQuotes = document.getElementById('remove-attr-quotes').checked;
        const minifyInline = document.getElementById('minify-inline').checked;
        const optimizeCss = document.getElementById('optimize-css').checked;
        const mergeMedia = document.getElementById('merge-media').checked;
        try {
            let minified = '';
            switch (language) {
                case'javascript':
                case'jsx':
                    const terserOptions = {
                        compress: compressVariables ? {
                            dead_code: true,
                            drop_console: false,
                            drop_debugger: true,
                            keep_fargs: true,
                            unused: true,
                            sequences: true,
                            booleans: true
                        } : false,
                        mangle: mangle ? {keep_fnames: keepFnames} : false,
                        output: {comments: removeComments ? false : 'some', beautify: !removeWhitespace}
                    };
                    const jsResult = await Terser.minify(code, terserOptions);
                    minified = jsResult.code;
                    break;
                case'css':
                    let cssMinified = code;
                    if (removeComments) {
                        cssMinified = cssMinified.replace(/\/\*[\s\S]*?\*\//g, '');
                    }
                    if (removeWhitespace) {
                        cssMinified = cssMinified.replace(/\s+/g, ' ');
                        cssMinified = cssMinified.replace(/\s*({|}|\(|\)|\[|\]|:|;|,|>)\s*/g, '$1');
                        cssMinified = cssMinified.replace(/;\s*}/g, '}');
                    }
                    if (optimizeCss) {
                        cssMinified = cssMinified.replace(/0px/g, '0');
                        cssMinified = cssMinified.replace(/(^|[^0-9])0+\.([0-9]+)/g, '$1.$2');
                        cssMinified = cssMinified.replace(/#([0-9a-f])\1([0-9a-f])\2([0-9a-f])\3/i, '#$1$2$3');
                    }
                    minified = cssMinified;
                    break;
                case'html':
                    minified = minifyHTML(code, {
                        collapseWhitespace: collapseWhitespace,
                        removeComments: removeComments,
                        removeAttributeQuotes: removeAttrQuotes
                    });
                    break;
                case'json':
                    try {
                        const jsonObj = JSON.parse(code);
                        minified = JSON.stringify(jsonObj, null, removeWhitespace ? 0 : 2);
                    } catch (e) {
                        throw new Error('Invalid JSON: ' + e.message);
                    }
                    break;
                case'python':
                    const pyLines = code.split('\n');
                    const pyResult = [];
                    for (let i = 0; i < pyLines.length; i++) {
                        let line = pyLines[i];
                        if (removeComments) {
                            const commentIndex = line.indexOf('#');
                            if (commentIndex !== -1) {
                                line = line.substring(0, commentIndex).trimEnd();
                            }
                        }
                        if (line.trim() !== '' || !removeWhitespace) {
                            pyResult.push(line);
                        }
                    }
                    minified = pyResult.join('\n');
                    break;
                case'php':
                    const phpLines = code.split('\n');
                    const phpResult = [];
                    let inMultilinePhpComment = false;
                    for (let i = 0; i < phpLines.length; i++) {
                        let line = phpLines[i];
                        if (removeComments && !inMultilinePhpComment) {
                            line = line.replace(/\/\/.*$|#.*$/g, '');
                            if (line.includes('/*')) {
                                const commentStart = line.indexOf('/*');
                                if (line.includes('*/', commentStart + 2)) {
                                    line = line.substring(0, commentStart) + line.substring(line.indexOf('*/', commentStart + 2) + 2);
                                } else {
                                    inMultilinePhpComment = true;
                                    line = line.substring(0, commentStart);
                                }
                            }
                        } else if (inMultilinePhpComment) {
                            const commentEnd = line.indexOf('*/');
                            if (commentEnd !== -1) {
                                line = line.substring(commentEnd + 2);
                                inMultilinePhpComment = false;
                            } else {
                                continue;
                            }
                        }
                        if (line.trim() !== '' || !removeWhitespace) {
                            phpResult.push(line);
                        }
                    }
                    minified = phpResult.join(removeWhitespace ? '' : '\n');
                    break;
                case'sql':
                    const sqlLines = code.split('\n');
                    const sqlResult = [];
                    let inMultilineSqlComment = false;
                    for (let i = 0; i < sqlLines.length; i++) {
                        let line = sqlLines[i];
                        if (removeComments && !inMultilineSqlComment) {
                            line = line.replace(/--.*$/g, '');
                            if (line.includes('/*')) {
                                const commentStart = line.indexOf('/*');
                                if (line.includes('*/', commentStart + 2)) {
                                    line = line.substring(0, commentStart) + line.substring(line.indexOf('*/', commentStart + 2) + 2);
                                } else {
                                    inMultilineSqlComment = true;
                                    line = line.substring(0, commentStart);
                                }
                            }
                        } else if (inMultilineSqlComment) {
                            const commentEnd = line.indexOf('*/');
                            if (commentEnd !== -1) {
                                line = line.substring(commentEnd + 2);
                                inMultilineSqlComment = false;
                            } else {
                                continue;
                            }
                        }
                        if (line.trim() !== '' || !removeWhitespace) {
                            sqlResult.push(line.trim());
                        }
                    }
                    minified = sqlResult.join(removeWhitespace ? ' ' : '\n');
                    break;
                case'mixed':
                    if (code.trim().startsWith('<')) {
                        minified = minifyHTML(code, {
                            collapseWhitespace: collapseWhitespace,
                            removeComments: removeComments,
                            removeAttributeQuotes: removeAttrQuotes
                        });
                    } else {
                        try {
                            const terserOptions = {
                                compress: compressVariables ? {
                                    dead_code: true,
                                    drop_console: false,
                                    drop_debugger: true,
                                    keep_fargs: true
                                } : false,
                                mangle: mangle ? {keep_fnames: keepFnames} : false,
                                output: {comments: removeComments ? false : 'some', beautify: !removeWhitespace}
                            };
                            const jsResult = await Terser.minify(code, terserOptions);
                            minified = jsResult.code;
                        } catch (e) {
                            try {
                                let cssMinified = code;
                                if (removeComments) {
                                    cssMinified = cssMinified.replace(/\/\*[\s\S]*?\*\//g, '');
                                }
                                if (removeWhitespace) {
                                    cssMinified = cssMinified.replace(/\s+/g, ' ');
                                    cssMinified = cssMinified.replace(/\s*({|}|\(|\)|\[|\]|:|;|,|>)\s*/g, '$1');
                                    cssMinified = cssMinified.replace(/;\s*}/g, '}');
                                }
                                minified = cssMinified;
                            } catch (e2) {
                                const lines = code.split('\n');
                                const result = [];
                                for (let i = 0; i < lines.length; i++) {
                                    let line = lines[i];
                                    if (removeComments) {
                                        line = line.replace(/\/\/.*$|#.*$|--.*$/g, '');
                                    }
                                    if (line.trim() !== '' || !removeWhitespace) {
                                        result.push(line);
                                    }
                                }
                                minified = result.join(removeWhitespace ? '' : '\n');
                            }
                        }
                    }
                    break;
            }
            outputEditor.setValue(minified);
            outputEditor.setOption('mode', inputEditor.getOption('mode'));
            const originalSize = new Blob([code]).size;
            const minifiedSize = new Blob([minified]).size;
            const savings = originalSize - minifiedSize;
            const percentage = originalSize > 0 ? Math.round((savings / originalSize) * 100) : 0;
            document.getElementById('stats').textContent = ` ${formatBytes(originalSize)} → ${formatBytes(minifiedSize)} (${percentage}% reduction)`;
            showNotification(`Code successfully minified! Reduced by ${percentage}%`);
        } catch (err) {
            console.error(err);
            outputEditor.setValue(`Error: ${err.message || 'Failed to minify code'}`);
            document.getElementById('stats').textContent = '';
            showNotification('Error during minification: ' + err.message, true);
        }
    }

    function beautifyCode() {
        const code = inputEditor.getValue();
        if (!code.trim()) {
            showNotification('Please enter some code to beautify', true);
            return;
        }
        const language = languageSelector.value === 'auto' ? detectLanguage(code) : languageSelector.value;
        try {
            let beautified = '';
            const options = {
                indent_size: 2,
                indent_char: ' ',
                max_preserve_newlines: 2,
                preserve_newlines: true,
                keep_array_indentation: false,
                break_chained_methods: false,
                indent_scripts: 'normal',
                space_before_conditional: true,
                unescape_strings: false,
                jslint_happy: false,
                end_with_newline: false,
                wrap_line_length: 0,
                indent_inner_html: true,
                comma_first: false,
                e4x: true
            };
            switch (language) {
                case'javascript':
                case'jsx':
                    beautified = js_beautify(code, options);
                    break;
                case'css':
                    beautified = css_beautify(code, options);
                    break;
                case'html':
                    beautified = html_beautify(code, options);
                    break;
                case'json':
                    try {
                        const jsonObj = JSON.parse(code);
                        beautified = JSON.stringify(jsonObj, null, 2);
                    } catch (e) {
                        throw new Error('Invalid JSON: ' + e.message);
                    }
                    break;
                case'python':
                    const pyLines = code.split('\n');
                    const pyResult = [];
                    let indentLevel = 0;
                    for (let i = 0; i < pyLines.length; i++) {
                        let line = pyLines[i].trim();
                        if (line.endsWith(':')) {
                            pyResult.push(' '.repeat(indentLevel * 4) + line);
                            indentLevel++;
                        } else if (line.startsWith('return') || line.startsWith('break') || line.startsWith('continue') || line.startsWith('pass')) {
                            pyResult.push(' '.repeat(indentLevel * 4) + line);
                            if (indentLevel > 0) indentLevel--;
                        } else if (line.startsWith('elif') || line.startsWith('else:') || line.startsWith('except') || line.startsWith('finally:')) {
                            if (indentLevel > 0) indentLevel--;
                            pyResult.push(' '.repeat(indentLevel * 4) + line);
                            indentLevel++;
                        } else if (line) {
                            pyResult.push(' '.repeat(indentLevel * 4) + line);
                        } else {
                            pyResult.push('');
                        }
                    }
                    beautified = pyResult.join('\n');
                    break;
                case'php':
                    let phpContent = code;
                    let phpPrefix = '';
                    let phpSuffix = '';
                    if (code.includes('<?php')) {
                        const openTag = code.indexOf('<?php');
                        if (openTag > -1) {
                            phpPrefix = code.substring(0, openTag + 5) + '\n';
                            phpContent = code.substring(openTag + 5);
                        }
                        const closeTag = phpContent.lastIndexOf('?>');
                        if (closeTag > -1) {
                            phpSuffix = '\n' + phpContent.substring(closeTag);
                            phpContent = phpContent.substring(0, closeTag);
                        }
                    }
                    beautified = phpPrefix + js_beautify(phpContent, options) + phpSuffix;
                    break;
                case'sql':
                    const sqlLines = code.split(/[;(\n)]/);
                    const sqlResult = [];
                    for (let i = 0; i < sqlLines.length; i++) {
                        let line = sqlLines[i].trim();
                        if (!line) continue;
                        line = line.replace(/\b(SELECT|FROM|WHERE|JOIN|LEFT|RIGHT|INNER|OUTER|FULL|ON|GROUP BY|ORDER BY|HAVING|INSERT INTO|VALUES|UPDATE|SET|DELETE|CREATE|ALTER|DROP|TABLE|INDEX|VIEW|PROCEDURE|FUNCTION|TRIGGER|DATABASE|SCHEMA|CONSTRAINT|PRIMARY KEY|FOREIGN KEY|UNIQUE|CHECK|DEFAULT|CASCADE|REFERENCES|AS|CASE|WHEN|THEN|ELSE|END|AND|OR|NOT|LIKE|IN|BETWEEN|IS NULL|IS NOT NULL|ASC|DESC|LIMIT|OFFSET|UNION|ALL|DISTINCT|COUNT|SUM|AVG|MIN|MAX)\b/gi, keyword => keyword.toUpperCase());
                        if (!line.endsWith(';') && !line.endsWith('(')) {
                            line += ';';
                        }
                        sqlResult.push(line);
                    }
                    beautified = sqlResult.join('\n\n');
                    break;
                case'mixed':
                    if (code.trim().startsWith('<')) {
                        beautified = html_beautify(code, options);
                    } else {
                        try {
                            beautified = js_beautify(code, options);
                        } catch (e) {
                            try {
                                beautified = css_beautify(code, options);
                            } catch (e2) {
                                try {
                                    const jsonObj = JSON.parse(code);
                                    beautified = JSON.stringify(jsonObj, null, 2);
                                } catch (e3) {
                                    beautified = code;
                                }
                            }
                        }
                    }
                    break;
                default:
                    beautified = js_beautify(code, options);
            }
            outputEditor.setValue(beautified);
            outputEditor.setOption('mode', inputEditor.getOption('mode'));
            const originalSize = new Blob([code]).size;
            const beautifiedSize = new Blob([beautified]).size;
            const diff = beautifiedSize - originalSize;
            const percentage = originalSize > 0 ? Math.round((diff / originalSize) * 100) : 0;
            document.getElementById('stats').textContent = ` ${formatBytes(originalSize)} → ${formatBytes(beautifiedSize)} (${percentage > 0 ? '+' : ''}${percentage}% change)`;
            showNotification('Code successfully beautified!');
        } catch (err) {
            console.error(err);
            outputEditor.setValue(`Error: ${err.message || 'Failed to beautify code'}`);
            document.getElementById('stats').textContent = '';
            showNotification('Error during beautification: ' + err.message, true);
        }
    }

    function formatBytes(bytes, decimals = 2) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const dm = decimals < 0 ? 0 : decimals;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
    }

    document.getElementById('minify-btn').addEventListener('click', minifyCode);
    document.getElementById('beautify-btn').addEventListener('click', beautifyCode);
    document.getElementById('clear-btn').addEventListener('click', () => {
        inputEditor.setValue('');
        outputEditor.setValue('');
        document.getElementById('stats').textContent = '';
    });
    document.getElementById('paste-btn').addEventListener('click', async () => {
        try {
            const text = await navigator.clipboard.readText();
            inputEditor.setValue(text);
            updateLanguageMode();
            showNotification('Content pasted from clipboard');
        } catch (err) {
            showNotification('Failed to paste from clipboard: ' + err.message, true);
        }
    });
    document.getElementById('copy-btn').addEventListener('click', () => {
        const code = outputEditor.getValue();
        if (!code.trim()) {
            showNotification('Nothing to copy', true);
            return;
        }
        navigator.clipboard.writeText(code).then(() => {
            showNotification('Copied to clipboard!');
        }).catch(err => {
            showNotification('Failed to copy: ' + err.message, true);
        });
    });
    document.getElementById('download-btn').addEventListener('click', () => {
        const code = outputEditor.getValue();
        if (!code.trim()) {
            showNotification('Nothing to download', true);
            return;
        }
        const language = languageSelector.value === 'auto' ? detectLanguage(code) : languageSelector.value;
        let extension = '.txt';
        switch (language) {
            case'javascript':
                extension = '.js';
                break;
            case'jsx':
                extension = '.jsx';
                break;
            case'css':
                extension = '.css';
                break;
            case'html':
                extension = '.html';
                break;
            case'json':
                extension = '.json';
                break;
            case'python':
                extension = '.py';
                break;
            case'php':
                extension = '.php';
                break;
            case'sql':
                extension = '.sql';
                break;
        }
        const blob = new Blob([code], {type: 'text/plain'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `minified${extension}`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        showNotification(`File downloaded as minified${extension}`);
    });
    const uploadBtn = document.getElementById('upload-btn');
    const fileInput = document.getElementById('file-input');
    const inputPanel = document.querySelector('.input-panel .code-container');
    uploadBtn.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', event => {
        const file = event.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = e => {
            const content = e.target.result;
            inputEditor.setValue(content);
            const fileName = file.name.toLowerCase();
            if (fileName.endsWith('.js')) {
                languageSelector.value = 'javascript';
            } else if (fileName.endsWith('.jsx')) {
                languageSelector.value = 'jsx';
            } else if (fileName.endsWith('.css')) {
                languageSelector.value = 'css';
            } else if (fileName.endsWith('.html') || fileName.endsWith('.htm')) {
                languageSelector.value = 'html';
            } else if (fileName.endsWith('.json')) {
                languageSelector.value = 'json';
            } else if (fileName.endsWith('.py')) {
                languageSelector.value = 'python';
            } else if (fileName.endsWith('.php')) {
                languageSelector.value = 'php';
            } else if (fileName.endsWith('.sql')) {
                languageSelector.value = 'sql';
            } else {
                languageSelector.value = 'auto';
            }
            updateLanguageMode();
            outputEditor.setValue('');
            document.getElementById('stats').textContent = '';
            showNotification(`Loaded file: ${file.name}`);
        };
        reader.readAsText(file);
    });
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        inputPanel.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    ['dragenter', 'dragover'].forEach(eventName => {
        inputPanel.addEventListener(eventName, () => {
            inputPanel.classList.add('drag-over');
        }, false);
    });
    ['dragleave', 'drop'].forEach(eventName => {
        inputPanel.addEventListener(eventName, () => {
            inputPanel.classList.remove('drag-over');
        }, false);
    });
    inputPanel.addEventListener('drop', e => {
        const file = e.dataTransfer.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = evt => {
            const content = evt.target.result;
            inputEditor.setValue(content);
            const fileName = file.name.toLowerCase();
            if (fileName.endsWith('.js')) {
                languageSelector.value = 'javascript';
            } else if (fileName.endsWith('.jsx')) {
                languageSelector.value = 'jsx';
            } else if (fileName.endsWith('.css')) {
                languageSelector.value = 'css';
            } else if (fileName.endsWith('.html') || fileName.endsWith('.htm')) {
                languageSelector.value = 'html';
            } else if (fileName.endsWith('.json')) {
                languageSelector.value = 'json';
            } else if (fileName.endsWith('.py')) {
                languageSelector.value = 'python';
            } else if (fileName.endsWith('.php')) {
                languageSelector.value = 'php';
            } else if (fileName.endsWith('.sql')) {
                languageSelector.value = 'sql';
            } else {
                languageSelector.value = 'auto';
            }
            updateLanguageMode();
            outputEditor.setValue('');
            document.getElementById('stats').textContent = '';
            showNotification(`Loaded file: ${file.name}`);
        };
        reader.readAsText(file);
    }, false);
    if (!inputEditor.getValue().trim()) {
        const sampleCode = `function calculateDiscount(price, discountPercent) {
  // Check for valid inputs
  if (typeof price !== 'number' || typeof discountPercent !== 'number') {
    throw new Error('Price and discount must be numbers');
  }

  /* Calculate the discount amount using the percentage
     Simple formula: discount = price * (discountPercent / 100) */
  const discountAmount = (price * discountPercent) / 100;

  // Calculate the final price by subtracting the discount
  const finalPrice = price - discountAmount;

  // Return an object with all the details
  return {
    originalPrice: price,
    discountPercent: discountPercent,
    discountAmount: discountAmount,
    finalPrice: finalPrice
  };
}

// Example usage
const result = calculateDiscount(100, 20);
console.log('You saved ' + result.discountAmount + ' dollars!');
console.log('Your final price is: $' + result.finalPrice);`;
        inputEditor.setValue(sampleCode);
        updateLanguageMode();
    }
});</script>
</body>
</html>