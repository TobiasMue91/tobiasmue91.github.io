<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üîç</text></svg>">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Professional Regular Expression Tester with real-time highlighting, capture groups, and detailed explanations">
  <title>RegEx Lab | Modern Regular Expression Tester</title>
  <style>
    :root {
      --color-bg-primary: #f9fafb;
      --color-bg-secondary: #ffffff;
      --color-text-primary: #111827;
      --color-text-secondary: #4b5563;
      --color-border: #e5e7eb;
      --color-accent: #3b82f6;
      --color-accent-hover: #2563eb;
      --color-accent-light: #dbeafe;
      --color-success: #10b981;
      --color-warning: #f59e0b;
      --color-error: #ef4444;
      --color-match: #dbeafe;
      --color-match-highlight: #bfdbfe;
      --color-group1: #dcfce7;
      --color-group2: #fef9c3;
      --color-group3: #fce7f3;
      --color-group4: #dbeafe;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --font-mono: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      --transition: all 0.2s ease;
    }
    [data-theme="dark"] {
      --color-bg-primary: #1f2937;
      --color-bg-secondary: #111827;
      --color-text-primary: #f9fafb;
      --color-text-secondary: #d1d5db;
      --color-border: #374151;
      --color-accent: #3b82f6;
      --color-accent-hover: #60a5fa;
      --color-accent-light: #1e40af;
      --color-success: #059669;
      --color-warning: #d97706;
      --color-error: #dc2626;
      --color-match: #1e3a8a;
      --color-match-highlight: #1e40af;
      --color-group1: #065f46;
      --color-group2: #78350f;
      --color-group3: #831843;
      --color-group4: #1e3a8a;
    }
    * {box-sizing: border-box; margin: 0; padding: 0;}
    body {font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--color-bg-primary); color: var(--color-text-primary); line-height: 1.5; transition: var(--transition); -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}
    .sr-only {position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border-width: 0;}

    /* Fixed grid layout structure */
    .app {
      display: grid;
      grid-template-areas:
        "header header"
        "sidebar main"
        "footer footer";
      grid-template-columns: 300px 1fr;
      grid-template-rows: auto 1fr auto;
      min-height: 100vh;
    }

    header {grid-area: header; background-color: var(--color-accent); color: white; padding: 1rem; display: flex; justify-content: space-between; align-items: center; box-shadow: var(--shadow); z-index: 10;}
    .sidebar {grid-area: sidebar; background-color: var(--color-bg-secondary); border-right: 1px solid var(--color-border); padding: 1rem; overflow-y: auto; height: 100%; transition: transform 0.3s ease;}
    .main {grid-area: main; padding: 1.5rem; overflow-y: auto;}
    footer {grid-area: footer; background-color: var(--color-bg-secondary); border-top: 1px solid var(--color-border); padding: 1rem; text-align: center; font-size: 0.875rem; color: var(--color-text-secondary);}

    @media (max-width: 768px) {
      .app {
        grid-template-areas:
          "header"
          "main"
          "footer";
        grid-template-columns: 1fr;
      }
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 50;
        transform: translateX(-100%);
      }
      .sidebar.active {
        transform: translateX(0);
      }
    }

    .logo {font-size: 1.25rem; font-weight: bold; display: flex; align-items: center; gap: 0.5rem;}
    .theme-toggle {display: flex; align-items: center; gap: 0.5rem;}
    .toggle-switch {position: relative; display: inline-block; width: 48px; height: 24px;}
    .toggle-switch input {opacity: 0; width: 0; height: 0;}
    .toggle-slider {position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(255,255,255,0.3); transition: 0.4s; border-radius: 24px;}
    .toggle-slider:before {position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: 0.4s; border-radius: 50%;}
    input:checked + .toggle-slider:before {transform: translateX(24px); background-color: var(--color-accent);}
    input:checked + .toggle-slider {background-color: #f8fafc;}

    .sidebar-section {margin-bottom: 1.5rem;}
    .sidebar-title {font-size: 0.875rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--color-text-secondary); text-transform: uppercase; letter-spacing: 0.05em;}

    .card {background-color: var(--color-bg-secondary); border-radius: 0.5rem; box-shadow: var(--shadow); padding: 1.5rem; margin-bottom: 1.5rem;}
    .card-header {display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;}
    .card-title {font-size: 1.125rem; font-weight: 600;}

    .form-group {margin-bottom: 1rem;}
    .form-label {display: block; margin-bottom: 0.5rem; font-weight: 500; font-size: 0.875rem; color: var(--color-text-secondary);}
    .form-input {width: 100%; padding: 0.625rem; border: 1px solid var(--color-border); border-radius: 0.375rem; font-size: 0.875rem; background-color: var(--color-bg-secondary); color: var(--color-text-primary); transition: var(--transition);}
    .form-input:focus {outline: none; border-color: var(--color-accent); box-shadow: 0 0 0 3px var(--color-accent-light);}
    .form-input-code {font-family: var(--font-mono);}
    textarea.form-input {min-height: 120px; resize: vertical;}
    .input-group {position: relative;}
    .input-icon {position: absolute; right: 0.75rem; top: 50%; transform: translateY(-50%); color: var(--color-text-secondary); cursor: pointer;}
    .input-icon:hover {color: var(--color-accent);}

    .flags-container {display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;}
    .flag-button {padding: 0.25rem 0.5rem; background-color: var(--color-bg-primary); border: 1px solid var(--color-border); border-radius: 0.25rem; font-size: 0.75rem; font-weight: 500; cursor: pointer; transition: var(--transition); color: var(--color-text-primary);}
    .flag-button.active {background-color: var(--color-accent); color: white; border-color: var(--color-accent);}
    .flag-button:hover:not(.active) {border-color: var(--color-accent); color: var(--color-accent);}

    /* Fix dark mode button contrast */
    [data-theme="dark"] .flag-button:not(.active) {
      color: var(--color-text-primary);
    }
    [data-theme="dark"] .flag-button.active {
      background-color: var(--color-accent);
      color: white;
    }

    .button {display: inline-flex; align-items: center; justify-content: center; padding: 0.625rem 1.25rem; background-color: var(--color-accent); color: white; border: none; border-radius: 0.375rem; font-weight: 500; cursor: pointer; transition: var(--transition);}
    .button:hover {background-color: var(--color-accent-hover);}
    .button-secondary {background-color: transparent; color: var(--color-accent); border: 1px solid var(--color-accent);}
    .button-secondary:hover {background-color: var(--color-accent-light); color: white;}

    .examples-filter {margin-bottom: 0.75rem;}
    .category-header {padding: 0.625rem; background-color: var(--color-bg-primary); font-weight: 500; cursor: pointer; border-radius: 0.25rem; margin-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: center; transition: var(--transition);}
    .category-header:hover {background-color: var(--color-accent-light); color: white;}
    .category-examples {max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out;}
    .category-examples.expanded {max-height: 500px;}
    .example-item {padding: 0.5rem 0.625rem; border-radius: 0.25rem; cursor: pointer; margin-bottom: 0.25rem; font-size: 0.875rem; transition: var(--transition);}
    .example-item:hover {background-color: var(--color-bg-primary);}
    .example-pattern {font-family: var(--font-mono); font-size: 0.75rem; color: var(--color-accent); margin-top: 0.25rem;}

    .results {margin-top: 1rem;}
    .result-summary {display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;}
    .result-stats {font-size: 0.875rem; color: var(--color-text-secondary);}
    .result-actions {display: flex; gap: 0.5rem;}

    .text-highlight {position: relative; padding: 1rem; background-color: var(--color-bg-secondary); border: 1px solid var(--color-border); border-radius: 0.375rem; font-size: 0.875rem; line-height: 1.6; white-space: pre-wrap; overflow-wrap: break-word;}
    .highlight-match {background-color: var(--color-match); border-radius: 0.25rem; padding: 0.125rem 0;}
    .highlight-group-1 {background-color: var(--color-group1);}
    .highlight-group-2 {background-color: var(--color-group2);}
    .highlight-group-3 {background-color: var(--color-group3);}
    .highlight-group-4 {background-color: var(--color-group4);}

    .matches-list {margin-top: 1rem; display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 0.75rem;}
    .match-item {padding: 0.75rem; background-color: var(--color-bg-secondary); border: 1px solid var(--color-border); border-radius: 0.375rem; font-size: 0.875rem; transition: var(--transition);}
    .match-item:hover {border-color: var(--color-accent); box-shadow: var(--shadow-sm);}
    .match-index {font-size: 0.75rem; color: var(--color-text-secondary); margin-bottom: 0.25rem;}
    .match-value {font-family: var(--font-mono); word-break: break-all;}
    .match-groups {margin-top: 0.5rem; font-size: 0.75rem;}
    .group-item {display: flex; margin-top: 0.25rem;}
    .group-number {min-width: 1.5rem; text-align: center; background-color: var(--color-bg-primary); border-radius: 0.25rem; margin-right: 0.5rem;}
    .group-value {font-family: var(--font-mono); word-break: break-all;}

    .explanation {font-size: 0.875rem; line-height: 1.6;}
    .explanation-table {width: 100%; border-collapse: collapse; margin-top: 0.5rem; font-size: 0.75rem;}
    .explanation-table th, .explanation-table td {padding: 0.5rem; text-align: left; border-bottom: 1px solid var(--color-border);}
    .explanation-table th {font-weight: 600; background-color: var(--color-bg-primary);}

    .regex-cheatsheet {font-size: 0.75rem;}
    .cheatsheet-section {margin-bottom: 1rem;}
    .cheatsheet-title {font-weight: 600; margin-bottom: 0.5rem;}
    .cheatsheet-item {display: flex; margin-bottom: 0.25rem;}
    .cheatsheet-pattern {font-family: var(--font-mono); min-width: 50px; margin-right: 0.5rem;}

    .toast-container {position: fixed; bottom: 1rem; right: 1rem; display: flex; flex-direction: column; gap: 0.5rem; z-index: 100;}
    .toast {padding: 0.75rem 1rem; background-color: var(--color-bg-secondary); border-left: 4px solid var(--color-accent); border-radius: 0.375rem; box-shadow: var(--shadow-md); display: flex; align-items: center; gap: 0.75rem; animation: slideIn 0.3s ease;}
    .toast-error {border-left-color: var(--color-error);}
    .toast-success {border-left-color: var(--color-success);}
    .toast-warning {border-left-color: var(--color-warning);}
    .toast-message {font-size: 0.875rem;}

    .validation-error {color: var(--color-error); font-size: 0.75rem; margin-top: 0.25rem;}
    @keyframes slideIn {from {transform: translateX(100%); opacity: 0;} to {transform: translateX(0); opacity: 1;}}
    @keyframes fadeOut {to {opacity: 0; transform: translateY(10px);}}

    .flex {display: flex;}
    .justify-between {justify-content: space-between;}
    .items-center {align-items: center;}
    .gap-2 {gap: 0.5rem;}
    .gap-4 {gap: 1rem;}
    .mt-4 {margin-top: 1rem;}
    .mb-2 {margin-bottom: 0.5rem;}
    .mb-4 {margin-bottom: 1rem;}
    .hidden {display: none;}

    /* Mobile sidebar toggle button */
    .sidebar-toggle {
      display: none;
      position: fixed;
      bottom: 1rem;
      left: 1rem;
      z-index: 51;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background-color: var(--color-accent);
      color: white;
      border: none;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-md);
      cursor: pointer;
      transition: background-color 0.2s ease;
    }
    .sidebar-toggle:hover {
      background-color: var(--color-accent-hover);
    }
    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 49;
      backdrop-filter: blur(2px);
      transition: opacity 0.3s ease;
      opacity: 0;
    }
    .overlay.active {
      display: block;
      opacity: 1;
    }

    @media (max-width: 768px) {
      .sidebar-toggle {display: flex;}
    }

    /* Keyboard shortcut tooltip */
    [data-tooltip] {position: relative;}
    [data-tooltip]:before {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      margin-bottom: 5px;
      padding: 5px 10px;
      background-color: var(--color-bg-primary);
      color: var(--color-text-primary);
      border: 1px solid var(--color-border);
      border-radius: 4px;
      font-size: 12px;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
      box-shadow: var(--shadow-sm);
    }
    [data-tooltip]:hover:before {
      opacity: 1;
      visibility: visible;
    }

    /* Focus styles for accessibility */
    button:focus-visible,
    input:focus-visible,
    textarea:focus-visible {
      outline: 2px solid var(--color-accent);
      outline-offset: 2px;
    }

    /* Loading indicator */
    .loading {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s linear infinite;
      margin-right: 8px;
    }
    @keyframes spin {
      to {transform: rotate(360deg);}
    }

    /* Close button for sidebar on mobile */
    .sidebar-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background-color: var(--color-bg-primary);
      color: var(--color-text-primary);
      border: 1px solid var(--color-border);
      display: none;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    @media (max-width: 768px) {
      .sidebar-close {display: flex;}
    }
  </style>
</head>
<body>
<div class="app">
  <header>
    <div class="logo">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
        <path d="M2 17l10 5 10-5"></path>
        <path d="M2 12l10 5 10-5"></path>
      </svg>
      RegEx Lab
    </div>
    <div class="theme-toggle">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="5"></circle>
        <line x1="12" y1="1" x2="12" y2="3"></line>
        <line x1="12" y1="21" x2="12" y2="23"></line>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
        <line x1="1" y1="12" x2="3" y2="12"></line>
        <line x1="21" y1="12" x2="23" y2="12"></line>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
      </svg>
      <label class="toggle-switch">
        <input type="checkbox" id="theme-toggle">
        <span class="toggle-slider"></span>
      </label>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
      </svg>
    </div>
  </header>

  <aside class="sidebar" id="sidebar">
    <button class="sidebar-close" id="sidebar-close" aria-label="Close sidebar">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
    <div class="sidebar-section">
      <div class="sidebar-title">Examples</div>
      <input type="text" id="example-filter" class="form-input examples-filter" placeholder="Filter examples...">
      <div class="categories-container">
        <div class="category">
          <div class="category-header" data-category="basic">
            <span>Basic Patterns</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </div>
          <div class="category-examples" id="basic-examples">
            <div class="example-item" data-pattern="^[A-Z][a-z]+$">
              <span>Capitalize first letter</span>
              <div class="example-pattern">^[A-Z][a-z]+$</div>
            </div>
            <div class="example-item" data-pattern="\d+">
              <span>Match numbers</span>
              <div class="example-pattern">\d+</div>
            </div>
            <div class="example-item" data-pattern="[a-z]+">
              <span>Match lowercase letters</span>
              <div class="example-pattern">[a-z]+</div>
            </div>
            <div class="example-item" data-pattern="[A-Za-z]+">
              <span>Match any word</span>
              <div class="example-pattern">[A-Za-z]+</div>
            </div>
          </div>
        </div>

        <div class="category">
          <div class="category-header" data-category="contacts">
            <span>Contact Information</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </div>
          <div class="category-examples" id="contacts-examples">
            <div class="example-item" data-pattern="\w+@\w+\.\w+">
              <span>Simple email address</span>
              <div class="example-pattern">\w+@\w+\.\w+</div>
            </div>
            <div class="example-item" data-pattern="\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b">
              <span>Complete email address</span>
              <div class="example-pattern">\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b</div>
            </div>
            <div class="example-item" data-pattern="^\d{3}-\d{3}-\d{4}$">
              <span>US phone (xxx-xxx-xxxx)</span>
              <div class="example-pattern">^\d{3}-\d{3}-\d{4}$</div>
            </div>
            <div class="example-item" data-pattern="^\d{10}$">
              <span>US phone (10 digits)</span>
              <div class="example-pattern">^\d{10}$</div>
            </div>
            <div class="example-item" data-pattern="^\d{11}$">
              <span>UK phone number</span>
              <div class="example-pattern">^\d{11}$</div>
            </div>
          </div>
        </div>

        <div class="category">
          <div class="category-header" data-category="web">
            <span>Web & URLs</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </div>
          <div class="category-examples" id="web-examples">
            <div class="example-item" data-pattern="https?:\/\/\S+">
              <span>Simple URLs</span>
              <div class="example-pattern">https?:\/\/\S+</div>
            </div>
            <div class="example-item" data-pattern="\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b">
              <span>IP addresses</span>
              <div class="example-pattern">\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b</div>
            </div>
            <div class="example-item" data-pattern="^(https?:\/\/)?(www\.)?([a-zA-Z0-9]+(-[a-zA-Z0-9]+)*\.)+[a-zA-Z]{2,}(\/\S*)?$">
              <span>Complete URL validation</span>
              <div class="example-pattern">^(https?:\/\/)?(www\.)?([a-zA-Z0-9]+(-[a-zA-Z0-9]+)*\.)+[a-zA-Z]{2,}(\/\S*)?$</div>
            </div>
          </div>
        </div>

        <div class="category">
          <div class="category-header" data-category="formats">
            <span>Common Formats</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </div>
          <div class="category-examples" id="formats-examples">
            <div class="example-item" data-pattern="\b\d{5}(-\d{4})?\b">
              <span>US zip code</span>
              <div class="example-pattern">\b\d{5}(-\d{4})?\b</div>
            </div>
            <div class="example-item" data-pattern="\b\d{4}\b">
              <span>Australian postcode</span>
              <div class="example-pattern">\b\d{4}\b</div>
            </div>
            <div class="example-item" data-pattern="\b[A-Z]{2}\d{4}[A-Za-z]{2}\b">
              <span>UK vehicle registration</span>
              <div class="example-pattern">\b[A-Z]{2}\d{4}[A-Za-z]{2}\b</div>
            </div>
            <div class="example-item" data-pattern="\d{3}-\d{2}-\d{4}">
              <span>US Social Security Number</span>
              <div class="example-pattern">\d{3}-\d{2}-\d{4}</div>
            </div>
            <div class="example-item" data-pattern="\b\d{1,2}:\d{2}\b">
              <span>Time (HH:MM)</span>
              <div class="example-pattern">\b\d{1,2}:\d{2}\b</div>
            </div>
            <div class="example-item" data-pattern="^\d{4}-\d{2}-\d{2}$">
              <span>Date (YYYY-MM-DD)</span>
              <div class="example-pattern">^\d{4}-\d{2}-\d{2}$</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="sidebar-section">
      <div class="sidebar-title">RegEx Cheatsheet</div>
      <div class="regex-cheatsheet">
        <div class="cheatsheet-section">
          <div class="cheatsheet-title">Character Classes</div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">.</div>
            <div>Any character except newline</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">\w</div>
            <div>Word character [A-Za-z0-9_]</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">\d</div>
            <div>Digit [0-9]</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">\s</div>
            <div>Whitespace character</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">\W \D \S</div>
            <div>Negated versions of above</div>
          </div>
        </div>

        <div class="cheatsheet-section">
          <div class="cheatsheet-title">Anchors</div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">^</div>
            <div>Start of string/line</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">$</div>
            <div>End of string/line</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">\b</div>
            <div>Word boundary</div>
          </div>
        </div>

        <div class="cheatsheet-section">
          <div class="cheatsheet-title">Quantifiers</div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">*</div>
            <div>0 or more</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">+</div>
            <div>1 or more</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">?</div>
            <div>0 or 1</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">{n}</div>
            <div>Exactly n times</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">{n,}</div>
            <div>n or more times</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">{n,m}</div>
            <div>Between n and m times</div>
          </div>
        </div>

        <div class="cheatsheet-section">
          <div class="cheatsheet-title">Groups & Alternation</div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">(abc)</div>
            <div>Capture group</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">(?:abc)</div>
            <div>Non-capturing group</div>
          </div>
          <div class="cheatsheet-item">
            <div class="cheatsheet-pattern">a|b</div>
            <div>a or b</div>
          </div>
        </div>
      </div>
    </div>
  </aside>

  <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </button>
  <div class="overlay" id="overlay"></div>

  <main class="main">
    <div class="card">
      <div class="card-header">
        <h2 class="card-title">Regular Expression</h2>
      </div>
      <div class="form-group">
        <div class="input-group">
          <input type="text" id="regex" class="form-input form-input-code" placeholder="Enter a regular expression pattern..." aria-label="Regular expression pattern">
          <span class="input-icon" id="clear-regex" role="button" tabindex="0" aria-label="Clear regex input">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            </span>
        </div>
        <div id="regex-validation" class="validation-error hidden"></div>
      </div>

      <div class="flags-container" role="group" aria-label="Regular expression flags">
        <button class="flag-button active" data-flag="g" data-tooltip="Ctrl+G">g (global)</button>
        <button class="flag-button" data-flag="i" data-tooltip="Ctrl+I">i (ignore case)</button>
        <button class="flag-button" data-flag="m" data-tooltip="Ctrl+M">m (multiline)</button>
        <button class="flag-button" data-flag="s" data-tooltip="Ctrl+S">s (dotall)</button>
        <button class="flag-button" data-flag="u" data-tooltip="Ctrl+U">u (unicode)</button>
        <button class="flag-button" data-flag="y" data-tooltip="Ctrl+Y">y (sticky)</button>
      </div>

      <div class="form-group">
        <label class="form-label" for="test-text">Test Text</label>
        <textarea id="test-text" class="form-input" placeholder="Enter text to test against the regular expression..." aria-label="Test text">RegEx Lab User Guide - April 13, 2025

Contact Information:
John Smith (Customer ID: ABC123) from Sydney, Australia can be reached at john.smith@example.com or via his alternate email address john.doe+work@corporate-domain.co.uk. His US office phone is 555-123-4567, while his direct line is 5551234567. UK colleagues can reach him at 07700900123.

Technical Details:
The company website is https://www.regex-lab.com with a backup server at http://backup.regex-lab.com/admin. The main server has IP address 192.168.1.1, with additional servers at 10.0.0.1 and 172.16.0.100.

Shipping Information:
US customers: Please allow 3-5 business days for delivery to zip codes like 90210 or extended codes such as 90210-1234.
Australian customers: Items shipped to postcodes 2000 (Sydney) or 3000 (Melbourne) arrive within 2 business days.
UK customers: For vehicle deliveries, please provide your registration number (format like AB1234CD) for verification.

Important Dates and Times:
The company was established on 2015-01-15. Our office hours are 09:00 to 17:30 Monday-Friday.
Our quarterly planning meetings happen at 14:00 on 2025-05-20, 2025-08-15, and 2025-11-10.
Prices range from $10.99 to $2,499.99 depending on configuration.

Security Notice:
Never share your Social Security Number (e.g., 123-45-6789) or password (like Password123) with anyone.
Customer support will never ask for your full credit card number (e.g., 4111111111111111).</textarea>
      </div>

      <div class="form-group">
        <label class="form-label" for="replacement-text">Replace With (optional)</label>
        <input type="text" id="replacement-text" class="form-input" placeholder="Enter replacement text..." aria-label="Replacement text">
      </div>

      <div class="flex justify-between">
        <button id="test-button" class="button" data-tooltip="Ctrl+Enter">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 0.5rem;">
            <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline>
            <polyline points="16 7 22 7 22 13"></polyline>
          </svg>
          Test
        </button>
        <button id="replace-button" class="button button-secondary" data-tooltip="Ctrl+Shift+Enter">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 0.5rem;">
            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
          </svg>
          Replace
        </button>
      </div>
    </div>

    <div class="card" id="results-card" style="display: none;">
      <div class="card-header">
        <h2 class="card-title">Results</h2>
        <div class="flex gap-2">
          <button id="copy-results" class="button button-secondary" style="padding: 0.375rem 0.75rem; font-size: 0.75rem;" data-tooltip="Ctrl+C">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 0.25rem;">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            Copy
          </button>
        </div>
      </div>

      <div class="result-summary">
        <div id="result-stats" class="result-stats"></div>
      </div>

      <div id="result-content" class="text-highlight"></div>

      <div id="matches-container" class="mt-4" style="display: none;">
        <h3 class="mb-2">Matches</h3>
        <div id="matches-list" class="matches-list"></div>
      </div>

      <div id="explanation-container" class="mt-4" style="display: none;">
        <h3 class="mb-2">Pattern Explanation</h3>
        <div id="explanation" class="explanation"></div>
      </div>
    </div>
  </main>

  <footer>
    <div>RegEx Lab &copy; 2025 ‚Ä¢ A modern regular expression testing tool ‚Ä¢ <a href="#" id="keyboard-shortcuts" style="color: inherit; text-decoration: underline;">Keyboard Shortcuts</a></div>
  </footer>
</div>

<div class="toast-container" id="toast-container"></div>

<script>
  // Core functionality
  const regexInput = document.getElementById('regex');
  const testText = document.getElementById('test-text');
  const replacementText = document.getElementById('replacement-text');
  const testButton = document.getElementById('test-button');
  const replaceButton = document.getElementById('replace-button');
  const clearRegexButton = document.getElementById('clear-regex');
  const regexValidation = document.getElementById('regex-validation');
  const resultsCard = document.getElementById('results-card');
  const resultStats = document.getElementById('result-stats');
  const resultContent = document.getElementById('result-content');
  const matchesContainer = document.getElementById('matches-container');
  const matchesList = document.getElementById('matches-list');
  const explanationContainer = document.getElementById('explanation-container');
  const explanation = document.getElementById('explanation');
  const copyResultsButton = document.getElementById('copy-results');
  const flagButtons = document.querySelectorAll('.flag-button');
  const exampleItems = document.querySelectorAll('.example-item');
  const exampleFilter = document.getElementById('example-filter');
  const categoryHeaders = document.querySelectorAll('.category-header');
  const themeToggle = document.getElementById('theme-toggle');
  const sidebarToggle = document.getElementById('sidebar-toggle');
  const sidebar = document.getElementById('sidebar');
  const sidebarClose = document.getElementById('sidebar-close');
  const overlay = document.getElementById('overlay');
  const keyboardShortcuts = document.getElementById('keyboard-shortcuts');

  // State management
  let currentFlags = ['g']; // Default global flag
  let activeTimeout = null;
  let executionTimeoutMs = 1000; // 1 second timeout for regex execution
  let isProcessing = false;

  // Initialize the UI
  initializeUI();

  // Event listeners
  regexInput.addEventListener('input', debounce(validateRegex, 300));
  testButton.addEventListener('click', testRegex);
  replaceButton.addEventListener('click', replaceMatches);
  clearRegexButton.addEventListener('click', clearRegex);
  copyResultsButton.addEventListener('click', copyResults);

  flagButtons.forEach(button => {
    button.addEventListener('click', toggleFlag);
  });

  exampleItems.forEach(item => {
    item.addEventListener('click', () => {
      regexInput.value = item.dataset.pattern;
      validateRegex();
      if (window.innerWidth <= 768) {
        closeSidebar();
      }
    });
  });

  exampleFilter.addEventListener('input', filterExamples);

  categoryHeaders.forEach(header => {
    header.addEventListener('click', toggleCategory);
  });

  themeToggle.addEventListener('change', toggleTheme);

  if (sidebarToggle) {
    sidebarToggle.addEventListener('click', toggleSidebar);
  }

  if (sidebarClose) {
    sidebarClose.addEventListener('click', closeSidebar);
  }

  if (overlay) {
    overlay.addEventListener('click', closeSidebar);
  }

  keyboardShortcuts.addEventListener('click', showKeyboardShortcuts);

  // Add keyboard shortcuts
  document.addEventListener('keydown', handleKeyboardShortcuts);

  // Function implementations
  function initializeUI() {
    // Set up responsive UI elements
    if (window.innerWidth <= 768) {
      sidebarToggle.style.display = 'flex';
    }

    // Check for saved theme preference
    const savedTheme = localStorage.getItem('regexlab-theme');
    if (savedTheme === 'dark') {
      document.documentElement.setAttribute('data-theme', 'dark');
      themeToggle.checked = true;
    }

    // Open the first category by default
    if (categoryHeaders.length > 0) {
      const firstCategory = categoryHeaders[0];
      const categoryId = firstCategory.dataset.category;
      document.getElementById(`${categoryId}-examples`).classList.add('expanded');
    }

    // Initialize validation
    validateRegex();
  }

  function validateRegex() {
    const pattern = regexInput.value.trim();

    if (!pattern) {
      regexValidation.classList.add('hidden');
      return false;
    }

    try {
      // Test the regex pattern
      new RegExp(pattern, currentFlags.join(''));
      regexValidation.classList.add('hidden');
      return true;
    } catch (error) {
      regexValidation.textContent = `Invalid pattern: ${error.message}`;
      regexValidation.classList.remove('hidden');
      return false;
    }
  }

  function testRegex() {
    if (isProcessing) return;

    if (!validateRegex()) {
      showToast('Please enter a valid regular expression', 'error');
      return;
    }

    const pattern = regexInput.value.trim();
    const text = testText.value;

    if (!pattern) {
      showToast('Please enter a regular expression pattern', 'warning');
      return;
    }

    isProcessing = true;
    setButtonLoading(testButton, true);

    try {
      const startTime = performance.now();
      const regex = new RegExp(pattern, currentFlags.join(''));
      const matches = [];
      let match;

      // Use a worker or timeout to prevent browser freeze on complex patterns
      const timeoutPromise = new Promise((_, reject) => {
        setTimeout(() => {
          reject(new Error('Regex execution timed out. Pattern may be too complex or cause catastrophic backtracking.'));
        }, executionTimeoutMs);
      });

      const regexPromise = new Promise((resolve) => {
        // Collect all matches
        if (currentFlags.includes('g')) {
          while ((match = regex.exec(text)) !== null) {
            matches.push({
              value: match[0],
              index: match.index,
              groups: match.slice(1),
              input: match.input
            });

            // Prevent infinite loops
            if (!match[0].length) {
              regex.lastIndex++;
            }
          }
        } else {
          match = regex.exec(text);
          if (match) {
            matches.push({
              value: match[0],
              index: match.index,
              groups: match.slice(1),
              input: match.input
            });
          }
        }

        resolve(matches);
      });

      // Race the regex execution against a timeout
      Promise.race([regexPromise, timeoutPromise])
              .then((matches) => {
                const endTime = performance.now();
                const executionTime = (endTime - startTime).toFixed(2);

                displayResults(matches, text, executionTime);
                displayExplanation(pattern);

                resultsCard.style.display = 'block';
              })
              .catch((error) => {
                showToast(`Error: ${error.message}`, 'error');
              })
              .finally(() => {
                isProcessing = false;
                setButtonLoading(testButton, false);
              });
    } catch (error) {
      showToast(`Error: ${error.message}`, 'error');
      isProcessing = false;
      setButtonLoading(testButton, false);
    }
  }

  function replaceMatches() {
    if (isProcessing) return;

    if (!validateRegex()) {
      showToast('Please enter a valid regular expression', 'error');
      return;
    }

    const pattern = regexInput.value.trim();
    const text = testText.value;
    const replacement = replacementText.value;

    if (!pattern) {
      showToast('Please enter a regular expression pattern', 'warning');
      return;
    }

    isProcessing = true;
    setButtonLoading(replaceButton, true);

    try {
      const startTime = performance.now();

      // Use a worker or timeout to prevent browser freeze on complex patterns
      const timeoutPromise = new Promise((_, reject) => {
        setTimeout(() => {
          reject(new Error('Regex execution timed out. Pattern may be too complex or cause catastrophic backtracking.'));
        }, executionTimeoutMs);
      });

      const regexPromise = new Promise((resolve) => {
        const regex = new RegExp(pattern, currentFlags.join(''));
        const result = text.replace(regex, replacement);
        resolve(result);
      });

      // Race the regex execution against a timeout
      Promise.race([regexPromise, timeoutPromise])
              .then((result) => {
                const endTime = performance.now();
                const executionTime = (endTime - startTime).toFixed(2);

                // Display the replaced text
                resultContent.textContent = result;
                resultStats.textContent = `Execution time: ${executionTime}ms`;

                // Hide matches and groups display since we're just showing the replaced text
                matchesContainer.style.display = 'none';
                explanationContainer.style.display = 'none';

                resultsCard.style.display = 'block';

                showToast('Replacement completed successfully', 'success');
              })
              .catch((error) => {
                showToast(`Error: ${error.message}`, 'error');
              })
              .finally(() => {
                isProcessing = false;
                setButtonLoading(replaceButton, false);
              });
    } catch (error) {
      showToast(`Error: ${error.message}`, 'error');
      isProcessing = false;
      setButtonLoading(replaceButton, false);
    }
  }

  function displayResults(matches, text, executionTime) {
    // Update stats
    resultStats.textContent = `Found ${matches.length} match${matches.length !== 1 ? 'es' : ''} in ${executionTime}ms`;

    // Create a "marked" array to track which characters are part of matches
    // Each position will contain null or an object with match info
    const marked = new Array(text.length).fill(null);

    // Mark all matches in our tracking array
    matches.forEach((match, matchIndex) => {
      for (let i = 0; i < match.value.length; i++) {
        const pos = match.index + i;
        if (pos < text.length) {
          marked[pos] = {
            matchIndex: matchIndex,
            isStart: i === 0,
            isEnd: i === match.value.length - 1
          };
        }
      }
    });

    // Build the HTML by going through the text character by character
    let html = '';
    let currentlyInMatch = false;

    for (let i = 0; i < text.length; i++) {
      const char = text[i];
      const mark = marked[i];

      // Handle opening a new match span
      if (mark && mark.isStart) {
        html += '<span class="highlight-match">';
        currentlyInMatch = true;
      }

      // Add the character (with HTML escaping)
      html += escapeHTML(char);

      // Handle closing a match span
      if (mark && mark.isEnd && currentlyInMatch) {
        html += '</span>';
        currentlyInMatch = false;
      }
    }

    // Ensure we close any open spans (safeguard)
    if (currentlyInMatch) {
      html += '</span>';
    }

    // Set the result
    resultContent.innerHTML = html;

    // Display matches detail
    if (matches.length > 0) {
      matchesList.innerHTML = '';

      // Sort matches by index for display
      matches.sort((a, b) => a.index - b.index);

      matches.forEach((match, index) => {
        const matchItem = document.createElement('div');
        matchItem.className = 'match-item';

        let matchHTML = `
        <div class="match-index">Match ${index + 1} (index: ${match.index})</div>
        <div class="match-value">${escapeHTML(match.value)}</div>
      `;

        if (match.groups.length > 0) {
          matchHTML += '<div class="match-groups">';
          match.groups.forEach((group, groupIndex) => {
            if (group !== undefined) {
              matchHTML += `
              <div class="group-item">
                <div class="group-number">${groupIndex + 1}</div>
                <div class="group-value">${escapeHTML(group)}</div>
              </div>
            `;
            }
          });
          matchHTML += '</div>';
        }

        matchItem.innerHTML = matchHTML;
        matchesList.appendChild(matchItem);
      });

      matchesContainer.style.display = 'block';
    } else {
      matchesContainer.style.display = 'none';
    }
  }

  function displayExplanation(pattern) {
    if (!pattern) {
      explanationContainer.style.display = 'none';
      return;
    }

    try {
      let explanationText = 'This pattern ';
      const parts = [];

      // Simple pattern elements
      if (pattern.includes('^')) parts.push('starts matching at the beginning of the string');
      if (pattern.includes('$')) parts.push('ends matching at the end of the string');
      if (pattern.includes('\\d') || pattern.includes('[0-9]')) parts.push('matches digits');
      if (pattern.includes('\\w')) parts.push('matches word characters');
      if (pattern.includes('\\s')) parts.push('matches whitespace');
      if (pattern.includes('.')) parts.push('matches any character (except newline without the "s" flag)');
      if (pattern.includes('+')) parts.push('contains one or more occurrences');
      if (pattern.includes('*')) parts.push('contains zero or more occurrences');
      if (pattern.includes('?')) parts.push('contains optional elements');
      if (pattern.includes('{')) parts.push('specifies an exact quantity of occurrences');
      if (pattern.includes('[')) parts.push('contains character classes');
      if (pattern.includes('(')) parts.push('uses capturing groups');
      if (pattern.includes('|')) parts.push('includes alternatives');

      if (parts.length > 0) {
        explanationText += parts.join(', ') + '.';
      } else {
        explanationText += 'is a literal text match.';
      }

      // Add flags explanation
      if (currentFlags.length > 0) {
        explanationText += '<br><br>Flags enabled:';
        explanationText += '<ul>';
        if (currentFlags.includes('g')) explanationText += '<li><b>g</b> (global): Find all matches rather than stopping after the first match</li>';
        if (currentFlags.includes('i')) explanationText += '<li><b>i</b> (ignore case): Makes the pattern case-insensitive</li>';
        if (currentFlags.includes('m')) explanationText += '<li><b>m</b> (multiline): ^ and $ match the start/end of each line, not just the entire string</li>';
        if (currentFlags.includes('s')) explanationText += '<li><b>s</b> (dotall): Makes . match newlines as well</li>';
        if (currentFlags.includes('u')) explanationText += '<li><b>u</b> (unicode): Treats the pattern as a sequence of Unicode code points</li>';
        if (currentFlags.includes('y')) explanationText += '<li><b>y</b> (sticky): Matches start at the current position in the target string</li>';
        explanationText += '</ul>';
      }

      explanation.innerHTML = explanationText;
      explanationContainer.style.display = 'block';
    } catch (error) {
      explanation.textContent = 'Could not generate explanation for this pattern.';
      explanationContainer.style.display = 'block';
    }
  }

  function toggleFlag(event) {
    const flagButton = event.currentTarget;
    const flag = flagButton.dataset.flag;

    if (currentFlags.includes(flag)) {
      // Remove flag if it's already active
      currentFlags = currentFlags.filter(f => f !== flag);
      flagButton.classList.remove('active');
    } else {
      // Add flag if it's not active
      currentFlags.push(flag);
      flagButton.classList.add('active');
    }

    // Validate with new flags
    validateRegex();
  }

  function clearRegex() {
    regexInput.value = '';
    regexValidation.classList.add('hidden');
    resultsCard.style.display = 'none';
  }

  function copyResults() {
    const textToCopy = resultContent.textContent;
    navigator.clipboard.writeText(textToCopy)
            .then(() => showToast('Results copied to clipboard', 'success'))
            .catch(() => showToast('Failed to copy to clipboard', 'error'));
  }

  function filterExamples() {
    const filterText = exampleFilter.value.toLowerCase();

    exampleItems.forEach(item => {
      const text = item.textContent.toLowerCase();
      const pattern = item.dataset.pattern.toLowerCase();

      if (text.includes(filterText) || pattern.includes(filterText)) {
        item.style.display = 'block';
        // Make sure the parent category is expanded
        const category = item.closest('.category-examples');
        if (category) {
          category.classList.add('expanded');
        }
      } else {
        item.style.display = 'none';
      }
    });
  }

  function toggleCategory(event) {
    const header = event.currentTarget;
    const categoryId = header.dataset.category;
    const categoryExamples = document.getElementById(`${categoryId}-examples`);

    categoryExamples.classList.toggle('expanded');
  }

  function toggleTheme() {
    if (themeToggle.checked) {
      document.documentElement.setAttribute('data-theme', 'dark');
      localStorage.setItem('regexlab-theme', 'dark');
    } else {
      document.documentElement.setAttribute('data-theme', 'light');
      localStorage.setItem('regexlab-theme', 'light');
    }
  }

  function toggleSidebar() {
    sidebar.classList.toggle('active');
    overlay.classList.toggle('active');
  }

  function closeSidebar() {
    sidebar.classList.remove('active');
    overlay.classList.remove('active');
  }

  function showToast(message, type = 'info') {
    const toastContainer = document.getElementById('toast-container');
    const toast = document.createElement('div');
    toast.className = `toast toast-${type}`;

    // Add icon based on type
    let icon = '';
    switch (type) {
      case 'success':
        icon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>';
        break;
      case 'error':
        icon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>';
        break;
      case 'warning':
        icon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>';
        break;
      default:
        icon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>';
    }

    toast.innerHTML = `
        <div class="toast-icon">${icon}</div>
        <div class="toast-message">${message}</div>
      `;

    toastContainer.appendChild(toast);

    // Remove toast after 3 seconds
    setTimeout(() => {
      toast.style.opacity = '0';
      toast.style.transform = 'translateY(10px)';

      // Remove from DOM after animation
      setTimeout(() => {
        if (toastContainer.contains(toast)) {
          toastContainer.removeChild(toast);
        }
      }, 300);
    }, 3000);
  }

  function handleKeyboardShortcuts(event) {
    // Test (Ctrl+Enter)
    if (event.ctrlKey && event.key === 'Enter' && !event.shiftKey) {
      event.preventDefault();
      testButton.click();
    }

    // Replace (Ctrl+Shift+Enter)
    if (event.ctrlKey && event.shiftKey && event.key === 'Enter') {
      event.preventDefault();
      replaceButton.click();
    }

    // Copy results (Ctrl+C when results are visible)
    if (event.ctrlKey && event.key === 'c' && resultsCard.style.display !== 'none' && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA') {
      event.preventDefault();
      copyResultsButton.click();
    }

    // Toggle flags with keyboard shortcuts
    if (event.ctrlKey && !event.shiftKey && !event.altKey) {
      const flagMap = {
        'g': 'g',
        'i': 'i',
        'm': 'm',
        's': 's',
        'u': 'u',
        'y': 'y'
      };

      const flag = flagMap[event.key.toLowerCase()];
      if (flag) {
        event.preventDefault();
        const flagButton = document.querySelector(`.flag-button[data-flag="${flag}"]`);
        if (flagButton) {
          flagButton.click();
        }
      }
    }

    // Toggle sidebar (Ctrl+B)
    if (event.ctrlKey && event.key === 'b') {
      event.preventDefault();
      if (window.innerWidth <= 768) {
        toggleSidebar();
      }
    }

    // Toggle theme (Ctrl+Shift+D)
    if (event.ctrlKey && event.shiftKey && event.key === 'D') {
      event.preventDefault();
      themeToggle.checked = !themeToggle.checked;
      toggleTheme();
    }

    // Clear regex (Escape when focused on regex input)
    if (event.key === 'Escape' && document.activeElement === regexInput) {
      event.preventDefault();
      clearRegex();
    }
  }

  function showKeyboardShortcuts(event) {
    event.preventDefault();

    const shortcuts = [
      { key: 'Ctrl+Enter', description: 'Test regex' },
      { key: 'Ctrl+Shift+Enter', description: 'Replace matches' },
      { key: 'Ctrl+C', description: 'Copy results (when results are visible)' },
      { key: 'Ctrl+G', description: 'Toggle global flag' },
      { key: 'Ctrl+I', description: 'Toggle ignore case flag' },
      { key: 'Ctrl+M', description: 'Toggle multiline flag' },
      { key: 'Ctrl+S', description: 'Toggle dotall flag' },
      { key: 'Ctrl+U', description: 'Toggle unicode flag' },
      { key: 'Ctrl+Y', description: 'Toggle sticky flag' },
      { key: 'Ctrl+B', description: 'Toggle sidebar (on mobile)' },
      { key: 'Ctrl+Shift+D', description: 'Toggle dark/light theme' },
      { key: 'Escape', description: 'Clear regex input (when focused)' }
    ];

    let shortcutsHTML = '<div style="max-width: 500px; margin: 0 auto;">';
    shortcutsHTML += '<h3 style="margin-bottom: 1rem;">Keyboard Shortcuts</h3>';
    shortcutsHTML += '<div style="display: grid; grid-template-columns: auto 1fr; gap: 0.5rem 1rem;">';

    shortcuts.forEach(shortcut => {
      shortcutsHTML += `
          <div style="font-family: var(--font-mono); padding: 0.25rem 0.5rem; background-color: var(--color-bg-primary); border-radius: 0.25rem;">${shortcut.key}</div>
          <div>${shortcut.description}</div>
        `;
    });

    shortcutsHTML += '</div></div>';

    showModal('Keyboard Shortcuts', shortcutsHTML);
  }

  function showModal(title, content) {
    // Create modal container
    const modalContainer = document.createElement('div');
    modalContainer.style.position = 'fixed';
    modalContainer.style.top = '0';
    modalContainer.style.left = '0';
    modalContainer.style.width = '100%';
    modalContainer.style.height = '100%';
    modalContainer.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
    modalContainer.style.display = 'flex';
    modalContainer.style.alignItems = 'center';
    modalContainer.style.justifyContent = 'center';
    modalContainer.style.zIndex = '1000';
    modalContainer.style.backdropFilter = 'blur(2px)';

    // Create modal content
    const modal = document.createElement('div');
    modal.style.backgroundColor = 'var(--color-bg-secondary)';
    modal.style.borderRadius = '0.5rem';
    modal.style.boxShadow = 'var(--shadow-md)';
    modal.style.padding = '1.5rem';
    modal.style.maxWidth = '90%';
    modal.style.maxHeight = '90%';
    modal.style.overflow = 'auto';

    // Add modal header
    const modalHeader = document.createElement('div');
    modalHeader.style.display = 'flex';
    modalHeader.style.justifyContent = 'space-between';
    modalHeader.style.alignItems = 'center';
    modalHeader.style.marginBottom = '1rem';

    const modalTitle = document.createElement('h2');
    modalTitle.textContent = title;
    modalTitle.style.margin = '0';

    const closeButton = document.createElement('button');
    closeButton.innerHTML = '&times;';
    closeButton.style.background = 'none';
    closeButton.style.border = 'none';
    closeButton.style.fontSize = '1.5rem';
    closeButton.style.cursor = 'pointer';
    closeButton.style.color = 'var(--color-text-primary)';
    closeButton.addEventListener('click', () => {
      document.body.removeChild(modalContainer);
    });

    modalHeader.appendChild(modalTitle);
    modalHeader.appendChild(closeButton);

    // Add modal body
    const modalBody = document.createElement('div');
    modalBody.innerHTML = content;

    modal.appendChild(modalHeader);
    modal.appendChild(modalBody);

    modalContainer.appendChild(modal);

    // Close on click outside
    modalContainer.addEventListener('click', (e) => {
      if (e.target === modalContainer) {
        document.body.removeChild(modalContainer);
      }
    });

    // Close on escape key
    document.addEventListener('keydown', function closeModal(e) {
      if (e.key === 'Escape') {
        document.body.removeChild(modalContainer);
        document.removeEventListener('keydown', closeModal);
      }
    });

    document.body.appendChild(modalContainer);
  }

  function setButtonLoading(button, isLoading) {
    if (isLoading) {
      const loadingSpinner = document.createElement('span');
      loadingSpinner.className = 'loading';
      button.prepend(loadingSpinner);
      button.disabled = true;
    } else {
      const loadingSpinner = button.querySelector('.loading');
      if (loadingSpinner) {
        button.removeChild(loadingSpinner);
      }
      button.disabled = false;
    }
  }

  // Helper functions
  function escapeHTML(text) {
    return text
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#039;');
  }

  function debounce(func, wait) {
    let timeout;
    return function(...args) {
      clearTimeout(timeout);
      timeout = setTimeout(() => func.apply(this, args), wait);
    };
  }

  // Add regex protection with timeouts
  window.addEventListener('unhandledrejection', function(event) {
    console.error('Unhandled promise rejection:', event.reason);
    showToast('An error occurred. The operation may have timed out due to a complex pattern.', 'error');
  });
</script>
<script src="../logo.js"></script>
</body>
</html>