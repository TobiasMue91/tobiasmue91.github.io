<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üåê</text></svg>">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>GPTranslator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/choices.js/10.2.0/choices.min.css" integrity="sha512-oW+fEHZatXKwZQ5Lx5td2J93WJnSFLbnALFOFqy/pTuQyffi9gsUylGGZkD3DTSv8zkoOdU7MT7I6LTDcV8GBQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/json5/2.2.3/index.min.js" integrity="sha512-44jdhc+R2TFfzBflS3/dGNEABiNUxBkkrqwO7GWTvGsj3HkQNr3GESvI9PUvAxmqxSnTosR0Ij9y3+o+6J1hig==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/choices.js/10.2.0/choices.min.js" integrity="sha512-OrRY3yVhfDckdPBIjU2/VXGGDjq3GPcnILWTT39iYiuV6O3cEcAxkgCBVR49viQ99vBFeu+a6/AoFAkNHgFteg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
        }

        main {
            width: 90%;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background-color: #ffffff;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group.flex {
            display: flex;
        }

        .form-group.flex > div {
            flex-basis: 50%;
        }

        #custom-target-language {
            height: 44px;
        }

        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }

        input, textarea, select {
            width: 100%;
            padding: 5px;
            font-size: 1rem;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        button {
            width: 100%;
            padding: 10px;
            background-color: #007bff;
            color: #ffffff;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        #translation-results {
            margin-top: 20px;
        }

        .about {
            margin-top: 40px;
            margin-bottom: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
<main>
    <h1>GPTranslator</h1>
    <form id="translator-form">
        <div class="form-group">
            <label for="input-string">Input Text:</label>
            <textarea id="input-string" placeholder="Enter text to translate"></textarea>
        </div>
        <div class="form-group">
            <label for="context">Context (optional):</label>
            <input type="text" id="context" placeholder="Provide context">
        </div>
        <div class="form-group flex">
            <div>
                <label for="target-language">Target Language:</label>
                <select id="target-language">
                    <option value="af">Afrikaans</option>
                    <option value="sq">Albanian</option>
                    <option value="algi">Alien Gibberish</option>
                    <option value="aneghi">Ancient Egyptian Hieroglyphics</option>
                    <option value="am">Amharic</option>
                    <option value="ar">Arabic</option>
                    <option value="hy">Armenian</option>
                    <option value="asmr">ASMR Slang</option>
                    <option value="aua">Australian accent</option>
                    <option value="az">Azerbaijani</option>
                    <option value="eu">Basque</option>
                    <option value="bay">Bayrisch</option>
                    <option value="batr">Bavarian Trump</option>
                    <option value="be">Belarusian</option>
                    <option value="bn">Bengali</option>
                    <option value="ber">Berlinerisch</option>
                    <option value="biden">Biden Slang</option>
                    <option value="bs">Bosnian</option>
                    <option value="bra">Braille</option>
                    <option value="bg">Bulgarian</option>
                    <option value="cat">Cat Speech</option>
                    <option value="ca">Catalan</option>
                    <option value="cagr">Caveman Grunts</option>
                    <option value="ceb">Cebuano</option>
                    <option value="zh-CN">Chinese (Simplified)</option>
                    <option value="zh-TW">Chinese (Traditional)</option>
                    <option value="co">Corsican</option>
                    <option value="hr">Croatian</option>
                    <option value="cs">Czech</option>
                    <option value="cy">Cynicism</option>
                    <option value="da">Danish</option>
                    <option value="do">Dothraki</option>
                    <option value="nl">Dutch</option>
                    <option value="emo">Emoji</option>
                    <option value="en" selected>English</option>
                    <option value="eo">Esperanto</option>
                    <option value="et">Estonian</option>
                    <option value="fil">Filipino</option>
                    <option value="fi">Finnish</option>
                    <option value="fr">French</option>
                    <option value="frsl">French with slang</option>
                    <option value="fy">Frisian</option>
                    <option value="gl">Galician</option>
                    <option value="gasl">Gamer slang</option>
                    <option value="gl">Gangster slang</option>
                    <option value="glf">Gallifreyan</option>
                    <option value="ka">Georgian</option>
                    <option value="de">German</option>
                    <option value="el">Greek</option>
                    <option value="gu">Gujarati</option>
                    <option value="ht">Haitian Creole</option>
                    <option value="ha">Hausa</option>
                    <option value="haw">Hawaiian</option>
                    <option value="iw">Hebrew</option>
                    <option value="hi">Hindi</option>
                    <option value="hv">High Valyrian</option>
                    <option value="hmn">Hmong</option>
                    <option value="hu">Hungarian</option>
                    <option value="is">Icelandic</option>
                    <option value="ig">Igbo</option>
                    <option value="id">Indonesian</option>
                    <option value="isl">Internet slang</option>
                    <option value="ga">Irish</option>
                    <option value="ira">Irish accent</option>
                    <option value="it">Italian</option>
                    <option value="ja">Japanese</option>
                    <option value="jw">Javanese</option>
                    <option value="kn">Kannada</option>
                    <option value="kl">Klingon</option>
                    <option value="kk">Kazakh</option>
                    <option value="km">Khmer</option>
                    <option value="ko">Korean</option>
                    <option value="ku">Kurdish</option>
                    <option value="ky">Kyrgyz</option>
                    <option value="lo">Lao</option>
                    <option value="la">Latin</option>
                    <option value="lv">Latvian</option>
                    <option value="lgbtq">LGBTQ+ Slang</option>
                    <option value="lt">Lithuanian</option>
                    <option value="lb">Luxembourgish</option>
                    <option value="mk">Macedonian</option>
                    <option value="mg">Malagasy</option>
                    <option value="ms">Malay</option>
                    <option value="ml">Malayalam</option>
                    <option value="mt">Maltese</option>
                    <option value="mi">Maori</option>
                    <option value="mr">Marathi</option>
                    <option value="mesl">Medical slang</option>
                    <option value="mn">Mongolian</option>
                    <option value="morse">Morse Code</option>
                    <option value="my">Myanmar (Burmese)</option>
                    <option value="nv">Na'vi</option>
                    <option value="ne">Nepali</option>
                    <option value="nesl">Nerd Slang</option>
                    <option value="no">Norwegian</option>
                    <option value="ny">Nyanja (Chichewa)</option>
                    <option value="ock">Ockm√§nisch</option>
                    <option value="oesi">√ñsterreichisch</option>
                    <option value="ps">Pashto</option>
                    <option value="pr">Parseltongue</option>
                    <option value="fa">Persian</option>
                    <option value="pisp">Pirate Speak</option>
                    <option value="pl">Polish</option>
                    <option value="pt">Portuguese</option>
                    <option value="pa">Punjabi</option>
                    <option value="qu">Quenya</option>
                    <option value="robeep">Robot Beeps and Boops</option>
                    <option value="ro">Romanian</option>
                    <option value="ru">Russian</option>
                    <option value="sae">S√§chsisch</option>
                    <option value="sar">Sarcasm</option>
                    <option value="sm">Samoan</option>
                    <option value="swide">Schweizerdeutsch</option>
                    <option value="gd">Scots Gaelic</option>
                    <option value="sca">Scottish accent</option>
                    <option value="sec">Secret Agent Code</option>
                    <option value="sr">Serbian</option>
                    <option value="st">Sesotho</option>
                    <option value="shaen">Shakespearean English</option>
                    <option value="sn">Shona</option>
                    <option value="sd">Sindhi</option>
                    <option value="sa">Sindarin</option>
                    <option value="si">Sinhala (Sinhalese)</option>
                    <option value="sim">Simlish</option>
                    <option value="sk">Slovak</option>
                    <option value="sl">Slovenian</option>
                    <option value="so">Somali</option>
                    <option value="es">Spanish</option>
                    <option value="su">Sundanese</option>
                    <option value="susl">Surfer slang</option>
                    <option value="stsl">Stoner slang</option>
                    <option value="sw">Swahili</option>
                    <option value="sv">Swedish</option>
                    <option value="tg">Tajik</option>
                    <option value="ta">Tamil</option>
                    <option value="tt">Tatar</option>
                    <option value="te">Telugu</option>
                    <option value="th">Thai</option>
                    <option value="tr">Turkish</option>
                    <option value="tk">Turkmen</option>
                    <option value="trump">Trump Slang</option>
                    <option value="twitch">Twitch Chat Slang</option>
                    <option value="uk">Ukrainian</option>
                    <option value="ur">Urdu</option>
                    <option value="ug">Uyghur</option>
                    <option value="uwu">UwU Speech</option>
                    <option value="uz">Uzbek</option>
                    <option value="vi">Vietnamese</option>
                    <option value="viki">Viking War Chants</option>
                    <option value="vu">Vulcan</option>
                    <option value="cy">Welsh</option>
                    <option value="wh">Whale</option>
                    <option value="wiz">Wizard Incantations</option>
                    <option value="woke">Woke Slang</option>
                    <option value="xh">Xhosa</option>
                    <option value="yi">Yiddish</option>
                    <option value="yo">Yoruba</option>
                    <option value="zu">Zulu</option>
                </select>
            </div>
            <div>
                <label for="custom-target-language">Custom:</label>
                <input type="text" id="custom-target-language">
            </div>
        </div>
        <div class="form-group">
            <label for="creativity">Creativity:</label>
            <input type="range" id="creativity" name="creativity" min="0" max="1" step="0.1" value="0.2">
            <span id="creativity-value">20%</span>
        </div>
        <button type="submit" id="translate-button">Translate</button>
    </form>
    <div id="translation-results"></div>
    <div class="about">
        <h3>About</h3>
        <p>
            GPTranslator is a versatile language companion that effortlessly translates text across a wide range of
            languages, from conventional to quirky and imaginative. Our collection of fun languages includes Pirate
            Speak, Ancient Egyptian Hieroglyphics, Nerd Slang, Shakespearean English, Viking War Chants and many more.
            <br><br>
            Dive into a world of linguistic possibilities while GPTranslator automatically detects your input language
            and delivers accurate translations, considering the context you provide. Adjust the "Creativity" slider to
            control the translation's variability: a higher value introduces more diverse and inventive translations,
            while a lower value yields more focused and deterministic outcomes.
            <br><br>
            <strong>Warning:</strong> A creativity of over 60% is dangerous territory. It often leads to failing
            translations.
            <br><br>
            Embrace the power of GPTranslator and embark on a fascinating journey through languages, both real and
            fantastical!
        </p>
    </div>
</main>
<script type="text/javascript">
    let isTranslating = false;
    const resultsContainer = document.getElementById("translation-results");
    document.getElementById("translator-form").addEventListener("submit", async function (event) {
        event.preventDefault();
        if (isTranslating) {
            return;
        }
        isTranslating = true;
        const translateButton = document.getElementById("translate-button");
        translateButton.textContent = "Translating...";
        const inputString = document.getElementById("input-string").value;
        const context = document.getElementById("context").value;
        const targetLanguageValue = document.getElementById("target-language").value;
        const targetLanguageText = document.querySelector(`option[value=${targetLanguageValue}]`).innerText;
        const creativity = Number(document.getElementById("creativity").value);
        const customTargetLanguage = document.getElementById("custom-target-language").value;
        const targetLanguage = customTargetLanguage || targetLanguageText;
        const response = await fetch('https://chatgpt.tobiasmue91.workers.dev/', {
            method: 'POST',
            headers: {"Content-Type": "application/json", "Accept": "*/*"},
            body: JSON.stringify({
                model: "gpt-4",
                max_tokens: 250,
                temperature: creativity * 2,
                messages: [
                    {
                        role: "assistant",
                        content: `
I am GPTranslator. I will respond in JSON-Format and return accurate translations while automatically detect the input language. \n
When the target language is fictional or an animal language, I will give a creative and convincing response nonetheless.\n\n
I will respond in this JSON format: { "detected_language": "COUNTRY_CODE", "translation_options": [ { "translation": "TRANSLATION_1", "fitting_score": 0.XX }, { "translation": "TRANSLATION_2", "fitting_score": 0.XX }, ... ] }\n\n
Provide the input string, (optional) context and the target language and I will provide the translation(s).\n
I will provide at least one translation result and the fitting_score can range between 0.0 and 1.0.`,
                    },
                    {
                        role: "user",
                        content: `
Input string: "${inputString}";\n` +
                            (context ? `Context: "${context}";\n` : ``) +
                            `Target language: "${targetLanguage}";`,
                    },
                ],
            })
        });


        if (!response.ok) {
            resultsContainer.innerHTML = `<p>Could not retrieve translations.</p>`;
            isTranslating = false;
            translateButton.textContent = "Translate";
            return;
        }

        const data = await response.json();
        displayTranslations(data);
        isTranslating = false;
        translateButton.textContent = "Translate";
    });

    function displayTranslations(data) {
        resultsContainer.innerHTML = "";
        const responseContent = data.choices[0].message.content;
        const responseJsonStr = responseContent.substring(responseContent.indexOf("{"), responseContent.lastIndexOf("}") + 1);
        let responseJsonData;
        try {
            responseJsonData = fixJSON(responseJsonStr);
        } catch (e) {
            console.log(e);
            resultsContainer.innerHTML = `<p>Could not parse translations. But here is the response (most likely) in JSON format:</p><pre>${responseContent}</pre>`;
            return;
        }
        if (responseJsonData && responseJsonData.translation_options) {
            const {detected_language, translation_options} = responseJsonData;
            resultsContainer.innerHTML += `<p><strong>Detected Language:</strong> ${detected_language}</p>`;
            translation_options.forEach(option => {
                const fittingScore = option.hasOwnProperty('fitting_score') ? ` (${option.fitting_score.toFixed(2)})` : '';
                resultsContainer.innerHTML += `<p><strong>Translation:${fittingScore}</strong> ${option.translation}</p>`;
            });
        } else {
            resultsContainer.innerHTML = `<p>Could not retrieve translations.</p>`;
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        const targetLanguageSelect = document.getElementById('target-language');
        new Choices(targetLanguageSelect, {
            itemSelectText: 'Select'
        });
        document.getElementById("creativity").addEventListener("input", function (event) {
            document.getElementById("creativity-value").textContent = Number(event.target.value) * 100 + '%';
        });
    });

    const fixJSON = (jsonStr) => {
        // Remove newline characters from the input string.
        jsonStr = jsonStr.replace(/\n/g, '');

        // Substitute all the backslashes from JSON string.
        jsonStr = jsonStr.replace(/\\/g, '');

        try {
            return JSON5.parse(jsonStr);
        } catch (error) {
            while (true) {
                // Search json string specifically for '"'
                const match = jsonStr.match(/[\w|"]\s?(")\s?[\w|"]/);

                // If we don't find any, then we come out of the loop
                if (!match) {
                    break;
                }

                // Get the location of \"
                const s = match.index + match[0].indexOf('"');
                const e = s + 1;
                let c = jsonStr.substring(s, e);

                // Replace \" with \'
                c = c.replace(/"/g, "'");
                jsonStr = jsonStr.substring(0, s) + c + jsonStr.substring(e);
            }
            return JSON5.parse(jsonStr);
        }
    };
</script>
<script src="../sidebar.js"></script>
<script data-goatcounter="https://gptgames.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</body>
</html>
