<!DOCTYPE html>
<html lang="en" x-data="unitConverter()" :class="{'dark':darkMode}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CSS Unit Converter - Convert px, em, rem, %, vh, vw & More | GPT Games</title>
    <meta name="description"
          content="Professional CSS unit converter tool. Convert between px, em, rem, %, vh, vw, pt, and more with live preview, batch conversion, and CSS code generation. Free online tool.">
    <meta name="keywords"
          content="css unit converter,px to rem,em to px,rem calculator,viewport units,css units,web development tools,responsive design,font size converter">
    <meta name="author" content="GPT Games">
    <link rel="canonical" href="https://gptgames.dev/tools/css_unit_converter.html">
    <meta property="og:title" content="CSS Unit Converter - Professional Web Development Tool">
    <meta property="og:description"
          content="Convert between all CSS units instantly. Features batch conversion, visual preview, CSS code generation, and more.">
    <meta property="og:url" content="https://gptgames.dev/tools/css_unit_converter.html">
    <meta property="og:image" content="https://gptgames.dev/screenshots/screenshot_217.webp">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="GPT Games">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CSS Unit Converter - Convert px, em, rem, % & More">
    <meta name="twitter:description" content="Professional CSS unit converter with live preview and code generation">
    <meta name="twitter:image" content="https://gptgames.dev/screenshots/screenshot_217.webp">
    <meta name="robots" content="index,follow">
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "CSS Unit Converter",
        "description": "Convert between CSS units with precision. Supports px, em, rem, %, vh, vw and more.",
        "url": "https://gptgames.dev/tools/css_unit_converter.html",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "publisher": {
            "@type": "Organization",
            "name": "GPT Games",
            "url": "https://gptgames.dev"
        }
    }</script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --bg-tertiary: #f3f4f6;
            --border: #e5e7eb;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --text-tertiary: #9ca3af;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --success: #10b981;
            --error: #ef4444;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)
        }

        .dark {
            --bg-primary: #1f2937;
            --bg-secondary: #111827;
            --bg-tertiary: #0f172a;
            --border: #374151;
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --text-tertiary: #9ca3af;
            --accent: #60a5fa;
            --accent-hover: #3b82f6;
            --success: #34d399;
            --error: #f87171;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.2)
        }

        body {
            font-family: system-ui, -apple-system, 'Segoe UI', sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            transition: background 0.2s, color 0.2s
        }

        .card {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            transition: all 0.2s
        }

        .card:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)
        }

        .input-field {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            padding: 0.625rem 0.875rem;
            color: var(--text-primary);
            transition: all 0.2s;
            width: 100%;
            font-size: 0.95rem
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1)
        }

        .btn {
            padding: 0.625rem 1.25rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
            font-size: 0.95rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem
        }

        .btn-primary {
            background: var(--accent);
            color: white
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3)
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border)
        }

        .btn-secondary:hover {
            background: var(--border)
        }

        .unit-result {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            padding: 0.75rem;
            transition: all 0.2s;
            position: relative
        }

        .unit-result:hover {
            border-color: var(--accent);
            transform: translateY(-1px)
        }

        .unit-result:hover .copy-btn {
            opacity: 1
        }

        .copy-btn {
            opacity: 0;
            transition: opacity 0.2s
        }

        .badge {
            padding: 0.25rem 0.625rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border);
            transition: all 0.2s;
            cursor: pointer
        }

        .badge:hover {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
            transform: scale(1.05)
        }

        .preview-box {
            background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(0, 0, 0, 0.03) 10px, rgba(0, 0, 0, 0.03) 20px);
            border: 2px dashed var(--border);
            border-radius: 0.5rem;
            padding: 1.5rem
        }

        .toast {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: var(--success);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            animation: slideIn 0.3s ease-out
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0
            }
            to {
                transform: translateX(0);
                opacity: 1
            }
        }

        .tab {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
            background: transparent;
            color: var(--text-secondary)
        }

        .tab.active {
            background: var(--accent);
            color: white
        }

        .tab:hover:not(.active) {
            background: var(--bg-tertiary)
        }

        .formula-item {
            padding: 0.5rem;
            border-left: 3px solid var(--accent);
            background: var(--bg-secondary);
            margin-bottom: 0.5rem;
            border-radius: 0 0.25rem 0.25rem 0
        }

        @media (max-width: 768px) {
            .grid-responsive {
                grid-template-columns:1fr !important
            }
        }
    </style>
    <script>tailwind.config = {darkMode: 'class'}</script>
</head>
<body class="min-h-screen">
<div class="max-w-7xl mx-auto p-4 md:p-6">
    <header class="card p-6 mb-6">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
            <div>
                <h1 class="text-2xl md:text-3xl font-bold text-[var(--text-primary)]">CSS Unit Converter</h1>
                <p class="text-sm mt-1 text-[var(--text-secondary)]">Convert between CSS units with precision and
                    ease</p>
            </div>
            <div class="flex items-center gap-3">
                <button @click="showFormulas=!showFormulas" class="btn btn-secondary" title="View Formulas">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                    </svg>
                    <span class="hidden md:inline">Formulas</span>
                </button>
                <button @click="reset()" class="btn btn-secondary" title="Reset All">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                    </svg>
                    <span class="hidden md:inline">Reset</span>
                </button>
                <button @click="darkMode=!darkMode" class="btn btn-secondary"
                        :title="darkMode?'Light Mode':'Dark Mode'">
                    <svg x-show="!darkMode" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
                    </svg>
                    <svg x-show="darkMode" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
                    </svg>
                </button>
            </div>
        </div>
    </header>
    <div class="grid lg:grid-cols-3 gap-6 grid-responsive">
        <div class="lg:col-span-2 space-y-6">
            <div class="card p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-semibold text-[var(--text-primary)]">Base Configuration</h2>
                    <div class="flex gap-2">
                        <template x-for="preset in presets" :key="preset.name">
                            <button @click="applyPreset(preset)" class="badge" x-text="preset.name"></button>
                        </template>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1.5 text-[var(--text-secondary)]">Root Font Size (rem
                            base)</label>
                        <div class="flex items-center gap-2">
                            <input type="number" x-model.number="baseFontSize" @input="handleSettingsChange()" class="input-field"
                                   min="8" max="32" step="1">
                            <span class="text-sm text-[var(--text-tertiary)]">px</span>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1.5 text-[var(--text-secondary)]">Parent Font Size
                            (em base)</label>
                        <div class="flex items-center gap-2">
                            <input type="number" x-model.number="parentFontSize" @input="handleSettingsChange()" class="input-field"
                                   min="8" max="100" step="1">
                            <span class="text-sm text-[var(--text-tertiary)]">px</span>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1.5 text-[var(--text-secondary)]">Viewport
                            Width</label>
                        <div class="flex items-center gap-2">
                            <input type="number" x-model.number="viewportWidth" @input="handleSettingsChange()" class="input-field"
                                   min="320" max="3840" step="1">
                            <span class="text-sm text-[var(--text-tertiary)]">px</span>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1.5 text-[var(--text-secondary)]">Viewport
                            Height</label>
                        <div class="flex items-center gap-2">
                            <input type="number" x-model.number="viewportHeight" @input="handleSettingsChange()" class="input-field"
                                   min="320" max="2160" step="1">
                            <span class="text-sm text-[var(--text-tertiary)]">px</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-semibold text-[var(--text-primary)]">Converter</h2>
                    <div class="flex gap-2">
                        <button @click="mode='single'" class="tab" :class="{'active':mode==='single'}">Single</button>
                        <button @click="mode='batch'" class="tab" :class="{'active':mode==='batch'}">Batch</button>
                        <button @click="mode='css'" class="tab" :class="{'active':mode==='css'}">CSS Gen</button>
                    </div>
                </div>
                <div x-show="mode==='single'">
                    <div class="flex gap-3 mb-4">
                        <input type="number" x-model.number="inputValue" @input="handleInputChange()" class="input-field flex-1"
                               placeholder="Enter value..." step="any">
                        <select x-model="inputUnit" @change="handleInputChange()" class="input-field w-32">
                            <template x-for="unit in units" :key="unit">
                                <option :value="unit" x-text="unit"></option>
                            </template>
                        </select>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                        <template x-for="unit in units.filter(u=>u!==inputUnit)" :key="unit">
                            <div class="unit-result group">
                                <div class="flex justify-between items-start mb-1">
                                    <span class="text-xs font-semibold uppercase text-[var(--text-tertiary)]"
                                          x-text="unit"></span>
                                    <button @click="copyValue(results[unit],unit)"
                                            class="copy-btn p-1 rounded hover:bg-[var(--bg-tertiary)]" title="Copy">
                                        <svg class="w-3.5 h-3.5 text-[var(--text-tertiary)]" fill="none"
                                             stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="text-lg font-bold text-[var(--text-primary)]"
                                     x-text="results[unit]||'—'"></div>
                            </div>
                        </template>
                    </div>
                    <div class="preview-box mt-4">
                        <div class="text-sm font-medium mb-3 text-[var(--text-secondary)]">Size Preview</div>
                        <div class="space-y-3">
                            <div>
                                <div class="text-xs text-[var(--text-tertiary)] mb-1">Box Size (<span x-text="getPixelValue()"></span>px)</div>
                                <div class="bg-[var(--accent)] rounded transition-all duration-300"
                                     :style="`width:${Math.min(getPixelValue(),400)}px;height:${Math.min(getPixelValue()/4,100)}px;`"></div>
                            </div>
                            <div>
                                <div class="text-xs text-[var(--text-tertiary)] mb-1">Text Size (<span x-text="getPixelValue()"></span>px)</div>
                                <div :style="`font-size:${Math.min(getPixelValue(),72)}px;`"
                                     class="text-[var(--text-primary)] transition-all duration-300">Sample Text
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div x-show="mode==='batch'">
                    <textarea x-model="batchInput" @input="convertBatch()"
                              class="input-field w-full h-32 font-mono text-sm"
                              placeholder="Enter multiple values, one per line:&#10;16px&#10;1.5rem&#10;100%&#10;50vw"></textarea>
                    <div class="space-y-2 mt-4" x-show="batchResults.length">
                        <template x-for="(result,idx) in batchResults" :key="idx">
                            <div class="card p-3">
                                <div class="font-medium mb-2 text-[var(--accent)]" x-text="result.original"></div>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-2 text-sm">
                                    <template x-for="(value,unit) in result.converted" :key="unit">
                                        <div class="text-[var(--text-secondary)]">
                                            <span class="font-medium text-[var(--text-primary)]" x-text="value"></span>
                                            <span x-text="unit"></span>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
                <div x-show="mode==='css'">
                    <div class="space-y-3">
                        <input type="text" x-model="cssProperty" class="input-field"
                               placeholder="CSS property (e.g., font-size, width, padding)">
                        <input type="text" x-model="cssSelector" class="input-field"
                               placeholder="CSS selector (e.g., .class, #id, h1)">
                        <button @click="generateCSS()" class="btn btn-primary w-full">Generate CSS Code</button>
                        <div x-show="generatedCSS" class="mt-4">
                            <div class="bg-[var(--bg-tertiary)] rounded-lg p-4 font-mono text-sm overflow-x-auto">
                                <pre><code class="text-[var(--text-primary)]" x-html="generatedCSS"></code></pre>
                            </div>
                            <button @click="copyValue(generatedCSSRaw,'CSS')" class="btn btn-secondary w-full mt-3">Copy
                                CSS
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card p-6">
                <h2 class="text-lg font-semibold mb-4 text-[var(--text-primary)]">Unit Scale Comparison</h2>
                <p class="text-sm text-[var(--text-secondary)] mb-4">Shows what "1 unit" equals in pixels for each CSS unit type</p>
                <div class="h-64">
                    <canvas id="comparisonChart"></canvas>
                </div>
            </div>
        </div>
        <div class="space-y-6">
            <div class="card p-6">
                <h2 class="text-lg font-semibold mb-4 text-[var(--text-primary)]">Conversion History</h2>
                <div class="space-y-2 max-h-72 overflow-y-auto">
                    <template x-for="(item,idx) in history.slice(0,15)" :key="idx">
                        <div class="flex justify-between items-center p-2 rounded hover:bg-[var(--bg-secondary)] transition-colors">
                            <div class="text-sm">
                                <span class="font-medium text-[var(--text-primary)]"
                                      x-text="`${item.value}${item.unit}`"></span>
                                <span class="text-[var(--text-tertiary)]"> → </span>
                                <span class="text-[var(--accent)]" x-text="item.result"></span>
                            </div>
                            <button @click="removeHistory(idx)" class="p-1 rounded hover:bg-[var(--bg-tertiary)]">
                                <svg class="w-4 h-4 text-[var(--error)]" fill="none" stroke="currentColor"
                                     viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </button>
                        </div>
                    </template>
                    <div x-show="!history.length" class="text-center py-8 text-[var(--text-tertiary)]">No conversions
                        yet
                    </div>
                </div>
                <button @click="clearHistory()" x-show="history.length" class="btn btn-secondary w-full mt-3">Clear
                    History
                </button>
            </div>
            <div class="card p-6" x-show="showFormulas">
                <h2 class="text-lg font-semibold mb-4 text-[var(--text-primary)]">Conversion Formulas</h2>
                <div class="space-y-2 text-sm">
                    <div class="formula-item"><strong>rem:</strong> pixels ÷ root font size</div>
                    <div class="formula-item"><strong>em:</strong> pixels ÷ parent font size</div>
                    <div class="formula-item"><strong>%:</strong> (pixels ÷ parent size) × 100</div>
                    <div class="formula-item"><strong>vw:</strong> (pixels ÷ viewport width) × 100</div>
                    <div class="formula-item"><strong>vh:</strong> (pixels ÷ viewport height) × 100</div>
                    <div class="formula-item"><strong>pt:</strong> pixels × 0.75</div>
                    <div class="formula-item"><strong>in:</strong> pixels ÷ 96</div>
                    <div class="formula-item"><strong>cm:</strong> pixels ÷ 37.795</div>
                </div>
            </div>
            <div class="card p-6">
                <h2 class="text-lg font-semibold mb-4 text-[var(--text-primary)]">Understanding CSS Units</h2>
                <div class="space-y-3 text-sm text-[var(--text-secondary)]">
                    <div><strong class="text-[var(--text-primary)]">Absolute Units:</strong></div>
                    <div class="ml-3">• <strong>px</strong> - Pixels, the most common unit</div>
                    <div class="ml-3">• <strong>pt</strong> - Points (1/72 of an inch)</div>
                    <div class="ml-3">• <strong>in</strong> - Inches</div>
                    <div class="ml-3">• <strong>cm</strong> - Centimeters</div>

                    <div class="mt-4"><strong class="text-[var(--text-primary)]">Relative Units:</strong></div>
                    <div class="ml-3">• <strong>rem</strong> - Relative to root font size</div>
                    <div class="ml-3">• <strong>em</strong> - Relative to parent font size</div>
                    <div class="ml-3">• <strong>%</strong> - Percentage of parent element</div>
                    <div class="ml-3">• <strong>vw</strong> - 1% of viewport width</div>
                    <div class="ml-3">• <strong>vh</strong> - 1% of viewport height</div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const ChartManager = (function() {
        let chartInstance = null;
        let isInitialized = false;

        function createChart(isDark) {
            const canvas = document.getElementById('comparisonChart');
            if (!canvas) return null;

            const ctx = canvas.getContext('2d');
            if (!ctx) return null;

            return new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Pixels per unit',
                        data: [],
                        backgroundColor: [
                            'rgba(59,130,246,0.6)',
                            'rgba(34,197,94,0.6)',
                            'rgba(168,85,247,0.6)',
                            'rgba(251,146,60,0.6)',
                            'rgba(239,68,68,0.6)',
                            'rgba(236,72,153,0.6)',
                            'rgba(14,165,233,0.6)',
                            'rgba(132,204,22,0.6)',
                            'rgba(245,158,11,0.6)',
                            'rgba(99,102,241,0.6)',
                            'rgba(6,182,212,0.6)'
                        ],
                        borderColor: [
                            'rgba(59,130,246,1)',
                            'rgba(34,197,94,1)',
                            'rgba(168,85,247,1)',
                            'rgba(251,146,60,1)',
                            'rgba(239,68,68,1)',
                            'rgba(236,72,153,1)',
                            'rgba(14,165,233,1)',
                            'rgba(132,204,22,1)',
                            'rgba(245,158,11,1)',
                            'rgba(99,102,241,1)',
                            'rgba(6,182,212,1)'
                        ],
                        borderWidth: 1.5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: (context) => `1${context.label} = ${context.parsed.y.toFixed(2)}px`
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Pixels',
                                color: isDark ? '#d1d5db' : '#374151'
                            },
                            grid: { color: isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)' },
                            ticks: { color: isDark ? '#9ca3af' : '#6b7280' }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'CSS Units (1 unit each)',
                                color: isDark ? '#d1d5db' : '#374151'
                            },
                            grid: { display: false },
                            ticks: { color: isDark ? '#9ca3af' : '#6b7280' }
                        }
                    }
                }
            });
        }

        return {
            init(isDark) {
                if (isInitialized) return;
                isInitialized = true;

                setTimeout(() => {
                    try {
                        chartInstance = createChart(isDark);
                    } catch (error) {
                        console.error('Chart initialization failed:', error);
                    }
                }, 300);
            },

            updateData(unitScales) {
                if (!chartInstance || !unitScales) return;

                try {
                    const labels = Object.keys(unitScales);
                    const data = Object.values(unitScales);

                    chartInstance.data.labels = [...labels];
                    chartInstance.data.datasets[0].data = [...data];
                    chartInstance.update('none');
                } catch (error) {
                    console.error('Chart update failed:', error);
                }
            },

            updateTheme(isDark) {
                if (!chartInstance) return;

                try {
                    chartInstance.options.scales.y.grid.color = isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)';
                    chartInstance.options.scales.y.ticks.color = isDark ? '#9ca3af' : '#6b7280';
                    chartInstance.options.scales.y.title.color = isDark ? '#d1d5db' : '#374151';
                    chartInstance.options.scales.x.ticks.color = isDark ? '#9ca3af' : '#6b7280';
                    chartInstance.options.scales.x.title.color = isDark ? '#d1d5db' : '#374151';
                    chartInstance.update('none');
                } catch (error) {
                    console.error('Chart theme update failed:', error);
                }
            }
        };
    })();

    function unitConverter() {
        return {
            darkMode: localStorage.getItem('darkMode') === 'true',
            mode: 'single',
            showFormulas: false,
            inputValue: 16,
            inputUnit: 'px',
            baseFontSize: 16,
            parentFontSize: 16,
            viewportWidth: 1920,
            viewportHeight: 1080,
            units: ['px', 'rem', 'em', '%', 'vw', 'vh', 'pt', 'pc', 'in', 'cm', 'mm'],
            results: {},
            history: JSON.parse(localStorage.getItem('conversionHistory') || '[]'),
            batchInput: '',
            batchResults: [],
            cssProperty: 'font-size',
            cssSelector: '.my-class',
            generatedCSS: '',
            generatedCSSRaw: '',
            presets: [
                {name: 'Mobile', viewportWidth: 375, viewportHeight: 812, baseFontSize: 16},
                {name: 'Tablet', viewportWidth: 768, viewportHeight: 1024, baseFontSize: 16},
                {name: 'Desktop', viewportWidth: 1920, viewportHeight: 1080, baseFontSize: 16}
            ],

            init() {
                this.$watch('darkMode', val => {
                    localStorage.setItem('darkMode', val);
                    ChartManager.updateTheme(val);
                });

                this.convert();
                ChartManager.init(this.darkMode);

                document.addEventListener('keydown', this.handleKeyboard.bind(this));
            },

            handleInputChange() {
                this.convert();
            },

            handleSettingsChange() {
                this.convert();
                this.updateUnitScales();
            },

            convert() {
                if (this.inputValue === '' || this.inputValue === null || isNaN(this.inputValue)) return;

                const px = this.toPixels(this.inputValue, this.inputUnit);
                this.units.forEach(unit => {
                    if (unit !== this.inputUnit) {
                        this.results[unit] = this.fromPixels(px, unit);
                    }
                });

                if (this.inputValue && this.mode === 'single') {
                    const firstUnit = this.units.find(u => u !== this.inputUnit);
                    if (firstUnit && this.results[firstUnit] !== undefined) {
                        this.addToHistory(this.inputValue, this.inputUnit, this.results[firstUnit] + firstUnit);
                    }
                }
            },

            updateUnitScales() {
                const unitScales = {};

                this.units.forEach(unit => {
                    if (unit === 'px') {
                        unitScales[unit] = 1;
                    } else {
                        unitScales[unit] = this.toPixels(1, unit);
                    }
                });

                ChartManager.updateData(unitScales);
            },

            toPixels(value, unit) {
                const v = parseFloat(value) || 0;
                switch (unit) {
                    case'px': return v;
                    case'rem': return v * this.baseFontSize;
                    case'em': return v * this.parentFontSize;
                    case'%': return (v / 100) * this.parentFontSize;
                    case'vw': return (v / 100) * this.viewportWidth;
                    case'vh': return (v / 100) * this.viewportHeight;
                    case'pt': return v * 1.333333;
                    case'pc': return v * 16;
                    case'in': return v * 96;
                    case'cm': return v * 37.795;
                    case'mm': return v * 3.7795;
                    default: return v;
                }
            },

            fromPixels(px, unit) {
                let val;
                switch (unit) {
                    case'px': val = px; break;
                    case'rem': val = px / this.baseFontSize; break;
                    case'em': val = px / this.parentFontSize; break;
                    case'%': val = (px / this.parentFontSize) * 100; break;
                    case'vw': val = (px / this.viewportWidth) * 100; break;
                    case'vh': val = (px / this.viewportHeight) * 100; break;
                    case'pt': val = px * 0.75; break;
                    case'pc': val = px / 16; break;
                    case'in': val = px / 96; break;
                    case'cm': val = px / 37.795; break;
                    case'mm': val = px / 3.7795; break;
                    default: val = px;
                }
                return Math.round(val * 10000) / 10000;
            },

            getPixelValue() {
                return this.toPixels(this.inputValue, this.inputUnit) || 0;
            },

            convertBatch() {
                const lines = this.batchInput.split('\n').filter(l => l.trim());
                this.batchResults = lines.map(line => {
                    const match = line.trim().match(/^([\d.]+)\s*([a-z%]+)$/i);
                    if (!match) return null;
                    const [, value, unit] = match;
                    if (!this.units.includes(unit)) return null;
                    const px = this.toPixels(parseFloat(value), unit);
                    const converted = {};
                    this.units.forEach(u => {
                        if (u !== unit) converted[u] = this.fromPixels(px, u);
                    });
                    return {original: line.trim(), converted};
                }).filter(Boolean);
            },

            generateCSS() {
                if (!this.inputValue || !this.cssProperty || !this.cssSelector) return;
                const lines = [];
                this.units.forEach(unit => {
                    const value = unit === this.inputUnit ? this.inputValue : this.results[unit];
                    if (value !== undefined) {
                        lines.push(`${this.cssSelector} {\n  ${this.cssProperty}: ${value}${unit};\n}`);
                    }
                });
                this.generatedCSSRaw = lines.join('\n\n');
                this.generatedCSS = this.generatedCSSRaw.replace(/\n/g, '<br>').replace(/  /g, '&nbsp;&nbsp;');
            },

            addToHistory(value, unit, result) {
                const entry = {value, unit, result, time: Date.now()};
                this.history.unshift(entry);
                if (this.history.length > 50) this.history = this.history.slice(0, 50);
                localStorage.setItem('conversionHistory', JSON.stringify(this.history));
            },

            removeHistory(idx) {
                this.history.splice(idx, 1);
                localStorage.setItem('conversionHistory', JSON.stringify(this.history));
            },

            clearHistory() {
                this.history = [];
                localStorage.removeItem('conversionHistory');
            },

            copyValue(text, label) {
                if (!text) return;
                navigator.clipboard.writeText(text.toString()).then(() => {
                    const toast = document.createElement('div');
                    toast.className = 'toast';
                    toast.textContent = `${label} copied!`;
                    document.body.appendChild(toast);
                    setTimeout(() => toast.remove(), 2000);
                }).catch(err => console.error('Copy failed:', err));
            },

            applyPreset(preset) {
                this.viewportWidth = preset.viewportWidth;
                this.viewportHeight = preset.viewportHeight;
                this.baseFontSize = preset.baseFontSize;
                this.convert();
                this.updateUnitScales();
            },

            reset() {
                this.inputValue = 16;
                this.inputUnit = 'px';
                this.baseFontSize = 16;
                this.parentFontSize = 16;
                this.viewportWidth = 1920;
                this.viewportHeight = 1080;
                this.convert();
                this.updateUnitScales();
            },

            handleKeyboard(e) {
                if (e.ctrlKey || e.metaKey) {
                    switch (e.key) {
                        case'k':
                            e.preventDefault();
                            const input = document.querySelector('input[type="number"]');
                            if (input) input.focus();
                            break;
                        case'/':
                            e.preventDefault();
                            this.showFormulas = !this.showFormulas;
                            break;
                    }
                }
            }
        };
    }
</script>
<script src="../logo.js"></script>
</body>
</html>