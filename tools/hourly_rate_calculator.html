<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Hourly Rate Calculator - Professional Billing Tool</title>
    <meta name="description" content="Professional hourly rate calculator with client management, tax calculation, and billing history. Calculate your billable hours instantly with this free online tool featuring client tracking and invoice export.">
    <meta name="keywords" content="hourly rate calculator, billing calculator, freelance calculator, hourly wage calculator, time billing, invoice calculator, client billing, freelance tools, contractor calculator, hourly billing">
    <meta name="author" content="Claude Sonnet 4.5 prompted by Tobias Müller">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta property="og:title" content="Hourly Rate Calculator - Professional Billing Tool">
    <meta property="og:description" content="Calculate your billing amount by entering hours worked and hourly rate, with optional client tracking for quick invoicing. Free online tool with dark mode support.">
    <meta property="og:url" content="https://www.gptgames.dev/tools/hourly_rate_calculator.html">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://www.gptgames.dev/screenshots/screenshot_219.webp">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="GPT Games">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Hourly Rate Calculator - Professional Billing Tool">
    <meta name="twitter:description" content="Calculate your billing amount by entering hours worked and hourly rate, with optional client tracking for quick invoicing.">
    <meta name="twitter:image" content="https://www.gptgames.dev/screenshots/screenshot_219.webp">
    <link rel="canonical" href="https://www.gptgames.dev/tools/hourly_rate_calculator.html">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{
            --bg:#ffffff;
            --surface:#f8f9fa;
            --surface-hover:#f1f3f5;
            --primary:#4f46e5;
            --primary-hover:#4338ca;
            --primary-light:#eef2ff;
            --text:#1f2937;
            --text-secondary:#6b7280;
            --border:#e5e7eb;
            --success:#10b981;
            --success-light:#d1fae5;
            --danger:#ef4444;
            --warning:#f59e0b;
            --info:#3b82f6;
            --shadow:0 1px 3px rgba(0,0,0,0.1);
            --shadow-lg:0 10px 25px rgba(0,0,0,0.1);
            --radius:12px;
            --transition:all 0.2s cubic-bezier(0.4,0,0.2,1);
        }
        @media(prefers-color-scheme:dark){
            :root{
                --bg:#0f172a;
                --surface:#1e293b;
                --surface-hover:#334155;
                --primary:#6366f1;
                --primary-hover:#818cf8;
                --primary-light:#312e81;
                --text:#f1f5f9;
                --text-secondary:#94a3b8;
                --border:#334155;
                --success-light:#064e3b;
                --shadow:0 1px 3px rgba(0,0,0,0.4);
                --shadow-lg:0 10px 25px rgba(0,0,0,0.4);
            }
        }
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;padding:20px;transition:var(--transition);min-height:100vh}
        .container{max-width:1400px;margin:0 auto}
        .header{text-align:center;margin-bottom:40px}
        .header h1{font-size:clamp(2rem,5vw,2.75rem);font-weight:700;margin-bottom:10px;background:linear-gradient(135deg,var(--primary),#8b5cf6);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;display:inline-flex;align-items:center;gap:12px}
        .header p{color:var(--text-secondary);font-size:1.1rem;margin-bottom:16px}
        .header .shortcuts{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;font-size:0.85rem;color:var(--text-secondary)}
        .shortcut-badge{background:var(--surface);padding:4px 10px;border-radius:6px;border:1px solid var(--border)}
        .grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px}
        @media(max-width:1024px){
            .grid{grid-template-columns:1fr}
        }
        .card{background:var(--surface);border-radius:var(--radius);padding:24px;box-shadow:var(--shadow);border:1px solid var(--border);transition:var(--transition);position:relative}
        .card:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}
        .card h2{font-size:1.3rem;margin-bottom:20px;display:flex;align-items:center;gap:10px;color:var(--text)}
        .card h2 i{color:var(--primary);font-size:1.5rem}
        .form-group{margin-bottom:20px}
        .form-group label{display:block;margin-bottom:8px;font-weight:600;font-size:0.9rem;color:var(--text);display:flex;align-items:center;gap:6px}
        .tooltip{cursor:help;color:var(--text-secondary);font-size:0.85rem;position:relative}
        .tooltip:hover::after{content:attr(data-tip);position:absolute;bottom:100%;left:50%;transform:translateX(-50%);background:var(--text);color:var(--bg);padding:8px 12px;border-radius:6px;font-size:0.8rem;white-space:nowrap;z-index:1000;margin-bottom:8px;box-shadow:var(--shadow-lg)}
        .input-wrapper{position:relative}
        .input-prefix{position:absolute;left:14px;top:50%;transform:translateY(-50%);color:var(--text-secondary);font-weight:600;pointer-events:none;z-index:1}
        input,select,textarea{width:100%;padding:12px 14px;border:2px solid var(--border);border-radius:8px;background:var(--bg);color:var(--text);font-size:1rem;transition:var(--transition);font-family:inherit}
        input:focus,select:focus,textarea:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(99,102,241,0.1)}
        input.with-prefix{padding-left:32px}
        input.error{border-color:var(--danger)}
        .btn{padding:12px 24px;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;transition:var(--transition);display:inline-flex;align-items:center;gap:8px;justify-content:center;white-space:nowrap}
        .btn:disabled{opacity:0.5;cursor:not-allowed}
        .btn-primary{background:var(--primary);color:#fff}
        .btn-primary:hover:not(:disabled){background:var(--primary-hover);transform:translateY(-1px);box-shadow:var(--shadow-lg)}
        .btn-secondary{background:var(--surface-hover);color:var(--text)}
        .btn-secondary:hover:not(:disabled){background:var(--border)}
        .btn-success{background:var(--success);color:#fff}
        .btn-success:hover:not(:disabled){background:#059669}
        .btn-danger{background:var(--danger);color:#fff}
        .btn-danger:hover:not(:disabled){background:#dc2626}
        .btn-sm{padding:8px 16px;font-size:0.875rem}
        .btn-icon{padding:8px;width:36px;height:36px}
        .result{background:linear-gradient(135deg,var(--primary),#8b5cf6);color:#fff;padding:32px;border-radius:var(--radius);text-align:center;margin-bottom:24px;box-shadow:var(--shadow-lg);position:relative;overflow:hidden}
        .result::before{content:'';position:absolute;top:-50%;right:-50%;width:200%;height:200%;background:radial-gradient(circle,rgba(255,255,255,0.1),transparent);animation:shimmer 3s infinite}
        @keyframes shimmer{0%,100%{transform:translate(0,0)}50%{transform:translate(-10%,-10%)}}
        .result .label{font-size:0.9rem;opacity:0.9;margin-bottom:8px;text-transform:uppercase;letter-spacing:1px}
        .result .amount{font-size:clamp(2.5rem,8vw,3.5rem);font-weight:700;margin-bottom:16px;text-shadow:0 2px 4px rgba(0,0,0,0.2)}
        .result .breakdown{display:flex;justify-content:center;gap:24px;flex-wrap:wrap;font-size:0.9rem;opacity:0.9}
        .summary-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:16px;margin-bottom:24px}
        .stat-card{background:var(--surface);padding:16px;border-radius:8px;border:1px solid var(--border);text-align:center}
        .stat-value{font-size:1.75rem;font-weight:700;color:var(--primary);margin-bottom:4px}
        .stat-label{font-size:0.85rem;color:var(--text-secondary);text-transform:uppercase;letter-spacing:0.5px}
        .client-item{display:flex;justify-content:space-between;align-items:center;padding:14px;background:var(--bg);border-radius:8px;margin-bottom:8px;border:1px solid var(--border);transition:var(--transition)}
        .client-item:hover{background:var(--surface-hover);border-color:var(--primary)}
        .client-info{flex:1;min-width:0}
        .client-name{font-weight:600;margin-bottom:4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
        .client-rate{color:var(--text-secondary);font-size:0.9rem}
        .client-actions{display:flex;gap:6px}
        .history-item{padding:16px;background:var(--bg);border-radius:8px;margin-bottom:12px;border-left:4px solid var(--primary);transition:var(--transition);position:relative}
        .history-item:hover{background:var(--surface-hover);transform:translateX(4px)}
        .history-meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;flex-wrap:wrap;gap:8px}
        .history-client{font-weight:600;color:var(--primary);display:flex;align-items:center;gap:6px}
        .history-date{color:var(--text-secondary);font-size:0.85rem}
        .history-details{display:flex;gap:16px;flex-wrap:wrap;color:var(--text-secondary);font-size:0.9rem;margin-bottom:8px}
        .history-amount{font-size:1.35rem;font-weight:700;color:var(--success);margin-bottom:10px}
        .history-notes{margin:8px 0;padding:8px 12px;background:var(--surface);border-radius:6px;font-size:0.9rem;color:var(--text-secondary);font-style:italic}
        .history-actions{display:flex;gap:6px;justify-content:flex-end;flex-wrap:wrap}
        .empty-state{text-align:center;padding:60px 20px;color:var(--text-secondary)}
        .empty-state i{font-size:4rem;margin-bottom:16px;opacity:0.3}
        .empty-state p{font-size:1.1rem;margin-bottom:8px}
        .empty-state small{font-size:0.9rem;opacity:0.7}
        .badge{display:inline-flex;align-items:center;gap:4px;padding:6px 12px;background:var(--primary-light);border-radius:20px;font-size:0.8rem;font-weight:600;color:var(--primary)}
        .time-helper{font-size:0.8rem;color:var(--text-secondary);margin-top:4px;display:flex;align-items:center;gap:4px}
        .search-box{position:relative;margin-bottom:16px}
        .search-box input{padding-right:40px}
        .search-box i{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:var(--text-secondary);pointer-events:none}
        .full-width{grid-column:1/-1}
        .button-group{display:flex;gap:8px;flex-wrap:wrap}
        .toast-container{position:fixed;top:20px;right:20px;z-index:9999;display:flex;flex-direction:column;gap:12px;max-width:400px}
        .toast{background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:16px;box-shadow:var(--shadow-lg);display:flex;align-items:center;gap:12px;animation:slideIn 0.3s ease-out}
        .toast.success{border-left:4px solid var(--success)}
        .toast.error{border-left:4px solid var(--danger)}
        .toast.info{border-left:4px solid var(--info)}
        .toast i{font-size:1.25rem}
        .toast.success i{color:var(--success)}
        .toast.error i{color:var(--danger)}
        .toast.info i{color:var(--info)}
        .toast-content{flex:1}
        .toast-title{font-weight:600;margin-bottom:2px}
        .toast-message{font-size:0.9rem;color:var(--text-secondary)}
        .toast-close{background:none;border:none;color:var(--text-secondary);cursor:pointer;padding:4px;font-size:1.1rem;line-height:1}
        @keyframes slideIn{from{transform:translateX(400px);opacity:0}to{transform:translateX(0);opacity:1}}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
        .fade-in{animation:fadeIn 0.3s ease-out}
        .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);z-index:1000;display:flex;align-items:center;justify-content:center;padding:20px;animation:fadeIn 0.2s ease-out}
        .modal{background:var(--surface);border-radius:var(--radius);padding:24px;max-width:500px;width:100%;box-shadow:var(--shadow-lg);border:1px solid var(--border)}
        .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
        .modal-header h3{font-size:1.5rem;display:flex;align-items:center;gap:8px}
        .modal-body{margin-bottom:20px}
        .modal-footer{display:flex;gap:12px;justify-content:flex-end}
        @media(max-width:640px){
            .grid{gap:16px}
            .card{padding:16px}
            .result{padding:24px}
            .button-group{flex-direction:column}
            .button-group .btn{width:100%}
            .history-actions{flex-direction:column}
            .history-actions .btn{width:100%}
        }
        .help-section{background:var(--primary-light);padding:16px;border-radius:8px;margin-top:16px;border:1px solid var(--primary);border-left:4px solid var(--primary)}
        .help-section h4{color:var(--primary);margin-bottom:8px;display:flex;align-items:center;gap:6px}
        .help-section ul{margin-left:20px;color:var(--text-secondary);font-size:0.9rem}
        .help-section li{margin-bottom:4px}
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1><i data-lucide="calculator"></i>Hourly Rate Calculator</h1>
        <p>Professional billing calculator with client management & history tracking</p>
        <div class="shortcuts">
            <span class="shortcut-badge"><kbd>Enter</kbd> Save calculation</span>
            <span class="shortcut-badge"><kbd>Ctrl+K</kbd> Focus search</span>
        </div>
    </div>
    <div class="result fade-in" id="resultDisplay">
        <div class="label">Total Amount</div>
        <div class="amount" id="totalAmount">$0.00</div>
        <div class="breakdown">
            <span id="hoursDisplay">0 hours</span>
            <span>×</span>
            <span id="rateDisplay">$0/hr</span>
            <span id="taxDisplay"></span>
        </div>
    </div>
    <div class="summary-stats" id="summaryStats" style="display:none">
        <div class="stat-card">
            <div class="stat-value" id="totalEarnings">$0</div>
            <div class="stat-label">Total Earned</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="totalCalculations">0</div>
            <div class="stat-label">Calculations</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="totalHours">0h</div>
            <div class="stat-label">Total Hours</div>
        </div>
    </div>
    <div class="grid">
        <div class="card">
            <h2><i data-lucide="calculator"></i>Calculator</h2>
            <div class="form-group">
                <label for="clientSelect">
                    <i data-lucide="users"></i>Client (Optional)
                    <span class="tooltip" data-tip="Select a saved client to auto-fill rate"><i data-lucide="help-circle"></i></span>
                </label>
                <select id="clientSelect">
                    <option value="">Select a client...</option>
                </select>
            </div>
            <div class="form-group">
                <label for="hourlyRate">
                    <i data-lucide="dollar-sign"></i>Hourly Rate
                </label>
                <div class="input-wrapper">
                    <span class="input-prefix">$</span>
                    <input type="number" id="hourlyRate" class="with-prefix" placeholder="0.00" step="0.01" min="0" required>
                </div>
            </div>
            <div class="form-group">
                <label for="hoursWorked">
                    <i data-lucide="clock"></i>Hours Worked
                </label>
                <input type="text" id="hoursWorked" placeholder="8 or 8:30 (8.5 hrs)" required>
                <div class="time-helper"><i data-lucide="lightbulb"></i>Enter "8:30" for 8.5 hours or just "8"</div>
            </div>
            <div class="form-group">
                <label for="taxRate">
                    <i data-lucide="percent"></i>Tax/Fee % (Optional)
                    <span class="tooltip" data-tip="Add tax or fees as percentage"><i data-lucide="help-circle"></i></span>
                </label>
                <input type="number" id="taxRate" placeholder="0" step="0.1" min="0" max="100">
            </div>
            <div class="form-group">
                <label for="notes">
                    <i data-lucide="file-text"></i>Notes (Optional)
                </label>
                <textarea id="notes" rows="3" placeholder="Project details, tasks completed, billing notes..."></textarea>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" style="flex:1" onclick="addToHistory()">
                    <i data-lucide="save"></i>Save Calculation
                </button>
                <button class="btn btn-secondary btn-icon" onclick="copyToClipboard()" title="Copy to clipboard">
                    <i data-lucide="copy"></i>
                </button>
                <button class="btn btn-secondary btn-icon" onclick="exportCalculation()" title="Export as text">
                    <i data-lucide="download"></i>
                </button>
            </div>
            <div class="help-section">
                <h4><i data-lucide="info"></i>Quick Tips</h4>
                <ul>
                    <li>Press <kbd>Enter</kbd> anywhere to save calculation</li>
                    <li>Use decimal (8.5) or time format (8:30) for hours</li>
                    <li>Click history items to load and edit them</li>
                    <li>Export creates a text invoice summary</li>
                </ul>
            </div>
        </div>
        <div class="card">
            <h2><i data-lucide="users"></i>Clients</h2>
            <div class="form-group">
                <label for="newClientName">
                    <i data-lucide="user"></i>Client Name
                </label>
                <input type="text" id="newClientName" placeholder="Enter client name">
            </div>
            <div class="form-group">
                <label for="newClientRate">
                    <i data-lucide="dollar-sign"></i>Default Rate
                </label>
                <div class="input-wrapper">
                    <span class="input-prefix">$</span>
                    <input type="number" id="newClientRate" class="with-prefix" placeholder="0.00" step="0.01" min="0">
                </div>
            </div>
            <button class="btn btn-success" style="width:100%;margin-bottom:16px" onclick="addClient()">
                <i data-lucide="plus"></i>Add Client
            </button>
            <div id="clientsList"></div>
        </div>
    </div>
    <div class="card full-width">
        <h2><i data-lucide="history"></i>Calculation History</h2>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;gap:12px;flex-wrap:wrap">
            <span class="badge"><i data-lucide="file-text"></i><span id="historyCount">0 calculations</span></span>
            <div style="display:flex;gap:8px">
                <button class="btn btn-secondary btn-sm" onclick="showSummary()">
                    <i data-lucide="bar-chart"></i>Summary
                </button>
                <button class="btn btn-danger btn-sm" onclick="clearHistory()">
                    <i data-lucide="trash-2"></i>Clear All
                </button>
            </div>
        </div>
        <div class="search-box">
            <input type="text" id="historySearch" placeholder="Search history by client, notes, or amount...">
            <i data-lucide="search"></i>
        </div>
        <div id="historyList"></div>
    </div>
</div>
<div class="toast-container" id="toastContainer"></div>
<script src="https://unpkg.com/lucide@latest"></script>
<script>
    let clients=JSON.parse(localStorage.getItem('clients')||'[]');
    let history=JSON.parse(localStorage.getItem('history')||'[]');
    function parseTimeInput(input){
        if(!input)return 0;
        input=input.trim();
        if(input.includes(':')){
            const[hours,minutes]=input.split(':').map(Number);
            if(isNaN(hours)||isNaN(minutes))return 0;
            return hours+(minutes/60);
        }
        return parseFloat(input)||0;
    }
    function formatCurrency(amount){
        return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD'}).format(amount);
    }
    function formatDate(date){
        const d=new Date(date);
        const now=new Date();
        const diffMs=now-d;
        const diffMins=Math.floor(diffMs/60000);
        const diffHours=Math.floor(diffMs/3600000);
        const diffDays=Math.floor(diffMs/86400000);
        if(diffMins<1)return'Just now';
        if(diffMins<60)return`${diffMins}m ago`;
        if(diffHours<24)return`${diffHours}h ago`;
        if(diffDays<7)return`${diffDays}d ago`;
        return d.toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric',hour:'2-digit',minute:'2-digit'});
    }
    function showToast(title,message,type='info'){
        const container=document.getElementById('toastContainer');
        const toast=document.createElement('div');
        toast.className=`toast ${type} fade-in`;
        const icons={success:'check-circle',error:'alert-circle',info:'info'};
        toast.innerHTML=`
<i data-lucide="${icons[type]}"></i>
<div class="toast-content">
<div class="toast-title">${title}</div>
<div class="toast-message">${message}</div>
</div>
<button class="toast-close" onclick="this.parentElement.remove()">
<i data-lucide="x"></i>
</button>
`;
        container.appendChild(toast);
        lucide.createIcons();
        setTimeout(()=>toast.remove(),5000);
    }
    function validateInputs(){
        const rate=parseFloat(document.getElementById('hourlyRate').value);
        const hours=parseTimeInput(document.getElementById('hoursWorked').value);
        if(!rate||rate<=0){
            document.getElementById('hourlyRate').classList.add('error');
            showToast('Invalid Rate','Please enter a valid hourly rate','error');
            return false;
        }
        if(!hours||hours<=0){
            document.getElementById('hoursWorked').classList.add('error');
            showToast('Invalid Hours','Please enter valid hours worked','error');
            return false;
        }
        document.getElementById('hourlyRate').classList.remove('error');
        document.getElementById('hoursWorked').classList.remove('error');
        return true;
    }
    function calculate(){
        const rate=parseFloat(document.getElementById('hourlyRate').value)||0;
        const hours=parseTimeInput(document.getElementById('hoursWorked').value);
        const taxRate=parseFloat(document.getElementById('taxRate').value)||0;
        const subtotal=rate*hours;
        const taxAmount=subtotal*(taxRate/100);
        const total=subtotal+taxAmount;
        document.getElementById('totalAmount').textContent=formatCurrency(total);
        document.getElementById('hoursDisplay').textContent=`${hours.toFixed(2)} hours`;
        document.getElementById('rateDisplay').textContent=`${formatCurrency(rate)}/hr`;
        document.getElementById('taxDisplay').textContent=taxRate>0?`+ ${taxRate}% tax`:'';
        return{rate,hours,taxRate,subtotal,taxAmount,total};
    }
    function addClient(){
        const name=document.getElementById('newClientName').value.trim();
        const rate=parseFloat(document.getElementById('newClientRate').value)||0;
        if(!name){
            showToast('Missing Name','Please enter a client name','error');
            return;
        }
        if(!rate||rate<=0){
            showToast('Invalid Rate','Please enter a valid hourly rate','error');
            return;
        }
        clients.push({id:Date.now(),name,rate});
        localStorage.setItem('clients',JSON.stringify(clients));
        document.getElementById('newClientName').value='';
        document.getElementById('newClientRate').value='';
        renderClients();
        showToast('Client Added',`${name} added successfully`,'success');
    }
    function deleteClient(id){
        const client=clients.find(c=>c.id===id);
        if(!client)return;
        showModal('Delete Client',`Are you sure you want to delete "${client.name}"?`,()=>{
            clients=clients.filter(c=>c.id!==id);
            localStorage.setItem('clients',JSON.stringify(clients));
            renderClients();
            showToast('Client Deleted',`${client.name} removed`,'success');
        });
    }
    function selectClient(client){
        document.getElementById('clientSelect').value=client.id;
        document.getElementById('hourlyRate').value=client.rate;
        calculate();
        showToast('Client Selected',`${client.name} - ${formatCurrency(client.rate)}/hr`,'info');
    }
    function renderClients(){
        const select=document.getElementById('clientSelect');
        const list=document.getElementById('clientsList');
        select.innerHTML='<option value="">Select a client...</option>';
        clients.forEach(client=>{
            const option=document.createElement('option');
            option.value=client.id;
            option.textContent=`${client.name} (${formatCurrency(client.rate)}/hr)`;
            select.appendChild(option);
        });
        if(clients.length===0){
            list.innerHTML='<div class="empty-state"><i data-lucide="users"></i><p>No clients yet</p><small>Add your first client above!</small></div>';
            lucide.createIcons();
            return;
        }
        list.innerHTML=clients.map(client=>`
<div class="client-item fade-in">
<div class="client-info">
<div class="client-name">${client.name}</div>
<div class="client-rate">${formatCurrency(client.rate)}/hour</div>
</div>
<div class="client-actions">
<button class="btn btn-secondary btn-sm btn-icon" onclick='selectClient(${JSON.stringify(client)})' title="Use this client">
<i data-lucide="arrow-right"></i>
</button>
<button class="btn btn-danger btn-sm btn-icon" onclick="deleteClient(${client.id})" title="Delete client">
<i data-lucide="trash-2"></i>
</button>
</div>
</div>
`).join('');
        lucide.createIcons();
    }
    function addToHistory(){
        if(!validateInputs())return;
        const clientId=document.getElementById('clientSelect').value;
        const clientName=clientId?clients.find(c=>c.id==clientId)?.name:'No Client';
        const notes=document.getElementById('notes').value.trim();
        const calc=calculate();
        history.unshift({
            id:Date.now(),
            date:new Date().toISOString(),
            client:clientName,
            ...calc,
            notes
        });
        if(history.length>100)history=history.slice(0,100);
        localStorage.setItem('history',JSON.stringify(history));
        renderHistory();
        updateSummary();
        document.getElementById('notes').value='';
        showToast('Calculation Saved',`${formatCurrency(calc.total)} saved to history`,'success');
    }
    function loadHistoryItem(id){
        const item=history.find(h=>h.id===id);
        if(!item)return;
        const client=clients.find(c=>c.name===item.client);
        if(client){
            document.getElementById('clientSelect').value=client.id;
        }else{
            document.getElementById('clientSelect').value='';
        }
        document.getElementById('hourlyRate').value=item.rate;
        document.getElementById('hoursWorked').value=item.hours;
        document.getElementById('taxRate').value=item.taxRate||'';
        document.getElementById('notes').value=item.notes||'';
        calculate();
        window.scrollTo({top:0,behavior:'smooth'});
        showToast('Calculation Loaded','Edit and save as new calculation','info');
    }
    function deleteHistoryItem(id){
        const item=history.find(h=>h.id===id);
        if(!item)return;
        showModal('Delete Calculation','Are you sure you want to delete this calculation?',()=>{
            history=history.filter(h=>h.id!==id);
            localStorage.setItem('history',JSON.stringify(history));
            renderHistory();
            updateSummary();
            showToast('Deleted','Calculation removed from history','success');
        });
    }
    function clearHistory(){
        if(history.length===0)return;
        showModal('Clear All History',`Are you sure you want to delete all ${history.length} calculations? This cannot be undone.`,()=>{
            history=[];
            localStorage.setItem('history',JSON.stringify(history));
            renderHistory();
            updateSummary();
            showToast('History Cleared','All calculations deleted','success');
        });
    }
    function filterHistory(){
        const search=document.getElementById('historySearch').value.toLowerCase();
        const filtered=history.filter(item=>{
            return item.client.toLowerCase().includes(search)||
                (item.notes&&item.notes.toLowerCase().includes(search))||
                formatCurrency(item.total).toLowerCase().includes(search);
        });
        renderFilteredHistory(filtered);
    }
    function renderFilteredHistory(filtered){
        const list=document.getElementById('historyList');
        if(filtered.length===0){
            list.innerHTML='<div class="empty-state"><i data-lucide="search-x"></i><p>No matching calculations</p><small>Try a different search term</small></div>';
            lucide.createIcons();
            return;
        }
        list.innerHTML=filtered.map(item=>`
<div class="history-item fade-in" onclick="loadHistoryItem(${item.id})" style="cursor:pointer">
<div class="history-meta">
<span class="history-client"><i data-lucide="user"></i>${item.client}</span>
<span class="history-date"><i data-lucide="clock"></i>${formatDate(item.date)}</span>
</div>
<div class="history-details">
<span><i data-lucide="clock"></i>${item.hours.toFixed(2)} hours</span>
<span><i data-lucide="dollar-sign"></i>${formatCurrency(item.rate)}/hr</span>
${item.taxRate>0?`<span><i data-lucide="percent"></i>${item.taxRate}% tax</span>`:''}
</div>
${item.notes?`<div class="history-notes"><i data-lucide="file-text"></i>${item.notes}</div>`:''}
<div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
<div class="history-amount">${formatCurrency(item.total)}</div>
<div class="history-actions">
<button class="btn btn-secondary btn-sm" onclick="event.stopPropagation();loadHistoryItem(${item.id})" title="Load this calculation">
<i data-lucide="edit"></i>Edit
</button>
<button class="btn btn-secondary btn-sm" onclick="event.stopPropagation();copyHistoryItem(${item.id})" title="Copy to clipboard">
<i data-lucide="copy"></i>Copy
</button>
<button class="btn btn-danger btn-sm" onclick="event.stopPropagation();deleteHistoryItem(${item.id})" title="Delete">
<i data-lucide="trash-2"></i>
</button>
</div>
</div>
</div>
`).join('');
        lucide.createIcons();
    }
    function renderHistory(){
        const list=document.getElementById('historyList');
        document.getElementById('historyCount').textContent=`${history.length} calculation${history.length!==1?'s':''}`;
        if(history.length===0){
            list.innerHTML='<div class="empty-state"><i data-lucide="file-text"></i><p>No calculations yet</p><small>Save your first calculation above!</small></div>';
            document.getElementById('summaryStats').style.display='none';
            lucide.createIcons();
            return;
        }
        renderFilteredHistory(history);
    }
    function updateSummary(){
        if(history.length===0){
            document.getElementById('summaryStats').style.display='none';
            return;
        }
        document.getElementById('summaryStats').style.display='grid';
        const totalEarnings=history.reduce((sum,item)=>sum+item.total,0);
        const totalHours=history.reduce((sum,item)=>sum+item.hours,0);
        document.getElementById('totalEarnings').textContent=formatCurrency(totalEarnings);
        document.getElementById('totalCalculations').textContent=history.length;
        document.getElementById('totalHours').textContent=`${totalHours.toFixed(1)}h`;
    }
    function showSummary(){
        const totalEarnings=history.reduce((sum,item)=>sum+item.total,0);
        const totalHours=history.reduce((sum,item)=>sum+item.hours,0);
        const avgRate=totalHours>0?totalEarnings/totalHours:0;
        const clientSummary={};
        history.forEach(item=>{
            if(!clientSummary[item.client]){
                clientSummary[item.client]={total:0,hours:0,count:0};
            }
            clientSummary[item.client].total+=item.total;
            clientSummary[item.client].hours+=item.hours;
            clientSummary[item.client].count++;
        });
        let summaryHTML='<div style="margin-bottom:20px">';
        summaryHTML+=`<h4 style="margin-bottom:12px">Overall Summary</h4>`;
        summaryHTML+=`<p><strong>Total Earnings:</strong> ${formatCurrency(totalEarnings)}</p>`;
        summaryHTML+=`<p><strong>Total Hours:</strong> ${totalHours.toFixed(2)} hours</p>`;
        summaryHTML+=`<p><strong>Average Rate:</strong> ${formatCurrency(avgRate)}/hr</p>`;
        summaryHTML+=`<p><strong>Total Calculations:</strong> ${history.length}</p>`;
        summaryHTML+='</div>';
        if(Object.keys(clientSummary).length>0){
            summaryHTML+=`<h4 style="margin-bottom:12px">By Client</h4>`;
            summaryHTML+='<div style="max-height:300px;overflow-y:auto">';
            Object.entries(clientSummary).sort((a,b)=>b[1].total-a[1].total).forEach(([client,data])=>{
                summaryHTML+=`<div style="padding:12px;background:var(--bg);border-radius:8px;margin-bottom:8px">`;
                summaryHTML+=`<strong>${client}</strong><br>`;
                summaryHTML+=`<small>Total: ${formatCurrency(data.total)} | Hours: ${data.hours.toFixed(2)} | Count: ${data.count}</small>`;
                summaryHTML+='</div>';
            });
            summaryHTML+='</div>';
        }
        showModal('Summary Report',summaryHTML);
    }
    function copyToClipboard(){
        if(!validateInputs())return;
        const calc=calculate();
        const clientId=document.getElementById('clientSelect').value;
        const clientName=clientId?clients.find(c=>c.id==clientId)?.name:'N/A';
        const notes=document.getElementById('notes').value.trim();
        let text=`BILLING CALCULATION\n`;
        text+=`Client: ${clientName}\n`;
        text+=`Hours: ${calc.hours.toFixed(2)}\n`;
        text+=`Rate: ${formatCurrency(calc.rate)}/hr\n`;
        text+=`Subtotal: ${formatCurrency(calc.subtotal)}\n`;
        if(calc.taxRate>0)text+=`Tax (${calc.taxRate}%): ${formatCurrency(calc.taxAmount)}\n`;
        text+=`TOTAL: ${formatCurrency(calc.total)}`;
        if(notes)text+=`\nNotes: ${notes}`;
        navigator.clipboard.writeText(text).then(()=>{
            showToast('Copied','Calculation copied to clipboard','success');
        }).catch(()=>{
            showToast('Failed','Could not copy to clipboard','error');
        });
    }
    function copyHistoryItem(id){
        const item=history.find(h=>h.id===id);
        if(!item)return;
        let text=`BILLING CALCULATION\n`;
        text+=`Client: ${item.client}\n`;
        text+=`Date: ${formatDate(item.date)}\n`;
        text+=`Hours: ${item.hours.toFixed(2)}\n`;
        text+=`Rate: ${formatCurrency(item.rate)}/hr\n`;
        text+=`Subtotal: ${formatCurrency(item.subtotal)}\n`;
        if(item.taxRate>0)text+=`Tax (${item.taxRate}%): ${formatCurrency(item.taxAmount)}\n`;
        text+=`TOTAL: ${formatCurrency(item.total)}`;
        if(item.notes)text+=`\nNotes: ${item.notes}`;
        navigator.clipboard.writeText(text).then(()=>{
            showToast('Copied','Calculation copied to clipboard','success');
        }).catch(()=>{
            showToast('Failed','Could not copy to clipboard','error');
        });
    }
    function exportCalculation(){
        if(!validateInputs())return;
        const calc=calculate();
        const clientId=document.getElementById('clientSelect').value;
        const clientName=clientId?clients.find(c=>c.id==clientId)?.name:'N/A';
        const notes=document.getElementById('notes').value.trim();
        const date=new Date().toLocaleString();
        let text=`INVOICE CALCULATION\n${'='.repeat(50)}\n\n`;
        text+=`Generated: ${date}\n`;
        text+=`Client: ${clientName}\n\n`;
        text+=`CALCULATION DETAILS\n${'-'.repeat(50)}\n`;
        text+=`Hours Worked: ${calc.hours.toFixed(2)}\n`;
        text+=`Hourly Rate: ${formatCurrency(calc.rate)}\n`;
        text+=`Subtotal: ${formatCurrency(calc.subtotal)}\n`;
        if(calc.taxRate>0){
            text+=`Tax/Fee (${calc.taxRate}%): ${formatCurrency(calc.taxAmount)}\n`;
        }
        text+=`\nTOTAL AMOUNT: ${formatCurrency(calc.total)}\n`;
        if(notes){
            text+=`\nNOTES\n${'-'.repeat(50)}\n${notes}\n`;
        }
        text+=`\n${'='.repeat(50)}\n`;
        text+=`Generated by Hourly Rate Calculator\n`;
        const blob=new Blob([text],{type:'text/plain'});
        const url=URL.createObjectURL(blob);
        const a=document.createElement('a');
        a.href=url;
        a.download=`invoice-${clientName.replace(/\s+/g,'-')}-${Date.now()}.txt`;
        a.click();
        URL.revokeObjectURL(url);
        showToast('Exported','Invoice downloaded','success');
    }
    function showModal(title,content,onConfirm=null){
        const overlay=document.createElement('div');
        overlay.className='modal-overlay';
        overlay.innerHTML=`
<div class="modal">
<div class="modal-header">
<h3><i data-lucide="alert-circle"></i>${title}</h3>
<button class="btn btn-secondary btn-icon" onclick="this.closest('.modal-overlay').remove()">
<i data-lucide="x"></i>
</button>
</div>
<div class="modal-body">${content}</div>
<div class="modal-footer">
<button class="btn btn-secondary" onclick="this.closest('.modal-overlay').remove()">Cancel</button>
${onConfirm?'<button class="btn btn-primary" id="modalConfirm">Confirm</button>':'<button class="btn btn-primary" onclick="this.closest(\'.modal-overlay\').remove()">OK</button>'}
</div>
</div>
`;
        document.body.appendChild(overlay);
        lucide.createIcons();
        if(onConfirm){
            document.getElementById('modalConfirm').onclick=()=>{
                onConfirm();
                overlay.remove();
            };
        }
        overlay.onclick=(e)=>{
            if(e.target===overlay)overlay.remove();
        };
    }
    document.getElementById('hourlyRate').addEventListener('input',calculate);
    document.getElementById('hoursWorked').addEventListener('input',calculate);
    document.getElementById('taxRate').addEventListener('input',calculate);
    document.getElementById('clientSelect').addEventListener('change',function(){
        const clientId=this.value;
        if(clientId){
            const client=clients.find(c=>c.id==clientId);
            if(client){
                document.getElementById('hourlyRate').value=client.rate;
                calculate();
            }
        }
    });
    document.getElementById('historySearch').addEventListener('input',filterHistory);
    document.addEventListener('keydown',(e)=>{
        if(e.key==='Enter'&&!e.shiftKey&&!e.ctrlKey&&document.activeElement.tagName!=='TEXTAREA'){
            e.preventDefault();
            addToHistory();
        }
        if(e.ctrlKey&&e.key==='k'){
            e.preventDefault();
            document.getElementById('historySearch').focus();
        }
    });
    renderClients();
    renderHistory();
    updateSummary();
    calculate();
    lucide.createIcons();
    showToast('Welcome','Hourly Rate Calculator loaded','success');
</script>
<script src="../logo.js"></script>
</body>
</html>