<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <link rel="icon"
          href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⏱️</text></svg>">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
          content="Estimate reading time for your text with our Reading Time Estimator tool. Adjust words per minute, analyze readability, and get detailed text statistics.">
    <meta name="keywords"
          content="reading time, estimator, words per minute, text analysis, readability, Flesch-Kincaid">
    <title>Reading Time Estimator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = {
        darkMode: 'class',
        theme: {
            extend: {
                colors: {
                    brand: {
                        50: '#f0f9ff',
                        100: '#e0f2fe',
                        200: '#bae6fd',
                        300: '#7dd3fc',
                        400: '#38bdf8',
                        500: '#0ea5e9',
                        600: '#0284c7',
                        700: '#0369a1',
                        800: '#075985',
                        900: '#0c4a6e'
                    }
                }
            }
        }
    };</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .tooltip {
            visibility: hidden;
            position: absolute;
            z-index: 10;
        }

        .has-tooltip:hover .tooltip {
            visibility: visible;
        }

        input[type=range]::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #0ea5e9;
            cursor: pointer;
            transition: all .15s ease-in-out;
        }

        input[type=range]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .prose p {
            margin-bottom: 0.5rem;
        }

        .animate-fade-in {
            animation: fadeIn .3s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .animate-slide-up {
            animation: slideUp .3s ease-in-out;
        }

        @keyframes slideUp {
            from {
                transform: translateY(10px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen transition-colors duration-200">
<!-- Theme Toggle -->
<div class="fixed top-4 right-4 z-10">
    <button id="themeToggle"
            class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-brand-500 transition-colors">
        <i class="fas fa-sun dark:hidden"></i>
        <i class="fas fa-moon hidden dark:block"></i>
    </button>
</div>

<div class="container mx-auto max-w-4xl p-4 md:p-6">
    <header class="bg-gradient-to-r from-brand-600 to-brand-800 rounded-t-xl p-6 md:p-8 text-white mb-0">
        <div class="flex items-center justify-between">
            <h1 class="text-2xl md:text-3xl font-bold flex items-center"><i class="fas fa-book-reader mr-3"></i>Reading
                Time Estimator</h1>
            <button id="showHelp" class="text-sm text-brand-100 hover:text-white transition flex items-center">
                <i class="fas fa-question-circle mr-1"></i> Help
            </button>
        </div>
        <p class="mt-2 text-brand-100 max-w-2xl">Analyze your text to estimate reading time, assess readability, and get
            detailed statistics.</p>
    </header>

    <main class="bg-white dark:bg-gray-800 p-6 rounded-b-xl shadow-lg">
        <!-- Tab Navigation -->
        <div class="border-b border-gray-200 dark:border-gray-700 mb-6">
            <ul class="flex flex-wrap -mb-px text-sm font-medium">
                <li class="mr-2">
                    <button class="tab-btn active inline-block p-4 border-b-2 border-brand-500 text-brand-600 dark:text-brand-400 rounded-t-lg"
                            data-tab="editor">
                        <i class="fas fa-edit mr-2"></i>Text Editor
                    </button>
                </li>
                <li class="mr-2">
                    <button class="tab-btn inline-block p-4 border-b-2 border-transparent hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300"
                            data-tab="results">
                        <i class="fas fa-chart-bar mr-2"></i>Analysis Results
                    </button>
                </li>
                <li class="mr-2">
                    <button class="tab-btn inline-block p-4 border-b-2 border-transparent hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300"
                            data-tab="history">
                        <i class="fas fa-history mr-2"></i>History
                    </button>
                </li>
            </ul>
        </div>

        <!-- Editor Tab -->
        <div id="editor-tab" class="tab-content">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <label for="input" class="text-sm font-medium text-gray-700 dark:text-gray-300">Your Text:</label>
                    <div class="flex space-x-2">
                        <button id="clearText" class="text-sm text-gray-500 dark:text-gray-400 hover:text-brand-500"><i
                                class="fas fa-trash-alt mr-1"></i> Clear
                        </button>
                        <button id="paste" class="text-sm text-gray-500 dark:text-gray-400 hover:text-brand-500"><i
                                class="fas fa-paste mr-1"></i> Paste
                        </button>
                        <button id="sampleText" class="text-sm text-gray-500 dark:text-gray-400 hover:text-brand-500"><i
                                class="fas fa-file-alt mr-1"></i> Sample
                        </button>
                    </div>
                </div>
                <div class="relative">
                    <textarea id="input"
                              class="w-full rounded-lg border-gray-200 dark:border-gray-700 shadow-sm focus:border-brand-500 focus:ring-brand-500 dark:bg-gray-700 dark:text-white transition-colors duration-200 p-4 text-sm md:text-base h-48"
                              placeholder="Enter or paste your text here..."></textarea>
                    <div id="charCount"
                         class="absolute bottom-2 right-3 text-xs text-gray-400 dark:text-gray-500"></div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Reading Speed</label>
                    <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                        <div class="flex items-center justify-between mb-1">
                            <span class="text-xs text-gray-500 dark:text-gray-400">Slow</span>
                            <output id="wpmDisplay" class="text-sm font-medium text-brand-600 dark:text-brand-400">250
                                WPM
                            </output>
                            <span class="text-xs text-gray-500 dark:text-gray-400">Fast</span>
                        </div>
                        <input type="range" id="readingSpeed" min="100" max="700" step="25" value="250"
                               class="w-full h-2 bg-gray-300 dark:bg-gray-600 rounded-lg appearance-none cursor-pointer">
                        <div class="mt-2 text-xs text-gray-500 dark:text-gray-400 text-center" id="speedDescription">
                            Average reader
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Advanced
                        Settings</label>
                    <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                        <div class="mb-3">
                            <label for="readerProfile" class="block text-xs text-gray-500 dark:text-gray-400 mb-1">Reader
                                Profile</label>
                            <select id="readerProfile"
                                    class="w-full rounded border-gray-200 dark:border-gray-600 shadow-sm focus:border-brand-500 focus:ring-brand-500 sm:text-sm dark:bg-gray-800 dark:text-white">
                                <option value="1">General Audience</option>
                                <option value="0.85">Advanced Reader</option>
                                <option value="1.2">English as Second Language</option>
                                <option value="1.4">Children (8-12)</option>
                            </select>
                        </div>
                        <div>
                            <label for="textComplexity" class="block text-xs text-gray-500 dark:text-gray-400 mb-1">Content
                                Type</label>
                            <select id="textComplexity"
                                    class="w-full rounded border-gray-200 dark:border-gray-600 shadow-sm focus:border-brand-500 focus:ring-brand-500 sm:text-sm dark:bg-gray-800 dark:text-white">
                                <option value="1">Standard Text</option>
                                <option value="1.1">Technical Documentation</option>
                                <option value="0.9">Conversational Content</option>
                                <option value="1.3">Academic/Scientific</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <button id="analyze-button"
                    class="w-full bg-brand-600 hover:bg-brand-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                <i class="fas fa-calculator mr-2"></i> Analyze Text
            </button>

            <div id="quick-results" class="mt-6 hidden animate-fade-in">
                <div class="bg-brand-50 dark:bg-gray-700 p-4 rounded-lg border border-brand-200 dark:border-gray-600">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-medium text-brand-800 dark:text-brand-300">Quick Results:</h3>
                        <button id="view-detailed"
                                class="text-sm text-brand-600 dark:text-brand-400 hover:text-brand-800 dark:hover:text-brand-300">
                            View Detailed Results <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                    <div class="mt-3 grid grid-cols-2 md:grid-cols-4 gap-4 items-end">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-brand-600 dark:text-brand-400" id="quick-time">-</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Reading Time</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-brand-600 dark:text-brand-400" id="quick-words">-</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Word Count</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-brand-600 dark:text-brand-400" id="quick-readability">
                                -
                            </div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Readability</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-brand-600 dark:text-brand-400" id="quick-grade">-</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Grade Level</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Tab -->
        <div id="results-tab" class="tab-content hidden animate-slide-up">
            <div id="results-empty" class="text-center py-12">
                <i class="fas fa-chart-bar text-5xl text-gray-300 dark:text-gray-600 mb-4"></i>
                <p class="text-gray-500 dark:text-gray-400">No analysis results yet. Analyze text to see detailed
                    metrics.</p>
            </div>

            <div id="results-content" class="hidden">
                <div class="flex flex-col md:flex-row md:justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">Analysis Results</h2>
                    <div class="flex space-x-2">
                        <button id="save-analysis"
                                class="text-sm bg-brand-100 dark:bg-brand-900 text-brand-700 dark:text-brand-300 hover:bg-brand-200 dark:hover:bg-brand-800 px-3 py-1 rounded flex items-center">
                            <i class="fas fa-save mr-1"></i> Save
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-5 border border-gray-100 dark:border-gray-700">
                        <h3 class="text-lg font-medium mb-4 text-brand-700 dark:text-brand-300">Reading Time</h3>
                        <div class="flex items-center mb-4">
                            <div class="w-16 h-16 rounded-full bg-brand-100 dark:bg-brand-900 flex items-center justify-center mr-4">
                                <i class="fas fa-stopwatch text-2xl text-brand-600 dark:text-brand-400"></i>
                            </div>
                            <div>
                                <div class="text-3xl font-bold text-gray-800 dark:text-white" id="reading-time">-</div>
                                <div class="text-sm text-gray-500 dark:text-gray-400" id="reading-speed-display">at 250
                                    WPM
                                </div>
                            </div>
                        </div>
                        <div class="mt-2 text-sm text-gray-600 dark:text-gray-400">
                            <div class="flex justify-between mb-1">
                                <span>Speed Reader (450 WPM):</span>
                                <span id="speed-reader-time">-</span>
                            </div>
                            <div class="flex justify-between mb-1">
                                <span>Slow Reader (150 WPM):</span>
                                <span id="slow-reader-time">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-5 border border-gray-100 dark:border-gray-700">
                        <h3 class="text-lg font-medium mb-4 text-brand-700 dark:text-brand-300">Text Statistics</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <div class="text-2xl font-bold text-gray-800 dark:text-white" id="word-count">-</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">Words</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-gray-800 dark:text-white" id="char-count">-</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">Characters</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-gray-800 dark:text-white" id="sentence-count">-
                                </div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">Sentences</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-gray-800 dark:text-white" id="paragraph-count">-
                                </div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">Paragraphs</div>
                            </div>
                        </div>
                        <div class="mt-4 text-sm text-gray-600 dark:text-gray-400">
                            <div class="flex justify-between mb-1">
                                <span>Avg. words per sentence:</span>
                                <span id="avg-words-sentence">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Avg. characters per word:</span>
                                <span id="avg-chars-word">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-5 border border-gray-100 dark:border-gray-700 md:col-span-2">
                        <h3 class="text-lg font-medium mb-4 text-brand-700 dark:text-brand-300">Readability</h3>
                        <div>
                            <canvas id="readabilityChart" height="200"></canvas>
                        </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-5 border border-gray-100 dark:border-gray-700">
                        <h3 class="text-lg font-medium mb-4 text-brand-700 dark:text-brand-300">Grade Level</h3>
                        <div class="mb-4 text-center">
                            <div class="text-5xl font-bold text-gray-800 dark:text-white" id="grade-level">-</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400 mt-1">FKGL Grade</div>
                        </div>
                        <div id="grade-explanation"
                             class="text-sm text-gray-600 dark:text-gray-400 p-3 bg-gray-50 dark:bg-gray-700 rounded">
                            -
                        </div>
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-5 border border-gray-100 dark:border-gray-700 mb-6">
                    <h3 class="text-lg font-medium mb-4 text-brand-700 dark:text-brand-300">Key Insights</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="text-md font-medium mb-2 text-gray-700 dark:text-gray-300">Top Keywords</h4>
                            <div id="keywords" class="flex flex-wrap gap-2"></div>
                        </div>
                        <div>
                            <h4 class="text-md font-medium mb-2 text-gray-700 dark:text-gray-300">Recommendations</h4>
                            <ul id="recommendations"
                                class="list-disc pl-5 text-sm text-gray-600 dark:text-gray-400 space-y-1"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- History Tab -->
        <div id="history-tab" class="tab-content hidden animate-slide-up">
            <div id="history-empty" class="text-center py-12">
                <i class="fas fa-history text-5xl text-gray-300 dark:text-gray-600 mb-4"></i>
                <p class="text-gray-500 dark:text-gray-400">No saved analyses yet. Save your analyses to compare them
                    later.</p>
            </div>

            <div id="history-content" class="hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white">Saved Analyses</h2>
                    <button id="clear-history" class="text-sm text-red-500 hover:text-red-700">
                        <i class="fas fa-trash-alt mr-1"></i> Clear All
                    </button>
                </div>

                <div id="history-list" class="space-y-3">
                    <!-- History items will be added here dynamically -->
                </div>
            </div>
        </div>
    </main>
</div>

<!-- Help Modal -->
<div id="helpModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
        <div class="p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
            <h2 class="text-xl font-bold text-gray-800 dark:text-white">How to Use Reading Time Estimator</h2>
            <button id="closeHelp" class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <div class="p-6 prose dark:prose-invert max-w-none">
            <p>The Reading Time Estimator helps you analyze your text to determine how long it will take to read, assess
                readability, and get detailed statistics.</p>

            <h3>Getting Started</h3>
            <ol>
                <li>Paste your text into the editor or use the sample text button.</li>
                <li>Adjust the reading speed slider to match your target audience.</li>
                <li>Select appropriate reader profile and content type from advanced settings.</li>
                <li>Click "Analyze Text" to process your content.</li>
            </ol>

            <h3>Understanding Results</h3>
            <p>The analysis provides several key metrics:</p>
            <ul>
                <li><strong>Reading Time:</strong> Estimated time to read the text at the selected speed.</li>
                <li><strong>Text Statistics:</strong> Word count, character count, sentence count, etc.</li>
                <li><strong>Readability Scores:</strong>
                    <ul>
                        <li><strong>Flesch Reading Ease:</strong> Higher scores (70-100) indicate easier reading, while
                            lower scores (0-30) indicate difficult text.
                        </li>
                        <li><strong>Flesch-Kincaid Grade Level:</strong> Corresponds to US grade level required to
                            understand the text.
                        </li>
                        <li><strong>SMOG Index:</strong> Estimates the years of education needed to understand the text.
                        </li>
                        <li><strong>Automated Readability Index (ARI):</strong> Another grade-level metric using
                            characters per word.
                        </li>
                    </ul>
                </li>
                <li><strong>Keywords:</strong> Most frequently used meaningful words in your text.</li>
            </ul>

            <h3>Tips for Better Content</h3>
            <ul>
                <li>Aim for a reading ease score of 60-70 for general audiences.</li>
                <li>Keep sentences shorter (15-20 words) for better readability.</li>
                <li>Use simpler words when possible to improve understanding.</li>
                <li>Break up long paragraphs to make content more scannable.</li>
            </ul>
        </div>
    </div>
</div>

<script>
    // Initialize state
    let currentAnalysis = null;
    let analysisHistory = JSON.parse(localStorage.getItem('readingTimeHistory') || '[]');
    let readabilityChart = null;
    const defaultText = "The Internet is a global network of interconnected computers that has revolutionized the way we communicate, access information, and conduct business. It was developed in the late 1960s as a project of the United States Department of Defense, originally called ARPANET. Today, the Internet connects billions of devices worldwide, enabling instant communication, information sharing, and a wide range of online services. Key technologies that power the Internet include TCP/IP protocols, the World Wide Web, and various applications like email, social media, and streaming platforms. As the Internet continues to evolve, it faces challenges related to privacy, security, and equal access, while also presenting new opportunities in areas such as artificial intelligence, the Internet of Things, and virtual reality.";

    // Check for dark mode preference
    if (localStorage.getItem('darkMode') === 'true' || (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
    }

    // DOM Elements
    const input = document.getElementById('input');
    const readingSpeedSlider = document.getElementById('readingSpeed');
    const wpmDisplay = document.getElementById('wpmDisplay');
    const speedDescription = document.getElementById('speedDescription');
    const charCount = document.getElementById('charCount');
    const analyzeButton = document.getElementById('analyze-button');
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');

    // Event Listeners
    document.addEventListener('DOMContentLoaded', () => {
        input.value = defaultText;
        updateCharCount();
        renderHistory();
    });

    // Theme toggle
    document.getElementById('themeToggle').addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
        localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
    });

    // Tab navigation
    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            tabButtons.forEach(btn => btn.classList.remove('active', 'border-brand-500', 'text-brand-600', 'dark:text-brand-400'));
            button.classList.add('active', 'border-brand-500', 'text-brand-600', 'dark:text-brand-400');

            tabContents.forEach(content => content.classList.add('hidden'));
            document.getElementById(`${button.dataset.tab}-tab`).classList.remove('hidden');
        });
    });

    // Input field character counter
    input.addEventListener('input', updateCharCount);

    function updateCharCount() {
        const count = input.value.length;
        charCount.textContent = `${count} characters`;
    }

    // Reading speed slider
    readingSpeedSlider.addEventListener('input', updateSpeedDisplay);

    function updateSpeedDisplay() {
        const value = readingSpeedSlider.value;
        wpmDisplay.textContent = `${value} WPM`;

        let description;
        if (value < 200) description = "Slow reader";
        else if (value < 300) description = "Average reader";
        else if (value < 450) description = "Fast reader";
        else description = "Speed reader";

        speedDescription.textContent = description;
    }

    // Text utility buttons
    document.getElementById('clearText').addEventListener('click', () => {
        input.value = '';
        updateCharCount();
        document.getElementById('quick-results').classList.add('hidden');
    });

    document.getElementById('paste').addEventListener('click', async () => {
        try {
            const text = await navigator.clipboard.readText();
            input.value = text;
            updateCharCount();
        } catch (err) {
            alert('Unable to access clipboard. Please paste manually.');
        }
    });

    document.getElementById('sampleText').addEventListener('click', () => {
        input.value = defaultText;
        updateCharCount();
    });

    // Help modal
    document.getElementById('showHelp').addEventListener('click', () => {
        document.getElementById('helpModal').classList.remove('hidden');
    });

    document.getElementById('closeHelp').addEventListener('click', () => {
        document.getElementById('helpModal').classList.add('hidden');
    });

    // View detailed results button
    document.getElementById('view-detailed').addEventListener('click', () => {
        document.querySelector('[data-tab="results"]').click();
    });

    // Save analysis button
    document.getElementById('save-analysis').addEventListener('click', () => {
        if (!currentAnalysis) return;

        // Add timestamp and preview text
        currentAnalysis.timestamp = new Date().toISOString();
        currentAnalysis.preview = currentAnalysis.text.substring(0, 100) + (currentAnalysis.text.length > 100 ? '...' : '');

        // Save to history
        analysisHistory.unshift(currentAnalysis);
        if (analysisHistory.length > 10) analysisHistory.pop(); // Keep only 10 most recent
        localStorage.setItem('readingTimeHistory', JSON.stringify(analysisHistory));

        // Update history tab
        renderHistory();
        alert('Analysis saved to history!');
    });

    // Clear history button
    document.getElementById('clear-history').addEventListener('click', () => {
        if (confirm('Are you sure you want to clear all saved analyses?')) {
            analysisHistory = [];
            localStorage.setItem('readingTimeHistory', JSON.stringify(analysisHistory));
            renderHistory();
        }
    });

    // Text analysis
    analyzeButton.addEventListener('click', analyzeText);

    function analyzeText() {
        const text = input.value.trim();
        if (!text) {
            alert("Please enter some text to analyze.");
            return;
        }

        const wpm = parseInt(readingSpeedSlider.value);
        const readerProfile = parseFloat(document.getElementById('readerProfile').value);
        const contentType = parseFloat(document.getElementById('textComplexity').value);

        // Text statistics
        const wordCount = text.split(/\s+/).filter(word => word.length > 0).length;
        const charCount = text.length;
        const sentences = text.split(/[.!?]+\s/).filter(s => s.length > 0);
        const sentenceCount = sentences.length;
        const paragraphCount = text.split(/\n+/).filter(p => p.trim().length > 0).length || 1;
        const avgWordsPerSentence = wordCount / sentenceCount;
        const avgCharsPerWord = charCount / wordCount;

        // Reading time calculation
        const readingTimeMinutes = (wordCount / wpm) * readerProfile * contentType;
        const speedReaderTime = (wordCount / 450) * readerProfile * contentType;
        const slowReaderTime = (wordCount / 150) * readerProfile * contentType;

        // Readability metrics
        const syllableCount = countSyllables(text);
        const complexWords = countComplexWords(text);

        const fleschReadingEase = 206.835 - 1.015 * avgWordsPerSentence - 84.6 * (syllableCount / wordCount);
        const fleschKincaidGrade = 0.39 * avgWordsPerSentence + 11.8 * (syllableCount / wordCount) - 15.59;
        const smogIndex = 1.0430 * Math.sqrt(complexWords * (30 / sentenceCount)) + 3.1291;
        const automatedReadabilityIndex = 4.71 * (charCount / wordCount) + 0.5 * avgWordsPerSentence - 21.43;

        // Store current analysis
        currentAnalysis = {
            text,
            wordCount,
            charCount,
            sentenceCount,
            paragraphCount,
            avgWordsPerSentence,
            avgCharsPerWord,
            readingTimeMinutes,
            speedReaderTime,
            slowReaderTime,
            wpm,
            fleschReadingEase,
            fleschKincaidGrade,
            smogIndex,
            automatedReadabilityIndex,
            keywords: extractKeywords(text)
        };

        // Update quick results
        document.getElementById('quick-time').textContent = formatTime(readingTimeMinutes);
        document.getElementById('quick-words').textContent = wordCount.toLocaleString();
        document.getElementById('quick-readability').textContent = getReadabilityLevel(fleschReadingEase);
        document.getElementById('quick-grade').textContent = Math.round(fleschKincaidGrade);
        document.getElementById('quick-results').classList.remove('hidden');

        // Update detailed results
        document.getElementById('reading-time').textContent = formatTime(readingTimeMinutes);
        document.getElementById('reading-speed-display').textContent = `at ${wpm} WPM`;
        document.getElementById('speed-reader-time').textContent = formatTime(speedReaderTime);
        document.getElementById('slow-reader-time').textContent = formatTime(slowReaderTime);

        document.getElementById('word-count').textContent = wordCount.toLocaleString();
        document.getElementById('char-count').textContent = charCount.toLocaleString();
        document.getElementById('sentence-count').textContent = sentenceCount;
        document.getElementById('paragraph-count').textContent = paragraphCount;
        document.getElementById('avg-words-sentence').textContent = avgWordsPerSentence.toFixed(1);
        document.getElementById('avg-chars-word').textContent = avgCharsPerWord.toFixed(1);

        document.getElementById('grade-level').textContent = Math.round(fleschKincaidGrade);
        document.getElementById('grade-explanation').textContent = getGradeExplanation(fleschKincaidGrade);

        // Update readability chart
        updateReadabilityChart(fleschReadingEase, fleschKincaidGrade, smogIndex, automatedReadabilityIndex);

        // Display keywords
        displayKeywords(currentAnalysis.keywords);

        // Generate recommendations
        generateRecommendations(currentAnalysis);

        // Show results
        document.getElementById('results-empty').classList.add('hidden');
        document.getElementById('results-content').classList.remove('hidden');
    }

    function formatTime(minutes) {
        if (minutes < 1) return `${Math.round(minutes * 60)} seconds`;
        if (minutes < 60) {
            const mins = Math.floor(minutes);
            const secs = Math.round((minutes - mins) * 60);
            return secs > 0 ? `${mins} min ${secs} sec` : `${mins} min`;
        }
        const hours = Math.floor(minutes / 60);
        const mins = Math.round(minutes % 60);
        return mins > 0 ? `${hours} hr ${mins} min` : `${hours} hr`;
    }

    function getReadabilityLevel(score) {
        if (score >= 90) return "Very Easy";
        if (score >= 80) return "Easy";
        if (score >= 70) return "Fairly Easy";
        if (score >= 60) return "Standard";
        if (score >= 50) return "Fairly Difficult";
        if (score >= 30) return "Difficult";
        return "Very Difficult";
    }

    function getGradeExplanation(grade) {
        const roundedGrade = Math.round(grade);
        if (roundedGrade <= 6) return "Elementary school level - easily understood by most readers.";
        if (roundedGrade <= 8) return "Middle school level - appropriate for general audience.";
        if (roundedGrade <= 12) return "High school level - somewhat challenging for general readers.";
        if (roundedGrade <= 16) return "College level - may require domain knowledge or advanced vocabulary.";
        return "Graduate level - complex text that requires specialized knowledge.";
    }

    function countSyllables(text) {
        const words = text.toLowerCase().match(/\b\w+\b/g) || [];
        return words.reduce((count, word) => {
            if (word.length <= 3) return count + 1;

            word = word.replace(/(?:[^laeiouy]es|ed|[^laeiouy]e)$/, '');
            word = word.replace(/^y/, '');
            const syllableMatches = word.match(/[aeiouy]{1,2}/g);
            return count + ((syllableMatches && syllableMatches.length) || 1);
        }, 0);
    }

    function countComplexWords(text) {
        const words = text.toLowerCase().match(/\b\w+\b/g) || [];
        let complexCount = 0;

        for (const word of words) {
            if (countWordSyllables(word) > 2) {
                complexCount++;
            }
        }

        return complexCount;
    }

    function countWordSyllables(word) {
        if (word.length <= 3) return 1;

        word = word.toLowerCase()
            .replace(/(?:[^laeiouy]es|ed|[^laeiouy]e)$/, '')
            .replace(/^y/, '');

        const syllableMatches = word.match(/[aeiouy]{1,2}/g);
        return (syllableMatches && syllableMatches.length) || 1;
    }

    function extractKeywords(text) {
        const words = text.toLowerCase().match(/\b\w+\b/g) || [];
        const stopWords = new Set(['the', 'and', 'a', 'an', 'in', 'to', 'for', 'of', 'at', 'by', 'from', 'with', 'about', 'as', 'is', 'are', 'was', 'were', 'that', 'this', 'these', 'those', 'it', 'its', 'on', 'be', 'has', 'have', 'had']);
        const wordFreq = {};

        words.forEach(word => {
            if (word.length > 3 && !stopWords.has(word)) {
                wordFreq[word] = (wordFreq[word] || 0) + 1;
            }
        });

        return Object.entries(wordFreq)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 7)
            .map(([word, freq]) => ({word, freq}));
    }

    function displayKeywords(keywords) {
        const container = document.getElementById('keywords');
        container.innerHTML = '';

        keywords.forEach(({word, freq}) => {
            const span = document.createElement('span');
            span.textContent = `${word} (${freq})`;
            span.className = 'px-3 py-1 rounded-full text-sm font-medium bg-brand-100 text-brand-800 dark:bg-brand-900 dark:text-brand-200';
            container.appendChild(span);
        });
    }

    function generateRecommendations(analysis) {
        const recommendations = [];
        const container = document.getElementById('recommendations');
        container.innerHTML = '';

        if (analysis.fleschReadingEase < 60) {
            recommendations.push("Consider simplifying your vocabulary to improve readability.");
        }

        if (analysis.avgWordsPerSentence > 20) {
            recommendations.push("Your sentences are quite long. Try breaking them into shorter sentences for better readability.");
        }

        if (analysis.avgCharsPerWord > 5.5) {
            recommendations.push("You're using many complex words. Consider using simpler alternatives where appropriate.");
        }

        if (analysis.paragraphCount === 1 && analysis.wordCount > 100) {
            recommendations.push("Breaking your content into multiple paragraphs would improve scannability.");
        }

        if (analysis.fleschKincaidGrade > 12 && analysis.wordCount > 200) {
            recommendations.push("Your content may be too advanced for general readers. Consider simplifying if targeting a broad audience.");
        }

        if (recommendations.length === 0) {
            recommendations.push("Your text has good readability metrics. No specific improvements needed.");
        }

        recommendations.forEach(rec => {
            const li = document.createElement('li');
            li.textContent = rec;
            container.appendChild(li);
        });
    }

    function updateReadabilityChart(fleschReadingEase, fleschKincaidGrade, smogIndex, automatedReadabilityIndex) {
        if (readabilityChart) {
            readabilityChart.destroy();
        }

        const ctx = document.getElementById('readabilityChart').getContext('2d');
        const normalizedFRE = Math.min(100, Math.max(0, fleschReadingEase)) / 10; // Scale 0-100 to 0-10

        readabilityChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Flesch Reading Ease', 'Flesch-Kincaid Grade', 'SMOG Index', 'ARI'],
                datasets: [{
                    label: 'Readability Scores',
                    data: [normalizedFRE, fleschKincaidGrade, smogIndex, automatedReadabilityIndex],
                    backgroundColor: [
                        'rgba(14, 165, 233, 0.7)', // brand-500 with transparency
                        'rgba(14, 165, 233, 0.7)',
                        'rgba(14, 165, 233, 0.7)',
                        'rgba(14, 165, 233, 0.7)'
                    ],
                    borderColor: [
                        'rgb(14, 165, 233)',
                        'rgb(14, 165, 233)',
                        'rgb(14, 165, 233)',
                        'rgb(14, 165, 233)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function (context) {
                                const label = context.dataset.label || '';
                                const value = context.raw;

                                if (context.dataIndex === 0) {
                                    return `Reading Ease: ${(value * 10).toFixed(1)}/100 (${getReadabilityLevel(value * 10)})`;
                                } else if (context.dataIndex === 1) {
                                    return `Grade Level: ${value.toFixed(1)}`;
                                } else if (context.dataIndex === 2) {
                                    return `SMOG Index: ${value.toFixed(1)}`;
                                } else if (context.dataIndex === 3) {
                                    return `ARI: ${value.toFixed(1)}`;
                                }
                                return `${label}: ${value}`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Score / Grade Level',
                            color: document.documentElement.classList.contains('dark') ? '#e5e7eb' : '#374151'
                        },
                        grid: {
                            color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                        },
                        ticks: {
                            color: document.documentElement.classList.contains('dark') ? '#e5e7eb' : '#374151'
                        }
                    },
                    x: {
                        grid: {
                            color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                        },
                        ticks: {
                            color: document.documentElement.classList.contains('dark') ? '#e5e7eb' : '#374151'
                        }
                    }
                }
            }
        });
    }

    function renderHistory() {
        const historyEmpty = document.getElementById('history-empty');
        const historyContent = document.getElementById('history-content');
        const historyList = document.getElementById('history-list');

        if (analysisHistory.length === 0) {
            historyEmpty.classList.remove('hidden');
            historyContent.classList.add('hidden');
            return;
        }

        historyEmpty.classList.add('hidden');
        historyContent.classList.remove('hidden');
        historyList.innerHTML = '';

        analysisHistory.forEach((analysis, index) => {
            const date = new Date(analysis.timestamp);
            const formattedDate = `${date.toLocaleDateString()} at ${date.toLocaleTimeString()}`;

            const item = document.createElement('div');
            item.className = 'bg-white dark:bg-gray-800 rounded-lg shadow p-4 border border-gray-100 dark:border-gray-700 hover:shadow-md transition-shadow';
            item.innerHTML = `
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-medium text-gray-800 dark:text-white">${truncate(analysis.preview, 50)}</h3>
            <span class="text-xs text-gray-500 dark:text-gray-400">${formattedDate}</span>
          </div>
          <div class="grid grid-cols-3 gap-2 mb-2">
            <div class="text-center">
              <div class="text-lg font-semibold text-brand-600 dark:text-brand-400">${formatTime(analysis.readingTimeMinutes)}</div>
              <div class="text-xs text-gray-500 dark:text-gray-400">Reading Time</div>
            </div>
            <div class="text-center">
              <div class="text-lg font-semibold text-brand-600 dark:text-brand-400">${analysis.wordCount}</div>
              <div class="text-xs text-gray-500 dark:text-gray-400">Words</div>
            </div>
            <div class="text-center">
              <div class="text-lg font-semibold text-brand-600 dark:text-brand-400">${Math.round(analysis.fleschKincaidGrade)}</div>
              <div class="text-xs text-gray-500 dark:text-gray-400">Grade Level</div>
            </div>
          </div>
          <div class="flex justify-between">
            <button class="text-xs text-brand-600 dark:text-brand-400 hover:text-brand-800 dark:hover:text-brand-300 load-analysis" data-index="${index}">
              <i class="fas fa-sync-alt mr-1"></i> Load Analysis
            </button>
            <button class="text-xs text-red-500 hover:text-red-700 delete-analysis" data-index="${index}">
              <i class="fas fa-trash-alt mr-1"></i> Delete
            </button>
          </div>
        `;

            historyList.appendChild(item);
        });

        // Add event listeners to history items
        document.querySelectorAll('.load-analysis').forEach(btn => {
            btn.addEventListener('click', e => {
                const index = parseInt(e.currentTarget.dataset.index);
                loadAnalysisFromHistory(index);
            });
        });

        document.querySelectorAll('.delete-analysis').forEach(btn => {
            btn.addEventListener('click', e => {
                const index = parseInt(e.currentTarget.dataset.index);
                deleteAnalysisFromHistory(index);
            });
        });
    }

    function loadAnalysisFromHistory(index) {
        const analysis = analysisHistory[index];
        if (!analysis) return;

        input.value = analysis.text;
        updateCharCount();
        readingSpeedSlider.value = analysis.wpm;
        updateSpeedDisplay();
        currentAnalysis = analysis;

        // Update UI
        document.getElementById('quick-time').textContent = formatTime(analysis.readingTimeMinutes);
        document.getElementById('quick-words').textContent = analysis.wordCount.toLocaleString();
        document.getElementById('quick-readability').textContent = getReadabilityLevel(analysis.fleschReadingEase);
        document.getElementById('quick-grade').textContent = Math.round(analysis.fleschKincaidGrade);
        document.getElementById('quick-results').classList.remove('hidden');

        // Switch to editor tab
        document.querySelector('[data-tab="editor"]').click();
    }

    function deleteAnalysisFromHistory(index) {
        if (confirm('Are you sure you want to delete this analysis?')) {
            analysisHistory.splice(index, 1);
            localStorage.setItem('readingTimeHistory', JSON.stringify(analysisHistory));
            renderHistory();
        }
    }

    function truncate(str, length) {
        return str.length > length ? str.substring(0, length) + '...' : str;
    }
</script>
<script src="../logo.js"></script>
</body>
</html>