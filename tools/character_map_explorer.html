<!DOCTYPE html>
<html lang="en" class="antialiased">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Character Map Explorer</title>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js" defer></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap">
    <script>tailwind.config = {
        theme: {
            extend: {
                fontFamily: {
                    sans: ['Inter', 'system-ui', 'sans-serif'],
                    mono: ['JetBrains Mono', 'monospace']
                },
                colors: {
                    primary: {
                        50: '#f0f5ff',
                        100: '#e0eaff',
                        200: '#c7d9ff',
                        300: '#a4bdff',
                        400: '#8196ff',
                        500: '#5b6cf9',
                        600: '#4e4eee',
                        700: '#3f3dd2',
                        800: '#3334ab',
                        900: '#2f3386',
                        950: '#1e1e59'
                    }
                }
            }
        }
    }</script>
    <style>[x-cloak] {
        display: none !important
    }

    .char-cell {
        transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1)
    }

    .char-grid {
        scroll-behavior: smooth
    }

    .toast {
        animation: fadeOut 3s forwards
    }

    @keyframes fadeOut {
        0%, 80% {
            opacity: 1
        }
        100% {
            opacity: 0
        }
    }

    .focus-ring:focus-visible {
        outline: 2px solid currentColor;
        outline-offset: 2px
    }

    .no-scrollbar::-webkit-scrollbar {
        display: none
    }

    .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none
    }

    .shortcut-key {
        font-family: 'JetBrains Mono', monospace
    }</style>
</head>
<body class="bg-gray-50 text-gray-900" x-data="characterExplorer()" x-init="init()" x-cloak>
<div class="min-h-screen max-w-7xl mx-auto px-4 py-6 flex flex-col">
    <header class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 pb-4 border-b border-gray-200">
        <div>
            <div class="flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-primary-600" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
                <h1 class="text-3xl font-bold tracking-tight text-primary-700">Character Map Explorer</h1></div>
            <p class="text-gray-600 mt-1">Browse, search and use Unicode characters</p></div>
        <div class="flex items-center gap-3 mt-4 sm:mt-0">
            <button @click="toggleFavorites()"
                    class="flex items-center gap-2 py-1.5 px-3 rounded-full border border-gray-200 hover:bg-gray-100 transition-colors"
                    :class="showFavorites ? 'bg-primary-100 text-primary-800 border-primary-300' : ''">
                <svg xmlns="http://www.w3.org/2000/svg" :class="showFavorites ? 'text-primary-500' : 'text-gray-500'"
                     class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor" stroke="none">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                <span class="text-sm">Favorites</span></button>
            <button @click="toggleKeyboardHelp()"
                    class="flex items-center gap-2 py-1.5 px-3 rounded-full border border-gray-200 hover:bg-gray-100 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-500" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2">
                    <rect x="2" y="4" width="20" height="16" rx="2" ry="2"></rect>
                    <path d="M6 8h.01"></path>
                    <path d="M10 8h.01"></path>
                    <path d="M14 8h.01"></path>
                    <path d="M18 8h.01"></path>
                    <path d="M8 12h.01"></path>
                    <path d="M12 12h.01"></path>
                    <path d="M16 12h.01"></path>
                    <path d="M7 16h10"></path>
                </svg>
                <span class="text-sm">Shortcuts</span></button>
        </div>
    </header>
    <div class="mb-6 bg-white rounded-xl p-4 shadow-sm border border-gray-200">
        <div class="flex flex-col sm:flex-row gap-4">
            <div class="relative flex-1">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                </div>
                <input type="text" x-model="searchQuery" @input="filterCharacters()" @keydown.escape="clearSearch()"
                       placeholder="Search by character, name, or code..."
                       class="w-full pl-10 pr-4 py-2.5 rounded-lg border border-gray-200 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                       x-ref="searchInput">
                <button x-show="searchQuery" @click="clearSearch()"
                        class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="w-full sm:w-48"><select x-model="selectedBlock" @change="blockChanged()"
                                                class="w-full px-3 py-2.5 rounded-lg appearance-none bg-right bg-no-repeat bg-[length:16px_16px] border border-gray-200 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors pr-8"
                                                style="background-image:url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%23a1a1aa%22%20stroke-width%3D%222%22%3E%3Cpath%20d%3D%22m6%209%206%206%206-6%22%2F%3E%3C%2Fsvg%3E');">
                <template x-for="block in unicodeBlocks" :key="block.name">
                    <option :value="block.name" x-text="block.name"></option>
                </template>
            </select></div>
        </div>
        <div class="mt-4 flex items-center border-b border-gray-200">
            <button @click="selectedTab='recent'; tabChanged()" class="py-2 px-4 text-sm font-medium relative"
                    :class="selectedTab==='recent' ? 'text-primary-600' : 'text-gray-600 hover:text-gray-900'">Recent
                <div x-show="selectedTab==='recent'"
                     class="absolute bottom-0 left-0 right-0 h-0.5 bg-primary-500"></div>
            </button>
            <button @click="selectedTab='blocks'; tabChanged()" class="py-2 px-4 text-sm font-medium relative"
                    :class="selectedTab==='blocks' ? 'text-primary-600' : 'text-gray-600 hover:text-gray-900'">Blocks
                <div x-show="selectedTab==='blocks'"
                     class="absolute bottom-0 left-0 right-0 h-0.5 bg-primary-500"></div>
            </button>
        </div>
        <div class="mt-3 overflow-x-auto no-scrollbar">
            <div x-show="selectedTab==='recent'" class="flex items-center gap-2 pb-1">
                <template x-if="recentChars.length===0">
                    <div class="text-sm text-gray-500 py-1">No recent characters</div>
                </template>
                <template x-for="(char,index) in recentChars" :key="`recent-${index}`">
                    <button @click="quickSelect(char)"
                            class="w-10 h-10 flex items-center justify-center border border-gray-200 rounded hover:bg-gray-100 focus-ring"
                            :title="getCharInfo(char)?.name||char"><span class="text-lg" x-text="char"></span></button>
                </template>
            </div>
            <div x-show="selectedTab==='blocks'" class="flex items-center gap-2 pb-1 flex-wrap">
                <template x-for="block in unicodeBlocks" :key="block.name">
                    <button @click="selectBlock(block.name)"
                            class="px-3 py-1.5 text-sm border rounded-full transition-colors"
                            :class="selectedBlock===block.name ? 'bg-primary-100 border-primary-200 text-primary-900' : 'border-gray-200 hover:bg-gray-100 text-gray-700'">
                        <span x-text="block.name"></span></button>
                </template>
            </div>
        </div>
    </div>
    <div x-show="showFavorites && favorites.length>0"
         class="mb-6 bg-white rounded-xl p-4 shadow-sm border border-primary-200">
        <div class="flex justify-between items-center mb-3">
            <h2 class="text-lg font-medium flex items-center gap-2 text-primary-900">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-primary-500" viewBox="0 0 24 24"
                     fill="currentColor" stroke="none">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                Favorites
            </h2>
            <button @click="showFavorites=false" class="text-gray-400 hover:text-gray-600">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <div class="grid grid-cols-8 sm:grid-cols-12 md:grid-cols-16 gap-2">
            <template x-for="(char,index) in favorites" :key="`fav-${index}`">
                <div class="relative group">
                    <button @click="quickSelect(char)"
                            class="char-cell w-full aspect-square flex items-center justify-center border border-primary-200 rounded bg-primary-50 hover:bg-primary-100 text-lg focus-ring"
                            :title="getCharInfo(char)?.name||char"><span x-text="char"></span></button>
                    <button @click="removeFromFavorites(char)"
                            class="absolute -top-2 -right-2 bg-gray-100 text-gray-500 hover:text-gray-700 rounded-full w-5 h-5 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity focus:opacity-100 focus-ring">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 24 24" fill="none"
                             stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
            </template>
        </div>
    </div>
    <div class="flex flex-col lg:flex-row gap-6 flex-1">
        <div class="lg:w-2/3 bg-white rounded-xl p-4 shadow-sm border border-gray-200">
            <div class="flex justify-between items-center mb-4"><h2 class="text-lg font-medium flex items-center gap-2">
                <span x-text="selectedBlock||'Characters'"></span></h2><span class="text-sm text-gray-500"><span
                    x-text="paginatedCharacters.length"></span> of <span
                    x-text="filteredCharacters.length"></span></span></div>
            <div x-show="filteredCharacters.length===0" class="py-12 text-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-4 text-gray-300" fill="none"
                     viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <p class="text-gray-600 text-lg">No characters found</p>
                <button @click="resetFilters()"
                        class="mt-4 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-md transition-colors focus-ring">
                    Reset Filters
                </button>
            </div>
            <div x-show="filteredCharacters.length>0" x-ref="charGrid"
                 class="char-grid grid grid-cols-6 sm:grid-cols-8 md:grid-cols-10 xl:grid-cols-12 gap-2"
                 @keydown.right="navigateGrid('right')" @keydown.left="navigateGrid('left')"
                 @keydown.up="navigateGrid('up')" @keydown.down="navigateGrid('down')">
                <template x-for="(char,index) in paginatedCharacters" :key="`grid-${char.codePoint}`">
                    <button @click="selectCharacter(char)" @keydown.enter="selectCharacter(char)"
                            @keydown.space.prevent="selectCharacter(char)"
                            class="char-cell aspect-square flex items-center justify-center p-2 text-lg border rounded focus-ring"
                            :class="getCharacterCellClasses(char,index)" :tabindex="gridFocusIndex===index?0:-1"
                            :data-index="index" x-ref="gridCell"><span x-text="char.char"></span></button>
                </template>
            </div>
            <div x-show="filteredCharacters.length>0" class="mt-6 flex justify-between items-center">
                <button @click="prevPage()"
                        class="px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 disabled:opacity-50 transition-colors focus-ring flex items-center gap-1.5"
                        :disabled="currentPage===1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    <span class="text-sm">Previous</span></button>
                <div class="flex items-center"><span class="text-sm text-gray-600">Page</span><select
                        x-model.number="currentPage" @change="paginate()"
                        class="mx-2 bg-transparent border-0 text-center focus:ring-0 text-sm p-0 text-gray-900">
                    <template x-for="page in totalPages" :key="`page-${page}`">
                        <option :value="page" x-text="page"></option>
                    </template>
                </select><span class="text-sm text-gray-600">of <span x-text="totalPages"></span></span></div>
                <button @click="nextPage()"
                        class="px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 disabled:opacity-50 transition-colors focus-ring flex items-center gap-1.5"
                        :disabled="currentPage===totalPages"><span class="text-sm">Next</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </button>
            </div>
        </div>
        <div class="lg:w-1/3 space-y-6">
            <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
                <template x-if="selectedChar">
                    <div>
                        <div class="flex justify-between items-center mb-4"><h2 class="text-lg font-medium">Character
                            Details</h2>
                            <div class="flex items-center space-x-2">
                                <button @click="toggleFavorite(selectedChar.char)"
                                        class="p-1.5 rounded-full hover:bg-gray-100 transition-colors focus-ring"
                                        :aria-label="isFavorite(selectedChar.char)?'Remove from favorites':'Add to favorites'">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5"
                                         :class="isFavorite(selectedChar.char)?'text-primary-500 fill-primary-500':'text-gray-400 fill-none'"
                                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="mb-6 p-6 bg-gray-50 rounded-lg flex items-center justify-center">
                            <div class="text-center">
                                <div class="text-6xl mb-3 font-normal" x-text="selectedChar.char"></div>
                                <div class="text-gray-600 text-sm font-medium" x-text="selectedChar.name"></div>
                            </div>
                        </div>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center py-2 border-b border-gray-100"><span
                                    class="text-gray-600 text-sm">Character</span>
                                <div class="flex items-center"><span class="mr-2 font-medium font-mono text-sm"
                                                                     x-text="selectedChar.char"></span>
                                    <button @click="copyToClipboard(selectedChar.char)"
                                            class="p-1 rounded hover:bg-gray-100 text-primary-600 transition-colors focus-ring"
                                            aria-label="Copy character">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center py-2 border-b border-gray-100"><span
                                    class="text-gray-600 text-sm">Code Point</span>
                                <div class="flex items-center"><span class="mr-2 font-medium font-mono text-sm"
                                                                     x-text="selectedChar.codePoint"></span>
                                    <button @click="copyToClipboard(selectedChar.codePoint)"
                                            class="p-1 rounded hover:bg-gray-100 text-primary-600 transition-colors focus-ring"
                                            aria-label="Copy code point">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center py-2 border-b border-gray-100"><span
                                    class="text-gray-600 text-sm">HTML Entity</span>
                                <div class="flex items-center"><span class="mr-2 font-medium font-mono text-sm"
                                                                     x-text="selectedChar.htmlEntity"></span>
                                    <button @click="copyToClipboard(selectedChar.htmlEntity)"
                                            class="p-1 rounded hover:bg-gray-100 text-primary-600 transition-colors focus-ring"
                                            aria-label="Copy HTML entity">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div x-show="selectedChar.htmlNamedEntity"
                                 class="flex justify-between items-center py-2 border-b border-gray-100"><span
                                    class="text-gray-600 text-sm">Named Entity</span>
                                <div class="flex items-center"><span class="mr-2 font-medium font-mono text-sm"
                                                                     x-text="selectedChar.htmlNamedEntity"></span>
                                    <button @click="copyToClipboard(selectedChar.htmlNamedEntity)"
                                            class="p-1 rounded hover:bg-gray-100 text-primary-600 transition-colors focus-ring"
                                            aria-label="Copy named entity">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center py-2 border-b border-gray-100"><span
                                    class="text-gray-600 text-sm">JS Escape</span>
                                <div class="flex items-center"><span class="mr-2 font-medium font-mono text-sm"
                                                                     x-text="selectedChar.jsEscape"></span>
                                    <button @click="copyToClipboard(selectedChar.jsEscape)"
                                            class="p-1 rounded hover:bg-gray-100 text-primary-600 transition-colors focus-ring"
                                            aria-label="Copy JS escape">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center py-2 border-b border-gray-100"><span
                                    class="text-gray-600 text-sm">CSS Escape</span>
                                <div class="flex items-center"><span class="mr-2 font-medium font-mono text-sm"
                                                                     x-text="`\\${selectedChar.codePoint.substring(2)}`"></span>
                                    <button @click="copyToClipboard(`\\${selectedChar.codePoint.substring(2)}`)"
                                            class="p-1 rounded hover:bg-gray-100 text-primary-600 transition-colors focus-ring"
                                            aria-label="Copy CSS escape">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center py-2" x-show="selectedChar.blockName"><span
                                    class="text-gray-600 text-sm">Block</span><span class="font-medium text-sm"
                                                                                    x-text="selectedChar.blockName"></span>
                            </div>
                        </div>
                    </div>
                </template>
                <template x-if="!selectedChar">
                    <div class="text-center py-12">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-4 text-gray-300" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <h3 class="text-xl font-medium mb-2">No Character Selected</h3>
                        <p class="text-gray-500">Click on a character to view its details</p>
                        <div class="mt-4 text-sm text-gray-400"><p>Use arrow keys to navigate the grid</p></div>
                    </div>
                </template>
            </div>
            <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200"><h3 class="text-lg font-medium mb-3">
                Common Characters</h3>
                <div class="grid grid-cols-6 sm:grid-cols-8 gap-2">
                    <template x-for="char in commonChars" :key="char">
                        <button @click="quickSelect(char)"
                                class="char-cell aspect-square flex items-center justify-center border border-gray-200 rounded hover:bg-gray-100 focus-ring"
                                :title="getCharInfo(char)?.name||char"><span x-text="char"></span></button>
                    </template>
                </div>
            </div>
        </div>
    </div>
    <footer class="mt-8 pt-6 border-t border-gray-200 text-center text-gray-500 text-sm">
        <p>Character Map Explorer &middot;
            <button @click="toggleKeyboardHelp()"
                    class="text-primary-600 hover:underline focus:outline-none focus:underline">View Keyboard Shortcuts
            </button>
        </p>
    </footer>
</div>
<div x-show="toast.visible" x-transition
     class="toast fixed bottom-4 right-4 px-4 py-2 bg-primary-500 text-white rounded-lg shadow-lg z-50 flex items-center gap-2">
    <svg x-show="toast.type==='success'" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24"
         fill="none" stroke="currentColor" stroke-width="2">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
    </svg>
    <span x-text="toast.message"></span></div>
<div x-show="showKeyboardHelp" x-transition:enter="transition ease-out duration-200"
     x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
     x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0"
     class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4"
     @click.self="toggleKeyboardHelp()">
    <div x-show="showKeyboardHelp" x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0 scale-95" x-transition:enter-end="opacity-100 scale-100"
         x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100 scale-100"
         x-transition:leave-end="opacity-0 scale-95" class="bg-white rounded-xl shadow-lg max-w-md w-full p-6">
        <div class="flex justify-between items-center mb-4"><h3 class="text-xl font-semibold">Keyboard Shortcuts</h3>
            <button @click="toggleKeyboardHelp()" class="p-1 rounded-full hover:bg-gray-100 text-gray-500">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <div class="space-y-3">
            <div class="flex justify-between py-2 border-b border-gray-100"><span
                    class="text-gray-700">Navigation</span>
                <div class="flex gap-1"><span class="shortcut-key px-1.5 py-0.5 rounded bg-gray-100">↑</span><span
                        class="shortcut-key px-1.5 py-0.5 rounded bg-gray-100">↓</span><span
                        class="shortcut-key px-1.5 py-0.5 rounded bg-gray-100">←</span><span
                        class="shortcut-key px-1.5 py-0.5 rounded bg-gray-100">→</span></div>
            </div>
            <div class="flex justify-between py-2 border-b border-gray-100"><span
                    class="text-gray-700">Select character</span>
                <div class="flex gap-1"><span class="shortcut-key px-1.5 py-0.5 rounded bg-gray-100">Enter</span><span
                        class="shortcut-key px-1.5 py-0.5 rounded bg-gray-100">Space</span></div>
            </div>
            <div class="flex justify-between py-2 border-b border-gray-100"><span
                    class="text-gray-700">Search</span><span
                    class="shortcut-key px-1.5 py-0.5 rounded bg-gray-100">/</span></div>
            <div class="flex justify-between py-2 border-b border-gray-100"><span
                    class="text-gray-700">Clear search</span><span
                    class="shortcut-key px-1.5 py-0.5 rounded bg-gray-100">Esc</span></div>
            <div class="flex justify-between py-2 border-b border-gray-100"><span
                    class="text-gray-700">Previous page</span><span
                    class="shortcut-key px-1.5 py-0.5 rounded bg-gray-100">[</span></div>
            <div class="flex justify-between py-2 border-b border-gray-100"><span class="text-gray-700">Next page</span><span
                    class="shortcut-key px-1.5 py-0.5 rounded bg-gray-100">]</span></div>
            <div class="flex justify-between py-2"><span class="text-gray-700">Toggle favorites</span><span
                    class="shortcut-key px-1.5 py-0.5 rounded bg-gray-100">F</span></div>
        </div>
    </div>
</div>
<script>document.addEventListener('alpine:init', () => {
    Alpine.data('characterExplorer', () => ({
        characters: [],
        loadedBlocks: new Set(),
        filteredCharacters: [],
        selectedChar: null,
        searchQuery: '',
        selectedBlock: 'Basic Latin',
        selectedTab: 'recent',
        currentPage: 1,
        itemsPerPage: 120,
        favorites: [],
        showFavorites: false,
        recentChars: [],
        toast: {visible: false, message: '', type: 'success'},
        showKeyboardHelp: false,
        gridFocusIndex: 0,
        commonChars: ['©', '®', '™', '€', '£', '¥', '¢', '§', '±', '×', '÷', '«', '»', '°', '¼', '½', '¾', '→', '←', '↑', '↓', '•', '…', '¿', '¡'],
        unicodeBlocks: [{name: 'Basic Latin', start: 0x0020, end: 0x007F}, {
            name: 'Latin-1 Supplement',
            start: 0x00A0,
            end: 0x00FF
        }, {name: 'Latin Extended-A', start: 0x0100, end: 0x017F}, {
            name: 'Latin Extended-B',
            start: 0x0180,
            end: 0x024F
        }, {name: 'IPA Extensions', start: 0x0250, end: 0x02AF}, {
            name: 'Greek and Coptic',
            start: 0x0370,
            end: 0x03FF
        }, {name: 'Cyrillic', start: 0x0400, end: 0x04FF}, {
            name: 'General Punctuation',
            start: 0x2000,
            end: 0x206F
        }, {name: 'Superscripts and Subscripts', start: 0x2070, end: 0x209F}, {
            name: 'Currency Symbols',
            start: 0x20A0,
            end: 0x20CF
        }, {name: 'Letterlike Symbols', start: 0x2100, end: 0x214F}, {
            name: 'Arrows',
            start: 0x2190,
            end: 0x21FF
        }, {name: 'Mathematical Operators', start: 0x2200, end: 0x22FF}, {
            name: 'Box Drawing',
            start: 0x2500,
            end: 0x257F
        }, {name: 'Block Elements', start: 0x2580, end: 0x259F}, {
            name: 'Geometric Shapes',
            start: 0x25A0,
            end: 0x25FF
        }, {name: 'Miscellaneous Symbols', start: 0x2600, end: 0x26FF}, {
            name: 'Dingbats',
            start: 0x2700,
            end: 0x27BF
        }, {name: 'Emoji Symbols', start: 0x1F300, end: 0x1F5FF}],
        namedEntities: {
            34: '&quot;',
            38: '&amp;',
            39: '&apos;',
            60: '&lt;',
            62: '&gt;',
            160: '&nbsp;',
            161: '&iexcl;',
            162: '&cent;',
            163: '&pound;',
            164: '&curren;',
            165: '&yen;',
            166: '&brvbar;',
            167: '&sect;',
            168: '&uml;',
            169: '&copy;',
            170: '&ordf;',
            171: '&laquo;',
            172: '&not;',
            173: '&shy;',
            174: '&reg;',
            175: '&macr;',
            176: '&deg;',
            177: '&plusmn;',
            178: '&sup2;',
            179: '&sup3;',
            180: '&acute;',
            181: '&micro;',
            182: '&para;',
            183: '&middot;',
            184: '&cedil;',
            185: '&sup1;',
            186: '&ordm;',
            187: '&raquo;',
            188: '&frac14;',
            189: '&frac12;',
            190: '&frac34;',
            191: '&iquest;',
            192: '&Agrave;',
            193: '&Aacute;',
            194: '&Acirc;',
            195: '&Atilde;',
            196: '&Auml;',
            197: '&Aring;',
            198: '&AElig;',
            199: '&Ccedil;',
            200: '&Egrave;',
            201: '&Eacute;',
            202: '&Ecirc;',
            203: '&Euml;',
            204: '&Igrave;',
            205: '&Iacute;',
            206: '&Icirc;',
            207: '&Iuml;',
            208: '&ETH;',
            209: '&Ntilde;',
            210: '&Ograve;',
            211: '&Oacute;',
            212: '&Ocirc;',
            213: '&Otilde;',
            214: '&Ouml;',
            215: '&times;',
            216: '&Oslash;',
            217: '&Ugrave;',
            218: '&Uacute;',
            219: '&Ucirc;',
            220: '&Uuml;',
            221: '&Yacute;',
            222: '&THORN;',
            223: '&szlig;',
            224: '&agrave;',
            225: '&aacute;',
            226: '&acirc;',
            227: '&atilde;',
            228: '&auml;',
            229: '&aring;',
            230: '&aelig;',
            231: '&ccedil;',
            232: '&egrave;',
            233: '&eacute;',
            234: '&ecirc;',
            235: '&euml;',
            236: '&igrave;',
            237: '&iacute;',
            238: '&icirc;',
            239: '&iuml;',
            240: '&eth;',
            241: '&ntilde;',
            242: '&ograve;',
            243: '&oacute;',
            244: '&ocirc;',
            245: '&otilde;',
            246: '&ouml;',
            247: '&divide;',
            248: '&oslash;',
            249: '&ugrave;',
            250: '&uacute;',
            251: '&ucirc;',
            252: '&uuml;',
            253: '&yacute;',
            254: '&thorn;',
            255: '&yuml;'
        },
        init() {
            this.loadCharacters(this.selectedBlock);
            this.loadPreferences();
            this.setupKeyboardListeners();
        },
        loadPreferences() {
            const savedFavorites = localStorage.getItem('favorites');
            if (savedFavorites) this.favorites = JSON.parse(savedFavorites);
            const savedRecent = localStorage.getItem('recentChars');
            if (savedRecent) this.recentChars = JSON.parse(savedRecent);
        },
        setupKeyboardListeners() {
            window.addEventListener('keydown', (e) => {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') return;
                switch (e.key) {
                    case'/':
                        e.preventDefault();
                        this.$refs.searchInput.focus();
                        break;
                    case'[':
                        if (this.currentPage > 1) this.prevPage();
                        break;
                    case']':
                        if (this.currentPage < this.totalPages) this.nextPage();
                        break;
                    case'f':
                    case'F':
                        this.toggleFavorites();
                        break;
                    case'?':
                        this.toggleKeyboardHelp();
                        break;
                }
            });
        },
        loadCharacters(blockName) {
            if (this.loadedBlocks.has(blockName)) {
                this.filterCharacters();
                return;
            }
            const block = this.unicodeBlocks.find(b => b.name === blockName);
            if (!block) return;
            let newChars = [];
            for (let i = block.start; i <= block.end; i++) {
                try {
                    const char = this.createCharObj(i, block.name);
                    newChars.push(char);
                } catch (e) {
                    console.warn(`Could not create character for code point ${i}:`, e);
                }
            }
            this.characters = [...this.characters, ...newChars];
            this.loadedBlocks.add(blockName);
            this.filterCharacters();
        },
        createCharObj(codePoint, blockName) {
            const char = String.fromCodePoint(codePoint);
            const hexCode = codePoint.toString(16).toUpperCase().padStart(4, '0');
            return {
                char,
                codePoint: `U+${hexCode}`,
                decimal: codePoint,
                blockName,
                htmlEntity: `&#${codePoint};`,
                htmlNamedEntity: this.namedEntities[codePoint] || '',
                jsEscape: `\\u${hexCode}`,
                name: this.getCharName(codePoint, char, blockName)
            };
        },
        getCharName(codePoint, char, blockName) {
            if (codePoint >= 0x0041 && codePoint <= 0x005A) {
                return `LATIN CAPITAL LETTER ${char}`;
            } else if (codePoint >= 0x0061 && codePoint <= 0x007A) {
                return `LATIN SMALL LETTER ${char}`;
            } else if (codePoint >= 0x0370 && codePoint <= 0x03FF) {
                if (codePoint >= 0x0391 && codePoint <= 0x03A9) {
                    return `GREEK CAPITAL LETTER ${char}`;
                } else if (codePoint >= 0x03B1 && codePoint <= 0x03C9) {
                    return `GREEK SMALL LETTER ${char}`;
                }
            } else if (codePoint === 0x0020) return 'SPACE'; else if (codePoint === 0x0021) return 'EXCLAMATION MARK'; else if (codePoint === 0x0022) return 'QUOTATION MARK'; else if (codePoint === 0x0023) return 'NUMBER SIGN'; else if (codePoint === 0x0024) return 'DOLLAR SIGN'; else if (codePoint === 0x0025) return 'PERCENT SIGN';
            return `${blockName.toUpperCase()} CHARACTER ${codePoint.toString(16).toUpperCase().padStart(4, '0')}`;
        },
        selectCharacter(char) {
            this.selectedChar = char;
            this.addToRecentChars(char.char);
        },
        quickSelect(char) {
            const foundChar = this.getCharInfo(char);
            if (foundChar) {
                this.selectedChar = foundChar;
                this.addToRecentChars(char);
            } else {
                const codePoint = char.codePointAt(0);
                for (const block of this.unicodeBlocks) {
                    if (codePoint >= block.start && codePoint <= block.end) {
                        this.loadCharacters(block.name);
                        setTimeout(() => {
                            const foundChar = this.getCharInfo(char);
                            if (foundChar) {
                                this.selectedChar = foundChar;
                                this.addToRecentChars(char);
                            }
                        }, 100);
                        break;
                    }
                }
            }
        },
        getCharInfo(char) {
            const codePoint = char.codePointAt(0);
            return this.characters.find(c => c.decimal === codePoint);
        },
        addToRecentChars(char) {
            if (!this.recentChars.includes(char)) {
                this.recentChars = [char, ...this.recentChars.slice(0, 11)];
                localStorage.setItem('recentChars', JSON.stringify(this.recentChars));
            } else {
                this.recentChars = [char, ...this.recentChars.filter(c => c !== char)];
                localStorage.setItem('recentChars', JSON.stringify(this.recentChars));
            }
        },
        toggleFavorite(char) {
            if (this.isFavorite(char)) {
                this.removeFromFavorites(char);
            } else {
                this.addToFavorites(char);
            }
        },
        isFavorite(char) {
            return this.favorites.includes(char);
        },
        addToFavorites(char) {
            if (!this.favorites.includes(char)) {
                this.favorites = [...this.favorites, char];
                localStorage.setItem('favorites', JSON.stringify(this.favorites));
                this.showToast('Added to favorites', 'success');
            }
        },
        removeFromFavorites(char) {
            this.favorites = this.favorites.filter(c => c !== char);
            localStorage.setItem('favorites', JSON.stringify(this.favorites));
            this.showToast('Removed from favorites', 'success');
        },
        toggleFavorites() {
            this.showFavorites = !this.showFavorites;
        },
        filterCharacters() {
            let filtered = this.characters.filter(char => char.blockName === this.selectedBlock);
            if (this.searchQuery.trim()) {
                const search = this.searchQuery.toLowerCase();
                filtered = filtered.filter(char => char.char.toLowerCase().includes(search) || char.name.toLowerCase().includes(search) || char.codePoint.toLowerCase().includes(search) || (char.htmlNamedEntity && char.htmlNamedEntity.toLowerCase().includes(search)));
            }
            this.filteredCharacters = filtered;
            this.currentPage = 1;
            this.gridFocusIndex = 0;
        },
        resetFilters() {
            this.searchQuery = '';
            this.filterCharacters();
        },
        clearSearch() {
            if (this.searchQuery) {
                this.searchQuery = '';
                this.filterCharacters();
            }
        },
        blockChanged() {
            this.loadCharacters(this.selectedBlock);
        },
        selectBlock(blockName) {
            this.selectedBlock = blockName;
            this.blockChanged();
        },
        tabChanged() {
        },
        get totalPages() {
            return Math.max(1, Math.ceil(this.filteredCharacters.length / this.itemsPerPage));
        },
        get paginatedCharacters() {
            const start = (this.currentPage - 1) * this.itemsPerPage;
            const end = start + this.itemsPerPage;
            return this.filteredCharacters.slice(start, end);
        },
        prevPage() {
            if (this.currentPage > 1) {
                this.currentPage--;
                this.paginate();
            }
        },
        nextPage() {
            if (this.currentPage < this.totalPages) {
                this.currentPage++;
                this.paginate();
            }
        },
        paginate() {
            window.scrollTo(0, 0);
            this.gridFocusIndex = 0;
        },
        navigateGrid(direction) {
            const gridSize = this.paginatedCharacters.length;
            if (gridSize === 0) return;
            const columns = 12;
            let newIndex = this.gridFocusIndex;
            switch (direction) {
                case'right':
                    newIndex = Math.min(gridSize - 1, this.gridFocusIndex + 1);
                    break;
                case'left':
                    newIndex = Math.max(0, this.gridFocusIndex - 1);
                    break;
                case'up':
                    newIndex = Math.max(0, this.gridFocusIndex - columns);
                    break;
                case'down':
                    newIndex = Math.min(gridSize - 1, this.gridFocusIndex + columns);
                    break;
            }
            if (newIndex !== this.gridFocusIndex) {
                this.gridFocusIndex = newIndex;
                this.$nextTick(() => {
                    const focusedCell = this.$refs.gridCell[this.gridFocusIndex];
                    if (focusedCell) {
                        focusedCell.focus();
                        focusedCell.scrollIntoView({block: 'nearest'});
                    }
                });
            }
        },
        getCharacterCellClasses(char, index) {
            return ['border-gray-200 hover:bg-gray-100', this.selectedChar && this.selectedChar.codePoint === char.codePoint ? 'ring-2 ring-primary-500 border-primary-200 bg-primary-50' : '', this.gridFocusIndex === index ? 'ring-2 ring-primary-300' : ''].join(' ');
        },
        copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => this.showToast('Copied to clipboard!', 'success')).catch(err => this.showToast('Failed to copy', 'error'));
        },
        showToast(message, type = 'success') {
            this.toast.message = message;
            this.toast.type = type;
            this.toast.visible = true;
            setTimeout(() => {
                this.toast.visible = false;
            }, 3000);
        },
        toggleKeyboardHelp() {
            this.showKeyboardHelp = !this.showKeyboardHelp;
        }
    }));
});</script>
</body>
</html>