<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Game Challenge Generator</title>
    <meta name="description" content="Generate creative challenges for your favorite games using AI">
    <link rel="icon"
          href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ®</text></svg>">
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            "50": "#eef2ff",
                            "100": "#e0e7ff",
                            "200": "#c7d2fe",
                            "300": "#a5b4fc",
                            "400": "#818cf8",
                            "500": "#6366f1",
                            "600": "#4f46e5",
                            "700": "#4338ca",
                            "800": "#3730a3",
                            "900": "#312e81"
                        },
                        secondary: {
                            "50": "#f8fafc",
                            "100": "#f1f5f9",
                            "200": "#e2e8f0",
                            "300": "#cbd5e1",
                            "400": "#94a3b8",
                            "500": "#64748b",
                            "600": "#475569",
                            "700": "#334155",
                            "800": "#1e293b",
                            "900": "#0f172a"
                        }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none
        }

        .tooltip {
            position: relative
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1
        }

        .tooltip-text {
            visibility: hidden;
            opacity: 0;
            transition: opacity .3s
        }

        .card {
            @apply bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-100 dark:border-gray-700
        }

        .card-header {
            @apply p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center
        }

        .card-body {
            @apply p-5
        }

        .btn {
            @apply px-4 py-2 rounded-md font-medium transition-colors duration-200
        }

        .btn-primary {
            @apply bg-primary-600 hover:bg-primary-700 text-white
        }

        .btn-secondary {
            @apply bg-gray-200 hover:bg-gray-300 text-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white
        }

        .btn-sm {
            @apply px-3 py-1.5 text-sm
        }

        .input {
            @apply w-full p-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white
        }

        .toggle-btn {
            @apply relative inline-flex h-6 w-11 items-center rounded-full
        }

        .toggle-bg {
            @apply absolute inset-0 rounded-full bg-gray-300 transition-colors
        }

        .toggle-circle {
            @apply absolute left-1 top-1 h-4 w-4 rounded-full bg-white transition-transform
        }
    </style>
</head>
<body class="min-h-full bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white transition-colors duration-300"
      x-data="gameChallengeGenerator()">
<div class="flex flex-col min-h-screen">
    <header class="sticky top-0 z-50 bg-gradient-to-r from-primary-600 to-primary-500 shadow-md">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <span class="text-3xl">ðŸŽ®</span>
                <h1 class="text-2xl sm:text-3xl font-bold text-white">AI Game Challenge Generator</h1>
            </div>
        </div>
    </header>
    <main class="flex-grow container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-1">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-100 dark:border-gray-700 transition-colors">
                    <h2 class="text-xl font-semibold mb-6 text-gray-800 dark:text-white flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-primary-500" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                        </svg>
                        Challenge Parameters
                    </h2>
                    <div class="space-y-5">
                        <div>
                            <label for="gameTitle"
                                   class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Game
                                Title:</label>
                            <div class="relative">
                                <input x-model="gameTitle" :placeholder="placeholderGameTitle"
                                       class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-700 text-gray-800 dark:text-white transition-colors"
                                       @keyup.enter="customChallengeType || challengeType ? generateChallenge() : null">
                                <button @click="getRandomGame()"
                                        class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-primary-500 dark:hover:text-primary-400 p-2 tooltip">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
                                         viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                    </svg>
                                    <span class="tooltip-text absolute right-0 mt-2 w-32 bg-gray-800 text-white text-xs rounded py-1 px-2">Get random game</span>
                                </button>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Challenge
                                    Type:</label>
                                <button @click="toggleCustomChallenge()"
                                        class="text-xs text-primary-600 dark:text-primary-400 hover:underline">
                                    <span x-text="customChallengeType ? 'Use predefined' : 'Custom type'"></span>
                                </button>
                            </div>
                            <div x-show="customChallengeType" x-transition:enter="transition ease-out duration-200"
                                 x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
                                <input x-model="customChallengeType" placeholder="Enter custom challenge type"
                                       class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-700 text-gray-800 dark:text-white transition-colors">
                            </div>
                            <div x-show="!customChallengeType" x-transition:enter="transition ease-out duration-200"
                                 x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
                                <select x-model="challengeType"
                                        class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-700 text-gray-800 dark:text-white transition-colors">
                                    <template x-for="type in challengeTypes" :key="type.value">
                                        <option :value="type.value" x-text="type.label"></option>
                                    </template>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label for="difficultyLevel"
                                   class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Difficulty
                                Level:</label>
                            <div class="flex items-center space-x-2">
                                <template x-for="(level, index) in difficultyLevels" :key="level.value">
                                    <div class="flex-1">
                                        <input type="radio" :id="'difficulty-' + level.value" :value="level.value"
                                               name="difficultyLevel" x-model="difficultyLevel" class="hidden peer">
                                        <label :for="'difficulty-' + level.value"
                                               class="block text-center p-2 rounded-lg cursor-pointer border transition-all duration-200 peer-checked:bg-primary-500 peer-checked:text-white peer-checked:border-primary-500 hover:bg-gray-100 dark:hover:bg-gray-700"
                                               :class="difficultyLevel === level.value ? 'border-primary-500 dark:border-primary-400' : 'border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300'"
                                               x-text="level.label"></label>
                                    </div>
                                </template>
                            </div>
                        </div>
                        <div>
                            <label for="challengeDuration"
                                   class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Challenge
                                Duration:</label>
                            <select x-model="challengeDuration"
                                    class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-700 text-gray-800 dark:text-white transition-colors">
                                <template x-for="duration in challengeDurations" :key="duration.value">
                                    <option :value="duration.value" x-text="duration.label"></option>
                                </template>
                            </select>
                        </div>
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between mb-1">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Craziness
                                        Factor:</label>
                                    <span class="text-sm font-semibold text-primary-600 dark:text-primary-400"
                                          x-text="crazinessFactor"></span>
                                </div>
                                <input x-model="crazinessFactor" type="range" min="0" max="100"
                                       class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary-500">
                                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1">
                                    <span>Mild</span>
                                    <span>Wild</span>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 tooltip">
                                        Morbidity/Cruelty Level:
                                        <span class="tooltip-text absolute left-0 mt-1 w-64 bg-gray-800 text-white text-xs rounded py-1 px-2 z-10">Higher values may generate darker or more challenging content (within appropriate bounds)</span>
                                    </label>
                                    <span class="text-sm font-semibold text-primary-600 dark:text-primary-400"
                                          x-text="morbidityLevel"></span>
                                </div>
                                <input x-model="morbidityLevel" type="range" min="0" max="100"
                                       class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary-500">
                                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1">
                                    <span>Gentle</span>
                                    <span>Severe</span>
                                </div>
                            </div>
                        </div>
                        <button @click="generateChallenge()" :disabled="isLoading || !isFormValid()"
                                class="w-full py-3 px-4 flex justify-center items-center rounded-lg text-white font-medium transition-all duration-200 shadow-md hover:shadow-lg"
                                :class="isFormValid() ? 'bg-primary-600 hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600' : 'bg-gray-400 dark:bg-gray-600 cursor-not-allowed'">
                            <svg x-show="isLoading" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white"
                                 xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                        stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor"
                                      d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            <span x-text="isLoading ? 'Generating...' : 'Generate Challenge'"></span>
                        </button>
                        <div x-show="!isFormValid() && formTouched" class="text-red-500 text-sm mt-2 text-center">
                            Please provide a game title and select a challenge type.
                        </div>
                    </div>
                </div>
            </div>
            <div class="lg:col-span-2">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden border border-gray-100 dark:border-gray-700 transition-colors">
                    <div class="border-b border-gray-200 dark:border-gray-700 p-4 flex justify-between items-center">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-primary-500" fill="none"
                                 viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                            Challenge Result
                        </h2>
                        <div class="flex space-x-2"
                             x-show="challengeDescription !== initialChallengeMessage && !errorOccurred">
                            <button @click="copyMarkdown()"
                                    class="flex items-center px-3 py-1.5 text-sm font-medium rounded-md bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none"
                                     viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"/>
                                </svg>
                                MD
                            </button>
                            <button @click="copyText()"
                                    class="flex items-center px-3 py-1.5 text-sm font-medium rounded-md bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none"
                                     viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                                </svg>
                                Text
                            </button>
                            <button @click="printChallenge()"
                                    class="flex items-center px-3 py-1.5 text-sm font-medium rounded-md bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none"
                                     viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                </svg>
                                Print
                            </button>
                            <button @click="shareChallenge()"
                                    class="flex items-center px-3 py-1.5 text-sm font-medium rounded-md bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none"
                                     viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                                </svg>
                                Share
                            </button>
                        </div>
                    </div>
                    <div class="p-6 relative">
                        <div x-show="isLoading"
                             class="absolute inset-0 flex items-center justify-center bg-white/70 dark:bg-gray-800/70 z-10">
                            <div class="text-center">
                                <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-primary-500 border-t-transparent"></div>
                                <p class="mt-3 text-gray-700 dark:text-gray-300">Creating your perfect challenge...</p>
                            </div>
                        </div>
                        <div x-show="challengeDescription === initialChallengeMessage && !isLoading"
                             class="text-center py-12">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                 class="h-16 w-16 mx-auto text-gray-400 dark:text-gray-600 mb-4" fill="none"
                                 viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M9.663 17h4.673M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
                            </svg>
                            <h3 class="text-lg font-medium text-gray-700 dark:text-gray-300 mb-2">No challenge generated
                                yet</h3>
                            <p class="text-gray-500 dark:text-gray-400 max-w-md mx-auto">Fill in the form on the left
                                with game details and click "Generate Challenge" to create your custom gaming
                                challenge.</p>
                        </div>
                        <div x-show="errorOccurred && !isLoading" class="text-center py-12">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-red-500 mb-4"
                                 fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            <h3 class="text-lg font-medium text-gray-800 dark:text-gray-200 mb-2">Oops! Something went
                                wrong</h3>
                            <p class="text-gray-500 dark:text-gray-400 max-w-md mx-auto mb-4">There was an error
                                generating your challenge. Please try again later.</p>
                            <button @click="retryGeneration()"
                                    class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-md transition-colors">
                                Try Again
                            </button>
                        </div>
                        <div x-show="challengeDescription !== initialChallengeMessage && !errorOccurred && !isLoading"
                             class="prose prose-sm sm:prose max-w-none dark:prose-invert prose-headings:text-primary-700 dark:prose-headings:text-primary-400 prose-a:text-primary-600 dark:prose-a:text-primary-400 transition-colors"
                             x-html="challengeDescription"></div>
                    </div>
                </div>
                <div x-show="challengeHistory.length > 0"
                     class="mt-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden border border-gray-100 dark:border-gray-700 transition-colors">
                    <div class="border-b border-gray-200 dark:border-gray-700 p-4 flex justify-between items-center">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-primary-500" fill="none"
                                 viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            Challenge History
                        </h2>
                        <button @click="clearHistory()"
                                class="flex items-center px-3 py-1.5 text-sm font-medium rounded-md bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24"
                                 stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                            </svg>
                            Clear
                        </button>
                    </div>
                    <div class="p-4 max-h-96 overflow-y-auto scrollbar-hide">
                        <div class="space-y-3">
                            <template x-for="(historyItem, index) in challengeHistory" :key="index">
                                <div class="border rounded-lg border-gray-200 dark:border-gray-700 overflow-hidden transition-colors">
                                    <div @click="toggleHistoryItem(index)"
                                         class="flex justify-between items-center p-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                        <h3 class="font-medium text-gray-800 dark:text-white"
                                            x-text="historyItem.name"></h3>
                                        <div class="flex items-center text-sm text-gray-500 dark:text-gray-400 space-x-3">
                                            <span x-text="formatDate(historyItem.timestamp)"></span>
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                 class="h-5 w-5 transition-transform duration-200"
                                                 :class="historyItem.expanded ? 'transform rotate-180' : ''" fill="none"
                                                 viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                      d="M19 9l-7 7-7-7"/>
                                            </svg>
                                        </div>
                                    </div>
                                    <div x-show="historyItem.expanded"
                                         class="border-t border-gray-200 dark:border-gray-700">
                                        <div class="p-4 prose prose-sm max-w-none dark:prose-invert prose-headings:text-primary-700 dark:prose-headings:text-primary-400"
                                             x-html="historyItem.description"></div>
                                        <div class="bg-gray-50 dark:bg-gray-700 p-3 flex justify-between items-center">
<span class="text-xs text-gray-500 dark:text-gray-400">
<span class="font-medium text-gray-700 dark:text-gray-300">Game:</span> <span x-text="historyItem.game"></span>
</span>
                                            <div class="flex space-x-2">
                                                <button @click.stop="loadHistoryItem(index)"
                                                        class="flex items-center px-2 py-1 text-xs font-medium rounded bg-primary-100 hover:bg-primary-200 dark:bg-primary-900/30 dark:hover:bg-primary-900/50 text-primary-800 dark:text-primary-300 transition-colors">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5 mr-1"
                                                         fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                              stroke-width="2"
                                                              d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                                    </svg>
                                                    Load
                                                </button>
                                                <button @click.stop="removeHistoryItem(index)"
                                                        class="flex items-center px-2 py-1 text-xs font-medium rounded bg-red-100 hover:bg-red-200 dark:bg-red-900/30 dark:hover:bg-red-900/50 text-red-800 dark:text-red-300 transition-colors">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5 mr-1"
                                                         fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                              stroke-width="2"
                                                              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                                    </svg>
                                                    Delete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="mt-12 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-100 dark:border-gray-700 transition-colors">
            <h2 class="text-2xl font-semibold text-gray-800 dark:text-white mb-6 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-primary-500" fill="none"
                     viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                How to Use
            </h2>
            <div class="prose max-w-none dark:prose-invert">
                <p>This tool generates creative challenges for your favorite games using AI. Simply follow these
                    steps:</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-6">
                    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                        <div class="flex items-center mb-3">
                            <div class="bg-primary-100 dark:bg-primary-900/30 text-primary-800 dark:text-primary-300 rounded-full w-8 h-8 flex items-center justify-center font-bold mr-2">
                                1
                            </div>
                            <h3 class="font-medium text-gray-800 dark:text-white text-lg m-0">Enter Game Details</h3>
                        </div>
                        <p class="text-gray-600 dark:text-gray-400 m-0">Start by entering your game title. Choose a
                            challenge type or create a custom one. Select difficulty and duration based on your
                            preferences.</p>
                    </div>
                    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                        <div class="flex items-center mb-3">
                            <div class="bg-primary-100 dark:bg-primary-900/30 text-primary-800 dark:text-primary-300 rounded-full w-8 h-8 flex items-center justify-center font-bold mr-2">
                                2
                            </div>
                            <h3 class="font-medium text-gray-800 dark:text-white text-lg m-0">Adjust Parameters</h3>
                        </div>
                        <p class="text-gray-600 dark:text-gray-400 m-0">Use the sliders to set the craziness factor and
                            morbidity level. Higher craziness creates more unconventional challenges, while morbidity
                            affects challenge intensity.</p>
                    </div>
                    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                        <div class="flex items-center mb-3">
                            <div class="bg-primary-100 dark:bg-primary-900/30 text-primary-800 dark:text-primary-300 rounded-full w-8 h-8 flex items-center justify-center font-bold mr-2">
                                3
                            </div>
                            <h3 class="font-medium text-gray-800 dark:text-white text-lg m-0">Generate & Share</h3>
                        </div>
                        <p class="text-gray-600 dark:text-gray-400 m-0">Click "Generate Challenge" and wait for the AI
                            to create your custom challenge. You can then copy, print, or share the challenge with
                            friends.</p>
                    </div>
                </div>
                <h3 class="mt-8">Example: The Sims Challenge</h3>
                <ul>
                    <li>Game Title: "The Sims 4"</li>
                    <li>Challenge Type: "Roleplay + Builder"</li>
                    <li>Difficulty: Medium</li>
                    <li>Duration: Long (2-5 hours)</li>
                    <li>Craziness: 60 (for unconventional gameplay)</li>
                    <li>Morbidity: 10 (for a less cruel challenge)</li>
                </ul>
                <p>This would generate a challenge that combines character roleplay with house building requirements,
                    suitable for a medium difficulty level that takes several hours to complete.</p>
            </div>
        </div>
    </main>
    <footer class="bg-gradient-to-r from-primary-600 to-primary-500 mt-12 py-6">
        <div class="container mx-auto px-4">
            <div class="text-center text-white">
                <p class="text-sm">&copy; 2025 AI Game Challenge Generator. This is a fan-made tool that uses AI to
                    generate gaming challenges.</p>
                <p class="text-xs mt-2 text-white/80">Not affiliated with any game developers or publishers.</p>
            </div>
        </div>
    </footer>
    <div x-show="showToast" x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0 transform translate-y-2"
         x-transition:enter-end="opacity-100 transform translate-y-0"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100 transform translate-y-0"
         x-transition:leave-end="opacity-0 transform translate-y-2"
         class="fixed bottom-4 right-4 z-50 max-w-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg flex items-center p-4">
        <div x-show="toastType === 'success'"
             class="flex-shrink-0 w-8 h-8 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 rounded-full flex items-center justify-center mr-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                 stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
        </div>
        <div x-show="toastType === 'error'"
             class="flex-shrink-0 w-8 h-8 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-full flex items-center justify-center mr-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                 stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
        </div>
        <div x-show="toastType === 'info'"
             class="flex-shrink-0 w-8 h-8 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center mr-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                 stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
        </div>
        <div>
            <p class="text-sm font-medium text-gray-900 dark:text-white" x-text="toastMessage"></p>
        </div>
        <button @click="showToast = false" class="ml-auto text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                 stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
        </button>
    </div>
    <div x-show="showShareModal" class="fixed inset-0 z-50 overflow-y-auto"
         x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 transition-opacity" aria-hidden="true">
                <div class="absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"
                     @click="showShareModal = false"></div>
            </div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div x-show="showShareModal" x-transition:enter="transition ease-out duration-300"
                 x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
                 x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
                 x-transition:leave="transition ease-in duration-200"
                 x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
                 x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
                 class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div>
                        <div class="mt-3 text-center sm:mt-0 sm:text-left">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white">Share Your
                                Challenge</h3>
                            <div class="mt-4">
                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Copy this link to share your
                                    generated challenge with friends:</p>
                                <div class="flex rounded-md shadow-sm">
                                    <input type="text" x-ref="shareLink" x-model="shareUrl" readonly
                                           class="flex-1 min-w-0 block w-full px-3 py-2 rounded-none rounded-l-md border border-gray-300 dark:border-gray-600 dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm"
                                           placeholder="Share URL">
                                    <button @click="copyShareLink()"
                                            class="-ml-px relative inline-flex items-center space-x-2 px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-r-md text-gray-700 dark:text-gray-200 bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400"
                                             fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                                        </svg>
                                        <span>Copy</span>
                                    </button>
                                </div>
                            </div>
                            <div class="mt-6">
                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Or share directly:</p>
                                <div class="flex justify-center space-x-4">
                                    <button @click="shareToTwitter()"
                                            class="p-2 text-white bg-[#1DA1F2] rounded-full hover:bg-opacity-90 transition-colors">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor"
                                             viewBox="0 0 24 24">
                                            <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"/>
                                        </svg>
                                    </button>
                                    <button @click="shareToFacebook()"
                                            class="p-2 text-white bg-[#4267B2] rounded-full hover:bg-opacity-90 transition-colors">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor"
                                             viewBox="0 0 24 24">
                                            <path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"/>
                                        </svg>
                                    </button>
                                    <button @click="shareToReddit()"
                                            class="p-2 text-white bg-[#FF4500] rounded-full hover:bg-opacity-90 transition-colors">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor"
                                             viewBox="0 0 24 24">
                                            <path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"/>
                                        </svg>
                                    </button>
                                    <button @click="shareViaEmail()"
                                            class="p-2 text-white bg-[#D44638] rounded-full hover:bg-opacity-90 transition-colors">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor"
                                             viewBox="0 0 24 24">
                                            <path d="M0 3v18h24v-18h-24zm6.623 7.929l-4.623 5.712v-9.458l4.623 3.746zm-4.141-5.929h19.035l-9.517 7.713-9.518-7.713zm5.694 7.188l3.824 3.099 3.83-3.104 5.612 6.817h-18.779l5.513-6.812zm9.208-1.264l4.616-3.741v9.348l-4.616-5.607z"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button @click="showShareModal = false" type="button"
                            class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/alpinejs@3.12.0/dist/cdn.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/axios@1.4.0/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked@5.0.2/marked.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lz-string@1.5.0/libs/lz-string.min.js"></script>
<script>
    function gameChallengeGenerator() {
        return {
            gameTitle: "",
            challengeType: "speedrun",
            customChallengeType: "",
            difficultyLevel: "medium",
            challengeDuration: "medium",
            crazinessFactor: 20,
            morbidityLevel: 0,
            isLoading: false,
            formTouched: false,
            errorOccurred: false,
            showToast: false,
            toastMessage: "",
            toastType: "success",
            showShareModal: false,
            shareUrl: "",
            initialChallengeMessage: "Challenge Description will appear here",
            challengeDescription: "Challenge Description will appear here",
            rawChallengeDescription: "",
            challengeHistory: [],
            placeholderGameTitles: ["Minecraft", "The Sims 4", "Skyrim", "Stardew Valley", "League of Legends", "Dark Souls", "Elden Ring", "Fortnite", "Animal Crossing", "Red Dead Redemption 2", "Hades", "Call of Duty", "Grand Theft Auto V", "Genshin Impact", "Overwatch", "Zelda: Breath of the Wild", "Fallout 4", "Cyberpunk 2077", "Valorant", "World of Warcraft"],
            challengeTypes: [{value: "speedrun", label: "Speedrun"}, {
                value: "completionist",
                label: "Completionist"
            }, {value: "roleplay", label: "Roleplay"}, {value: "survival", label: "Survival"}, {
                value: "builder",
                label: "Builder"
            }, {value: "collection", label: "Collection"}, {value: "exploration", label: "Exploration"}, {
                value: "pvp",
                label: "Player vs. Player (PvP)"
            }, {value: "roleplay_completionist", label: "Roleplay + Completionist"}, {
                value: "speedrun_completionist",
                label: "Speedrun + Completionist"
            }, {value: "survival_builder", label: "Survival + Builder"}, {
                value: "roleplay_survival",
                label: "Roleplay + Survival"
            }, {value: "exploration_collection", label: "Exploration + Collection"}, {
                value: "builder_collection",
                label: "Builder + Collection"
            }, {value: "pvp_roleplay", label: "Player vs. Player (PvP) + Roleplay"}, {
                value: "speedrun_survival",
                label: "Speedrun + Survival"
            }, {value: "roleplay_builder", label: "Roleplay + Builder"}, {
                value: "exploration_completionist",
                label: "Exploration + Completionist"
            }, {value: "pvp_survival", label: "Player vs. Player (PvP) + Survival"}],
            difficultyLevels: [{value: "easy", label: "Easy"}, {value: "medium", label: "Medium"}, {
                value: "hard",
                label: "Hard"
            }],
            challengeDurations: [{value: "short", label: "Short (<1 hour)"}, {
                value: "medium",
                label: "Medium (1-2 hours)"
            }, {value: "long", label: "Long (2-5 hours)"}, {value: "extra_long", label: "Extra Long (5+ hours)"}],
            init() {
                this.challengeHistory = JSON.parse(localStorage.getItem('challengeHistory') || '[]');
                const urlParams = new URLSearchParams(window.location.search);
                const sharedData = urlParams.get('challenge');
                if (sharedData) {
                    try {
                        const decompressed = LZString.decompressFromEncodedURIComponent(sharedData);
                        const challengeData = JSON.parse(decompressed);
                        this.loadChallenge(challengeData);
                        this.showToast = true;
                        this.toastType = "info";
                        this.toastMessage = "Loaded a shared challenge!";
                        setTimeout(() => {
                            this.showToast = false;
                        }, 3000);
                    } catch (error) {
                        console.error("Error loading shared challenge:", error);
                        this.showToast = true;
                        this.toastType = "error";
                        this.toastMessage = "Failed to load the shared challenge.";
                        setTimeout(() => {
                            this.showToast = false;
                        }, 3000);
                    }
                }
                this.$watch('gameTitle', () => this.formTouched = true);
                this.$watch('challengeType', () => this.formTouched = true);
                this.$watch('customChallengeType', () => this.formTouched = true);
            },
            placeholderGameTitle() {
                const randomIndex = Math.floor(Math.random() * this.placeholderGameTitles.length);
                return this.placeholderGameTitles[randomIndex];
            },
            getRandomGame() {
                const randomIndex = Math.floor(Math.random() * this.placeholderGameTitles.length);
                this.gameTitle = this.placeholderGameTitles[randomIndex];
                this.formTouched = true;
            },
            toggleCustomChallenge() {
                if (this.customChallengeType) {
                    this.customChallengeType = "";
                } else {
                    this.customChallengeType = this.challengeType;
                }
            },
            isFormValid() {
                return this.gameTitle.trim() !== "" && (this.challengeType || this.customChallengeType);
            },
            async generateChallenge() {
                if (!this.isFormValid()) {
                    this.formTouched = true;
                    return;
                }
                try {
                    this.isLoading = true;
                    this.errorOccurred = false;
                    const challengeType = this.customChallengeType ? this.customChallengeType : this.challengeType;
                    const response = await axios.post('https://chatgpt.tobiasmue91.workers.dev/', {
                        messages: [{
                            role: 'system',
                            content: `You are an AI that generates game challenges in markdown. The parameters are: Challenge Type, Difficulty Level, Challenge Duration, Craziness Factor, and Morbidity/Cruelty Level.`
                        }, {
                            role: 'system',
                            content: `Generate a game challenge in markdown for ${this.gameTitle} with the following parameters set by the user: Challenge Type: ${challengeType}, Difficulty Level: ${this.difficultyLevel} (easy, medium, hard), Challenge Duration: ${this.challengeDuration} (short, medium, long, extra long), Craziness Factor: ${this.crazinessFactor} (0-100), Morbidity/Cruelty Level: ${this.morbidityLevel} (0-100)\nGenerate a fitting name for the challenge and incorporate all parameters into the description without mentioning them. The parameters do not affect the game itself, only the challenge!\nThe rules set by the challenge must be very specific and realistic. Use clear sections with ## headers for: "Challenge Overview", "Rules", "Scoring/Success Criteria", and "Tips".`
                        }], model: "gpt-3.5-turbo", max_tokens: 3500, temperature: 0.7
                    }, {headers: {"Content-Type": "application/json", "Accept": "*/*"}});
                    this.rawChallengeDescription = response.data.choices[0].message.content;
                    this.challengeDescription = marked.parse(this.rawChallengeDescription, {
                        mangle: false,
                        headerIds: false
                    });
                    const challengeTitle = this.extractChallengeTitle(this.rawChallengeDescription);
                    this.saveToHistory(challengeTitle, this.gameTitle, this.rawChallengeDescription);
                    this.showToast = true;
                    this.toastType = "success";
                    this.toastMessage = "Challenge successfully generated!";
                    setTimeout(() => {
                        this.showToast = false;
                    }, 3000);
                } catch (error) {
                    console.error("There was an error generating the challenge:", error);
                    this.errorOccurred = true;
                    this.showToast = true;
                    this.toastType = "error";
                    this.toastMessage = "Failed to generate challenge. Please try again.";
                    setTimeout(() => {
                        this.showToast = false;
                    }, 3000);
                } finally {
                    this.isLoading = false;
                }
            },
            retryGeneration() {
                this.errorOccurred = false;
                this.generateChallenge();
            },
            copyMarkdown() {
                navigator.clipboard.writeText(this.rawChallengeDescription);
                this.showToast = true;
                this.toastType = "success";
                this.toastMessage = "Copied as Markdown!";
                setTimeout(() => {
                    this.showToast = false;
                }, 3000);
            },
            copyText() {
                const tempElement = document.createElement('div');
                tempElement.innerHTML = this.challengeDescription;
                const text = tempElement.textContent || tempElement.innerText || '';
                navigator.clipboard.writeText(text);
                this.showToast = true;
                this.toastType = "success";
                this.toastMessage = "Copied as plain text!";
                setTimeout(() => {
                    this.showToast = false;
                }, 3000);
            },
            printChallenge() {
                const printWindow = window.open('', '_blank');
                const challengeTitle = this.extractChallengeTitle(this.rawChallengeDescription);
                printWindow.document.write(`<!DOCTYPE html><html><head><title>${challengeTitle} - ${this.gameTitle}</title><style>body{font-family:Arial,sans-serif;line-height:1.6;max-width:800px;margin:0 auto;padding:20px;}h1{text-align:center;margin-bottom:30px;}h2{border-bottom:1px solid #eee;padding-bottom:10px;margin-top:30px;}.game-title{text-align:center;color:#666;margin-bottom:40px;}.footer{margin-top:50px;text-align:center;font-size:0.8em;color:#666;}</style></head><body><h1>${challengeTitle}</h1><p class="game-title">A challenge for ${this.gameTitle}</p>${this.challengeDescription}<div class="footer">Generated with AI Game Challenge Generator</div></body></html>`);
                printWindow.document.close();
                printWindow.focus();
                printWindow.print();
            },
            shareChallenge() {
                const challengeData = {
                    gameTitle: this.gameTitle,
                    challengeType: this.customChallengeType || this.challengeType,
                    difficultyLevel: this.difficultyLevel,
                    challengeDuration: this.challengeDuration,
                    crazinessFactor: this.crazinessFactor,
                    morbidityLevel: this.morbidityLevel,
                    rawChallengeDescription: this.rawChallengeDescription
                };
                const compressed = LZString.compressToEncodedURIComponent(JSON.stringify(challengeData));
                const shareUrl = `${window.location.origin}${window.location.pathname}?challenge=${compressed}`;
                this.shareUrl = shareUrl;
                this.showShareModal = true;
            },
            copyShareLink() {
                this.$refs.shareLink.select();
                document.execCommand('copy');
                this.showToast = true;
                this.toastType = "success";
                this.toastMessage = "Share link copied to clipboard!";
                setTimeout(() => {
                    this.showToast = false;
                }, 3000);
            },
            shareToTwitter() {
                const challengeTitle = this.extractChallengeTitle(this.rawChallengeDescription);
                const twitterText = encodeURIComponent(`Check out this "${challengeTitle}" challenge for ${this.gameTitle} I created using AI!`);
                window.open(`https://twitter.com/intent/tweet?text=${twitterText}&url=${encodeURIComponent(this.shareUrl)}`, '_blank');
            },
            shareToFacebook() {
                window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(this.shareUrl)}`, '_blank');
            },
            shareToReddit() {
                const challengeTitle = this.extractChallengeTitle(this.rawChallengeDescription);
                const redditTitle = encodeURIComponent(`"${challengeTitle}" - An AI-generated challenge for ${this.gameTitle}`);
                window.open(`https://www.reddit.com/submit?url=${encodeURIComponent(this.shareUrl)}&title=${redditTitle}`, '_blank');
            },
            shareViaEmail() {
                const challengeTitle = this.extractChallengeTitle(this.rawChallengeDescription);
                const subject = encodeURIComponent(`${challengeTitle} - A gaming challenge for ${this.gameTitle}`);
                const body = encodeURIComponent(`Check out this gaming challenge I created using AI:\n\n${this.shareUrl}`);
                window.location.href = `mailto:?subject=${subject}&body=${body}`;
            },
            saveToHistory(title, game, markdown) {
                const historyItem = {
                    name: title,
                    game: game,
                    description: marked.parse(markdown, {mangle: false, headerIds: false}),
                    rawDescription: markdown,
                    expanded: false,
                    timestamp: new Date().toISOString()
                };
                this.challengeHistory.unshift(historyItem);
                if (this.challengeHistory.length > 20) {
                    this.challengeHistory = this.challengeHistory.slice(0, 20);
                }
                localStorage.setItem('challengeHistory', JSON.stringify(this.challengeHistory));
            },
            toggleHistoryItem(index) {
                this.challengeHistory[index].expanded = !this.challengeHistory[index].expanded;
            },
            loadHistoryItem(index) {
                const item = this.challengeHistory[index];
                this.gameTitle = item.game;
                this.rawChallengeDescription = item.rawDescription;
                this.challengeDescription = item.description;
                this.showToast = true;
                this.toastType = "success";
                this.toastMessage = "Challenge loaded from history!";
                setTimeout(() => {
                    this.showToast = false;
                }, 3000);
            },
            removeHistoryItem(index) {
                this.challengeHistory.splice(index, 1);
                localStorage.setItem('challengeHistory', JSON.stringify(this.challengeHistory));
                this.showToast = true;
                this.toastType = "info";
                this.toastMessage = "Challenge removed from history";
                setTimeout(() => {
                    this.showToast = false;
                }, 3000);
            },
            clearHistory() {
                if (confirm("Are you sure you want to clear your challenge history? This action cannot be undone.")) {
                    this.challengeHistory = [];
                    localStorage.setItem('challengeHistory', JSON.stringify(this.challengeHistory));
                    this.showToast = true;
                    this.toastType = "info";
                    this.toastMessage = "Challenge history cleared";
                    setTimeout(() => {
                        this.showToast = false;
                    }, 3000);
                }
            },
            extractChallengeTitle(markdown) {
                const titleMatch = markdown.match(/^#\s+(.+)$/m) || markdown.match(/^##\s+(.+)$/m);
                if (titleMatch && titleMatch[1]) {
                    return titleMatch[1].trim();
                }
                return "Custom Challenge";
            },
            loadChallenge(data) {
                this.gameTitle = data.gameTitle || "";
                if (data.challengeType && this.challengeTypes.some(type => type.value === data.challengeType)) {
                    this.challengeType = data.challengeType;
                    this.customChallengeType = "";
                } else {
                    this.customChallengeType = data.challengeType || "";
                    this.challengeType = "speedrun";
                }
                if (data.difficultyLevel && this.difficultyLevels.some(level => level.value === data.difficultyLevel)) {
                    this.difficultyLevel = data.difficultyLevel;
                }
                if (data.challengeDuration && this.challengeDurations.some(duration => duration.value === data.challengeDuration)) {
                    this.challengeDuration = data.challengeDuration;
                }
                this.crazinessFactor = parseInt(data.crazinessFactor) || 20;
                this.morbidityLevel = parseInt(data.morbidityLevel) || 0;
                if (data.rawChallengeDescription) {
                    this.rawChallengeDescription = data.rawChallengeDescription;
                    this.challengeDescription = marked.parse(this.rawChallengeDescription, {
                        mangle: false,
                        headerIds: false
                    });
                }
            },
            formatDate(dateString) {
                const date = new Date(dateString);
                const now = new Date();
                const diffTime = Math.abs(now - date);
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                if (diffDays === 0) {
                    return 'Today';
                } else if (diffDays === 1) {
                    return 'Yesterday';
                } else if (diffDays < 7) {
                    return `${diffDays} days ago`;
                } else {
                    return date.toLocaleDateString();
                }
            }
        }
    }
</script>
<script src="../logo.js"></script>
</body>
</html>